function  replacementFactors = calculateCycleRates(rate_array, c_range, T)
    
    for k = 1:4
        eval(['k' num2str(k) ' = rate_array(:,k);'])
    end
    for r = 1:4
        eval(['r' num2str(r) ' = rate_array(:,r+4);'])
    end
    
    replacementFactors = NaN(size(rate_array));
       
    %% %%%%%%%%%%%%%%%%%%% for k1 and r1
    a1 = (1/2).*k1.^(-1).*r1.^(-1).*(c_range.*k2.*((-1)+k3.*T)+r4.*((-1)+r3.*T)) ...
          .^(-1).*(k1.*k3.*k4+k1.*k4.*r4+r1.*r3.*r4+(-1).*k1.*k3.*k4.*r3.*T+ ...
          (-1).*k1.*k4.*r3.*r4.*T+c_range.^2.*k2.*r1.*r2.*(1+(-1).*k3.*T)+c_range.*k1.* ...
          k2.*(k3+k4+(-1).*k3.*k4.*T)+c_range.*r1.*r2.*(r3+r4+(-1).*r3.*(k3+r4).* ...
          T)+(4.*k1.*r1.*(k4+c_range.*r2).*(c_range.*k2.*k3+r3.*(k3+r4)).*(c_range.*k2.*((-1)+ ...
          k3.*T)+r4.*((-1)+r3.*T))+(r1.*r3.*r4+c_range.^2.*k2.*r1.*r2.*(1+(-1).* ...
          k3.*T)+c_range.*k1.*k2.*(k3+k4+(-1).*k3.*k4.*T)+(-1).*k1.*k4.*(k3+r4).*( ...
          (-1)+r3.*T)+c_range.*r1.*r2.*(r3+r4+(-1).*r3.*(k3+r4).*T)).^2).^(1/2));          

    a2 = (1/2).*k1.^(-1).*r1.^(-1).*(c_range.*k2.*((-1)+k3.*T)+r4.*((-1)+r3.*T)) ...
          .^(-1).*(k1.*k3.*k4+k1.*k4.*r4+r1.*r3.*r4+(-1).*k1.*k3.*k4.*r3.*T+ ...
          (-1).*k1.*k4.*r3.*r4.*T+c_range.^2.*k2.*r1.*r2.*(1+(-1).*k3.*T)+c_range.*k1.* ...
          k2.*(k3+k4+(-1).*k3.*k4.*T)+c_range.*r1.*r2.*(r3+r4+(-1).*r3.*(k3+r4).* ...
          T)+(-1).*(4.*k1.*r1.*(k4+c_range.*r2).*(c_range.*k2.*k3+r3.*(k3+r4)).*(c_range.*k2.* ...
          ((-1)+k3.*T)+r4.*((-1)+r3.*T))+(r1.*r3.*r4+c_range.^2.*k2.*r1.*r2.*(1+( ...
          -1).*k3.*T)+c_range.*k1.*k2.*(k3+k4+(-1).*k3.*k4.*T)+(-1).*k1.*k4.*(k3+ ...
          r4).*((-1)+r3.*T)+c_range.*r1.*r2.*(r3+r4+(-1).*r3.*(k3+r4).*T)).^2).^( ...
          1/2));

    a1Filter = isreal(a1) & real(a1) > 0;    

    replacementFactors(a1Filter,1) = a1(a1Filter);
    replacementFactors(a1Filter,5) = a1(a1Filter);
    replacementFactors(~a1Filter,1) = a2(~a1Filter);
    replacementFactors(~a1Filter,5) = a2(~a1Filter);
    
    %% %%%%%%%%%%%%%%%%%%% for k2 and r2 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    b1 = (1/2).*c_range.^(-2).*((-1).*k2.*(k3+r1).*r2+k2.*k3.*r1.*r2.*T).^(-1).*( ...
          c_range.*k1.*k2.*k3+c_range.*k1.*k2.*k4+c_range.*k2.*k3.*k4+c_range.*k1.*k2.*r1+c_range.*k3.* ...
          r2.*r3+c_range.*r1.*r2.*r3+c_range.*r1.*r2.*r4+c_range.*r2.*r3.*r4+(-1).*c_range.*k1.*k2.* ...
          k3.*k4.*T+(-1).*c_range.*k1.*k2.*k3.*r1.*T+(-1).*c_range.*k3.*r1.*r2.*r3.*T+( ...
          -1).*c_range.*r1.*r2.*r3.*r4.*T+(c_range.^2.*(4.*k2.*r2.*(k3.*k4+(k4+r1).*r4) ...
          .*(k3+r1+(-1).*k3.*r1.*T).*((-1).*r3+k1.*((-1)+r3.*T))+(k2.*k3.* ...
          k4+k1.*k2.*(k3+k4+r1+(-1).*k3.*(k4+r1).*T)+r2.*(k3.*r3+r1.*r3+r1.* ...
          r4+r3.*r4+(-1).*r1.*r3.*(k3+r4).*T)).^2)).^(1/2));
        
    b2 = (1/2).*c_range.^(-2).*((-1).*k2.*(k3+r1).*r2+k2.*k3.*r1.*r2.*T).^(-1).*( ...
          c_range.*k1.*k2.*k3+c_range.*k1.*k2.*k4+c_range.*k2.*k3.*k4+c_range.*k1.*k2.*r1+c_range.*k3.* ...
          r2.*r3+c_range.*r1.*r2.*r3+c_range.*r1.*r2.*r4+c_range.*r2.*r3.*r4+(-1).*c_range.*k1.*k2.* ...
          k3.*k4.*T+(-1).*c_range.*k1.*k2.*k3.*r1.*T+(-1).*c_range.*k3.*r1.*r2.*r3.*T+( ...
          -1).*c_range.*r1.*r2.*r3.*r4.*T+(-1).*(c_range.^2.*(4.*k2.*r2.*(k3.*k4+(k4+r1) ...
          .*r4).*(k3+r1+(-1).*k3.*r1.*T).*((-1).*r3+k1.*((-1)+r3.*T))+(k2.* ...
          k3.*k4+k1.*k2.*(k3+k4+r1+(-1).*k3.*(k4+r1).*T)+r2.*(k3.*r3+r1.*r3+ ...
          r1.*r4+r3.*r4+(-1).*r1.*r3.*(k3+r4).*T)).^2)).^(1/2));
        
    b1Filter = isreal(b1) & real(b1) > 0;    

    replacementFactors(b1Filter,2) = b1(b1Filter);
    replacementFactors(b1Filter,6) = b1(b1Filter);
    replacementFactors(~b1Filter,2) = b2(~b1Filter);
    replacementFactors(~b1Filter,6) = b2(~b1Filter);
    
    %% %%%%%%%%%%%%%%%%%%% for k3 and r3 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    d1 = (1/2).*(k3.*k4.*r3+c_range.*k3.*r2.*r3+(-1).*k1.*k3.*k4.*r3.*T+(-1).*c_range.* ...
          k3.*r1.*r2.*r3.*T).^(-1).*((-1).*c_range.*k1.*k2.*k3+(-1).*k1.*k3.*k4+( ...
          -1).*c_range.*k2.*k3.*k4+(-1).*c_range.^2.*k2.*k3.*r2+(-1).*c_range.*r1.*r2.*r3+(-1) ...
          .*k4.*r3.*r4+(-1).*r1.*r3.*r4+(-1).*c_range.*r2.*r3.*r4+c_range.*k1.*k2.*k3.* ...
          k4.*T+c_range.*k1.*k2.*k3.*r1.*T+c_range.^2.*k2.*k3.*r1.*r2.*T+k1.*k4.*r3.* ...
          r4.*T+k1.*r1.*r3.*r4.*T+c_range.*r1.*r2.*r3.*r4.*T+(-1).*((-4).*(c_range.*k1.* ...
          k2.*k4+c_range.*k1.*k2.*r1+c_range.^2.*k2.*r1.*r2+k1.*k4.*r4+k1.*r1.*r4+c_range.* ...
          r1.*r2.*r4).*(k3.*k4.*r3+c_range.*k3.*r2.*r3+(-1).*k1.*k3.*k4.*r3.*T+( ...
          -1).*c_range.*k3.*r1.*r2.*r3.*T)+(c_range.*k1.*k2.*k3+k1.*k3.*k4+c_range.*k2.*k3.* ...
          k4+c_range.^2.*k2.*k3.*r2+c_range.*r1.*r2.*r3+k4.*r3.*r4+r1.*r3.*r4+c_range.*r2.* ...
          r3.*r4+(-1).*c_range.*k1.*k2.*k3.*k4.*T+(-1).*c_range.*k1.*k2.*k3.*r1.*T+(-1) ...
          .*c_range.^2.*k2.*k3.*r1.*r2.*T+(-1).*k1.*k4.*r3.*r4.*T+(-1).*k1.*r1.* ...
          r3.*r4.*T+(-1).*c_range.*r1.*r2.*r3.*r4.*T).^2).^(1/2));

        
    d2 = (1/2).*(k3.*k4.*r3+c_range.*k3.*r2.*r3+(-1).*k1.*k3.*k4.*r3.*T+(-1).*c_range.* ...
          k3.*r1.*r2.*r3.*T).^(-1).*((-1).*c_range.*k1.*k2.*k3+(-1).*k1.*k3.*k4+( ...
          -1).*c_range.*k2.*k3.*k4+(-1).*c_range.^2.*k2.*k3.*r2+(-1).*c_range.*r1.*r2.*r3+(-1) ...
          .*k4.*r3.*r4+(-1).*r1.*r3.*r4+(-1).*c_range.*r2.*r3.*r4+c_range.*k1.*k2.*k3.* ...
          k4.*T+c_range.*k1.*k2.*k3.*r1.*T+c_range.^2.*k2.*k3.*r1.*r2.*T+k1.*k4.*r3.* ...
          r4.*T+k1.*r1.*r3.*r4.*T+c_range.*r1.*r2.*r3.*r4.*T+((-4).*(c_range.*k1.*k2.* ...
          k4+c_range.*k1.*k2.*r1+c_range.^2.*k2.*r1.*r2+k1.*k4.*r4+k1.*r1.*r4+c_range.*r1.* ...
          r2.*r4).*(k3.*k4.*r3+c_range.*k3.*r2.*r3+(-1).*k1.*k3.*k4.*r3.*T+(-1).* ...
          c_range.*k3.*r1.*r2.*r3.*T)+(c_range.*k1.*k2.*k3+k1.*k3.*k4+c_range.*k2.*k3.*k4+ ...
          c_range.^2.*k2.*k3.*r2+c_range.*r1.*r2.*r3+k4.*r3.*r4+r1.*r3.*r4+c_range.*r2.*r3.* ...
          r4+(-1).*c_range.*k1.*k2.*k3.*k4.*T+(-1).*c_range.*k1.*k2.*k3.*r1.*T+(-1).* ...
          c_range.^2.*k2.*k3.*r1.*r2.*T+(-1).*k1.*k4.*r3.*r4.*T+(-1).*k1.*r1.*r3.* ...
          r4.*T+(-1).*c_range.*r1.*r2.*r3.*r4.*T).^2).^(1/2));
        
    d1Filter = isreal(d1) & real(d1) > 0;    

    replacementFactors(d1Filter,3) = d1(d1Filter);
    replacementFactors(d1Filter,7) = d1(d1Filter);
    replacementFactors(~d1Filter,3) = d2(~d1Filter);
    replacementFactors(~d1Filter,7) = d2(~d1Filter);    
    
    %% %%%%%%%%%%%%%%%%%%% for k4 and r4 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    e1 = (1/2).*(k1.*k4.*r4+k4.*r3.*r4+(-1).*k1.*k4.*r3.*r4.*T).^(-1).*(( ...
          -1).*c_range.*k1.*k2.*k4+(-1).*k1.*k3.*k4+(-1).*c_range.*k2.*k3.*k4+(-1).*k3.* ...
          k4.*r3+(-1).*k1.*r1.*r4+(-1).*c_range.*r1.*r2.*r4+(-1).*r1.*r3.*r4+(-1) ...
          .*c_range.*r2.*r3.*r4+c_range.*k1.*k2.*k3.*k4.*T+k1.*k3.*k4.*r3.*T+k1.*r1.* ...
          r3.*r4.*T+c_range.*r1.*r2.*r3.*r4.*T+(-1).*((-4).*(c_range.*k1.*k2.*k3+c_range.*k1.* ...
          k2.*r1+c_range.^2.*k2.*k3.*r2+c_range.^2.*k2.*r1.*r2+c_range.*k3.*r2.*r3+c_range.*r1.*r2.* ...
          r3+(-1).*c_range.*k1.*k2.*k3.*r1.*T+(-1).*c_range.^2.*k2.*k3.*r1.*r2.*T+(-1).* ...
          c_range.*k3.*r1.*r2.*r3.*T).*(k1.*k4.*r4+k4.*r3.*r4+(-1).*k1.*k4.*r3.* ...
          r4.*T)+(c_range.*k1.*k2.*k4+k1.*k3.*k4+c_range.*k2.*k3.*k4+k3.*k4.*r3+k1.*r1.* ...
          r4+c_range.*r1.*r2.*r4+r1.*r3.*r4+c_range.*r2.*r3.*r4+(-1).*c_range.*k1.*k2.*k3.* ...
          k4.*T+(-1).*k1.*k3.*k4.*r3.*T+(-1).*k1.*r1.*r3.*r4.*T+(-1).*c_range.* ...
          r1.*r2.*r3.*r4.*T).^2).^(1/2));

        
    e2 = (1/2).*(k1.*k4.*r4+k4.*r3.*r4+(-1).*k1.*k4.*r3.*r4.*T).^(-1).*(( ...
          -1).*c_range.*k1.*k2.*k4+(-1).*k1.*k3.*k4+(-1).*c_range.*k2.*k3.*k4+(-1).*k3.* ...
          k4.*r3+(-1).*k1.*r1.*r4+(-1).*c_range.*r1.*r2.*r4+(-1).*r1.*r3.*r4+(-1) ...
          .*c_range.*r2.*r3.*r4+c_range.*k1.*k2.*k3.*k4.*T+k1.*k3.*k4.*r3.*T+k1.*r1.* ...
          r3.*r4.*T+c_range.*r1.*r2.*r3.*r4.*T+((-4).*(c_range.*k1.*k2.*k3+c_range.*k1.*k2.* ...
          r1+c_range.^2.*k2.*k3.*r2+c_range.^2.*k2.*r1.*r2+c_range.*k3.*r2.*r3+c_range.*r1.*r2.*r3+( ...
          -1).*c_range.*k1.*k2.*k3.*r1.*T+(-1).*c_range.^2.*k2.*k3.*r1.*r2.*T+(-1).*c_range.* ...
          k3.*r1.*r2.*r3.*T).*(k1.*k4.*r4+k4.*r3.*r4+(-1).*k1.*k4.*r3.*r4.* ...
          T)+(c_range.*k1.*k2.*k4+k1.*k3.*k4+c_range.*k2.*k3.*k4+k3.*k4.*r3+k1.*r1.*r4+ ...
          c_range.*r1.*r2.*r4+r1.*r3.*r4+c_range.*r2.*r3.*r4+(-1).*c_range.*k1.*k2.*k3.*k4.*T+ ...
          (-1).*k1.*k3.*k4.*r3.*T+(-1).*k1.*r1.*r3.*r4.*T+(-1).*c_range.*r1.*r2.* ...
          r3.*r4.*T).^2).^(1/2));
        
    e1Filter = isreal(e1) & real(e1) > 0;    

    replacementFactors(e1Filter,4) = e1(e1Filter);
    replacementFactors(e1Filter,8) = e1(e1Filter);
    replacementFactors(~e1Filter,4) = e2(~e1Filter);
    replacementFactors(~e1Filter,8) = e2(~e1Filter);    
    