function   [a1FactorVec, validFlags, colIndices] = a1FunSixState(k21, k34, k12, k43, k14, k23, k41, k32, c, cw, beta, indArray)

% specify update indices
colIndices = [indArray(2,1) indArray(3,4) indArray(5,4) indArray(6,1)]; 

a11 = (1/2).*((-1).*beta.*c.^2.*k12.*k21.*k23.^2.*k34+(-1).*c.*cw.*k12.* ...
    k21.*k23.^2.*k34+(-1).*beta.*c.*cw.*k12.*k21.*k23.^2.*k34+(-1).* ...
    cw.^2.*k12.*k21.*k23.^2.*k34+beta.*c.^2.*k12.*k21.*k23.*k32.*k34+ ...
    c.*cw.*k12.*k21.*k23.*k32.*k34+beta.*c.*cw.*k12.*k21.*k23.*k32.* ...
    k34+cw.^2.*k12.*k21.*k23.*k32.*k34+(-1).*beta.^2.*c.^2.*k12.*k21.* ...
    k23.*k34.*k43+(-2).*beta.*c.*cw.*k12.*k21.*k23.*k34.*k43+(-1).* ...
    cw.^2.*k12.*k21.*k23.*k34.*k43+beta.^2.*c.^2.*k12.*k21.*k32.*k34.* ...
    k43+2.*beta.*c.*cw.*k12.*k21.*k32.*k34.*k43+cw.^2.*k12.*k21.*k32.* ...
    k34.*k43+(-1).*beta.*c.^2.*k21.*k23.*k32.*k34.*k43+(-1).*c.*cw.* ...
    k21.*k23.*k32.*k34.*k43+(-1).*beta.*c.*cw.*k21.*k23.*k32.*k34.* ...
    k43+(-1).*cw.^2.*k21.*k23.*k32.*k34.*k43+beta.*c.^2.*k21.*k32.^2.* ...
    k34.*k43+c.*cw.*k21.*k32.^2.*k34.*k43+beta.*c.*cw.*k21.*k32.^2.* ...
    k34.*k43+cw.^2.*k21.*k32.^2.*k34.*k43).^(-1).*(beta.*c.*k12.*k14.* ...
    k21.*k23.^2+cw.*k12.*k14.*k21.*k23.^2+(-1).*beta.*c.*k12.*k14.* ...
    k21.*k23.*k32+(-1).*cw.*k12.*k14.*k21.*k23.*k32+beta.*c.*k12.^2.* ...
    k23.^2.*k34+beta.*cw.*k12.^2.*k23.^2.*k34+(-1).*beta.*c.*k12.^2.* ...
    k23.*k34.*k41+(-1).*beta.*cw.*k12.^2.*k23.*k34.*k41+beta.*c.*k12.* ...
    k23.^2.*k34.*k41+cw.*k12.*k23.^2.*k34.*k41+(-1).*beta.*c.*k12.* ...
    k23.*k32.*k34.*k41+(-1).*cw.*k12.*k23.*k32.*k34.*k41+beta.*c.* ...
    k12.*k14.*k21.*k23.*k43+beta.^2.*c.*k12.*k14.*k21.*k23.*k43+cw.* ...
    k12.*k14.*k21.*k23.*k43+beta.*cw.*k12.*k14.*k21.*k23.*k43+(-1).* ...
    beta.^2.*c.*k12.*k14.*k21.*k32.*k43+(-1).*cw.*k12.*k14.*k21.*k32.* ...
    k43+beta.*c.*k12.*k21.*k23.*k32.*k43+beta.*cw.*k12.*k21.*k23.* ...
    k32.*k43+beta.*c.*k14.*k21.*k23.*k32.*k43+cw.*k14.*k21.*k23.*k32.* ...
    k43+(-1).*beta.*c.*k14.*k21.*k32.^2.*k43+(-1).*cw.*k14.*k21.* ...
    k32.^2.*k43+beta.^2.*c.*k12.^2.*k23.*k34.*k43+beta.*cw.*k12.^2.* ...
    k23.*k34.*k43+beta.*c.*k12.*k23.*k32.*k34.*k43+beta.*cw.*k12.* ...
    k23.*k32.*k34.*k43+(-1).*beta.^2.*c.*k12.^2.*k34.*k41.*k43+(-1).* ...
    beta.*cw.*k12.^2.*k34.*k41.*k43+beta.^2.*c.*k12.*k23.*k34.*k41.* ...
    k43+cw.*k12.*k23.*k34.*k41.*k43+(-1).*beta.*c.*k12.*k32.*k34.* ...
    k41.*k43+(-1).*beta.^2.*c.*k12.*k32.*k34.*k41.*k43+(-1).*cw.*k12.* ...
    k32.*k34.*k41.*k43+(-1).*beta.*cw.*k12.*k32.*k34.*k41.*k43+beta.* ...
    c.*k23.*k32.*k34.*k41.*k43+cw.*k23.*k32.*k34.*k41.*k43+(-1).* ...
    beta.*c.*k32.^2.*k34.*k41.*k43+(-1).*cw.*k32.^2.*k34.*k41.*k43+ ...
    beta.^2.*c.*k12.*k14.*k21.*k43.^2+beta.*cw.*k12.*k14.*k21.*k43.^2+ ...
    beta.^2.*c.*k12.*k21.*k32.*k43.^2+beta.*cw.*k12.*k21.*k32.*k43.^2+ ...
    beta.*c.*k14.*k21.*k32.*k43.^2+beta.*cw.*k14.*k21.*k32.*k43.^2+ ...
    beta.*c.*k21.*k32.^2.*k43.^2+beta.*cw.*k21.*k32.^2.*k43.^2+(-1).*( ...
    ((-1).*beta.*c.*k12.*k14.*k21.*k23.^2+(-1).*cw.*k12.*k14.*k21.* ...
    k23.^2+beta.*c.*k12.*k14.*k21.*k23.*k32+cw.*k12.*k14.*k21.*k23.* ...
    k32+(-1).*beta.*c.*k12.^2.*k23.^2.*k34+(-1).*beta.*cw.*k12.^2.* ...
    k23.^2.*k34+beta.*c.*k12.^2.*k23.*k34.*k41+beta.*cw.*k12.^2.*k23.* ...
    k34.*k41+(-1).*beta.*c.*k12.*k23.^2.*k34.*k41+(-1).*cw.*k12.* ...
    k23.^2.*k34.*k41+beta.*c.*k12.*k23.*k32.*k34.*k41+cw.*k12.*k23.* ...
    k32.*k34.*k41+(-1).*beta.*c.*k12.*k14.*k21.*k23.*k43+(-1).* ...
    beta.^2.*c.*k12.*k14.*k21.*k23.*k43+(-1).*cw.*k12.*k14.*k21.*k23.* ...
    k43+(-1).*beta.*cw.*k12.*k14.*k21.*k23.*k43+beta.^2.*c.*k12.*k14.* ...
    k21.*k32.*k43+cw.*k12.*k14.*k21.*k32.*k43+(-1).*beta.*c.*k12.* ...
    k21.*k23.*k32.*k43+(-1).*beta.*cw.*k12.*k21.*k23.*k32.*k43+(-1).* ...
    beta.*c.*k14.*k21.*k23.*k32.*k43+(-1).*cw.*k14.*k21.*k23.*k32.* ...
    k43+beta.*c.*k14.*k21.*k32.^2.*k43+cw.*k14.*k21.*k32.^2.*k43+(-1) ...
    .*beta.^2.*c.*k12.^2.*k23.*k34.*k43+(-1).*beta.*cw.*k12.^2.*k23.* ...
    k34.*k43+(-1).*beta.*c.*k12.*k23.*k32.*k34.*k43+(-1).*beta.*cw.* ...
    k12.*k23.*k32.*k34.*k43+beta.^2.*c.*k12.^2.*k34.*k41.*k43+beta.* ...
    cw.*k12.^2.*k34.*k41.*k43+(-1).*beta.^2.*c.*k12.*k23.*k34.*k41.* ...
    k43+(-1).*cw.*k12.*k23.*k34.*k41.*k43+beta.*c.*k12.*k32.*k34.* ...
    k41.*k43+beta.^2.*c.*k12.*k32.*k34.*k41.*k43+cw.*k12.*k32.*k34.* ...
    k41.*k43+beta.*cw.*k12.*k32.*k34.*k41.*k43+(-1).*beta.*c.*k23.* ...
    k32.*k34.*k41.*k43+(-1).*cw.*k23.*k32.*k34.*k41.*k43+beta.*c.* ...
    k32.^2.*k34.*k41.*k43+cw.*k32.^2.*k34.*k41.*k43+(-1).*beta.^2.*c.* ...
    k12.*k14.*k21.*k43.^2+(-1).*beta.*cw.*k12.*k14.*k21.*k43.^2+(-1).* ...
    beta.^2.*c.*k12.*k21.*k32.*k43.^2+(-1).*beta.*cw.*k12.*k21.*k32.* ...
    k43.^2+(-1).*beta.*c.*k14.*k21.*k32.*k43.^2+(-1).*beta.*cw.*k14.* ...
    k21.*k32.*k43.^2+(-1).*beta.*c.*k21.*k32.^2.*k43.^2+(-1).*beta.* ...
    cw.*k21.*k32.^2.*k43.^2).^2+(-4).*((-1).*beta.*c.^2.*k12.*k21.* ...
    k23.^2.*k34+(-1).*c.*cw.*k12.*k21.*k23.^2.*k34+(-1).*beta.*c.*cw.* ...
    k12.*k21.*k23.^2.*k34+(-1).*cw.^2.*k12.*k21.*k23.^2.*k34+beta.* ...
    c.^2.*k12.*k21.*k23.*k32.*k34+c.*cw.*k12.*k21.*k23.*k32.*k34+ ...
    beta.*c.*cw.*k12.*k21.*k23.*k32.*k34+cw.^2.*k12.*k21.*k23.*k32.* ...
    k34+(-1).*beta.^2.*c.^2.*k12.*k21.*k23.*k34.*k43+(-2).*beta.*c.* ...
    cw.*k12.*k21.*k23.*k34.*k43+(-1).*cw.^2.*k12.*k21.*k23.*k34.*k43+ ...
    beta.^2.*c.^2.*k12.*k21.*k32.*k34.*k43+2.*beta.*c.*cw.*k12.*k21.* ...
    k32.*k34.*k43+cw.^2.*k12.*k21.*k32.*k34.*k43+(-1).*beta.*c.^2.* ...
    k21.*k23.*k32.*k34.*k43+(-1).*c.*cw.*k21.*k23.*k32.*k34.*k43+(-1) ...
    .*beta.*c.*cw.*k21.*k23.*k32.*k34.*k43+(-1).*cw.^2.*k21.*k23.* ...
    k32.*k34.*k43+beta.*c.^2.*k21.*k32.^2.*k34.*k43+c.*cw.*k21.* ...
    k32.^2.*k34.*k43+beta.*c.*cw.*k21.*k32.^2.*k34.*k43+cw.^2.*k21.* ...
    k32.^2.*k34.*k43).*((-1).*beta.*k12.^2.*k14.*k23.^2+(-1).*beta.* ...
    k12.^2.*k23.^2.*k41+(-1).*beta.*k12.^2.*k14.*k23.*k43+(-1).* ...
    beta.^2.*k12.^2.*k14.*k23.*k43+(-2).*beta.*k12.*k14.*k23.*k32.* ...
    k43+(-1).*beta.*k12.^2.*k23.*k41.*k43+(-1).*beta.^2.*k12.^2.*k23.* ...
    k41.*k43+(-2).*beta.*k12.*k23.*k32.*k41.*k43+(-1).*beta.^2.* ...
    k12.^2.*k14.*k43.^2+(-1).*beta.*k12.*k14.*k32.*k43.^2+(-1).* ...
    beta.^2.*k12.*k14.*k32.*k43.^2+(-1).*beta.*k14.*k32.^2.*k43.^2+( ...
    -1).*beta.^2.*k12.^2.*k41.*k43.^2+(-1).*beta.*k12.*k32.*k41.* ...
    k43.^2+(-1).*beta.^2.*k12.*k32.*k41.*k43.^2+(-1).*beta.*k32.^2.* ...
    k41.*k43.^2)).^(1/2));
  
a12 = (1/2).*((-1).*beta.*c.^2.*k12.*k21.*k23.^2.*k34+(-1).*c.*cw.*k12.* ...
    k21.*k23.^2.*k34+(-1).*beta.*c.*cw.*k12.*k21.*k23.^2.*k34+(-1).* ...
    cw.^2.*k12.*k21.*k23.^2.*k34+beta.*c.^2.*k12.*k21.*k23.*k32.*k34+ ...
    c.*cw.*k12.*k21.*k23.*k32.*k34+beta.*c.*cw.*k12.*k21.*k23.*k32.* ...
    k34+cw.^2.*k12.*k21.*k23.*k32.*k34+(-1).*beta.^2.*c.^2.*k12.*k21.* ...
    k23.*k34.*k43+(-2).*beta.*c.*cw.*k12.*k21.*k23.*k34.*k43+(-1).* ...
    cw.^2.*k12.*k21.*k23.*k34.*k43+beta.^2.*c.^2.*k12.*k21.*k32.*k34.* ...
    k43+2.*beta.*c.*cw.*k12.*k21.*k32.*k34.*k43+cw.^2.*k12.*k21.*k32.* ...
    k34.*k43+(-1).*beta.*c.^2.*k21.*k23.*k32.*k34.*k43+(-1).*c.*cw.* ...
    k21.*k23.*k32.*k34.*k43+(-1).*beta.*c.*cw.*k21.*k23.*k32.*k34.* ...
    k43+(-1).*cw.^2.*k21.*k23.*k32.*k34.*k43+beta.*c.^2.*k21.*k32.^2.* ...
    k34.*k43+c.*cw.*k21.*k32.^2.*k34.*k43+beta.*c.*cw.*k21.*k32.^2.* ...
    k34.*k43+cw.^2.*k21.*k32.^2.*k34.*k43).^(-1).*(beta.*c.*k12.*k14.* ...
    k21.*k23.^2+cw.*k12.*k14.*k21.*k23.^2+(-1).*beta.*c.*k12.*k14.* ...
    k21.*k23.*k32+(-1).*cw.*k12.*k14.*k21.*k23.*k32+beta.*c.*k12.^2.* ...
    k23.^2.*k34+beta.*cw.*k12.^2.*k23.^2.*k34+(-1).*beta.*c.*k12.^2.* ...
    k23.*k34.*k41+(-1).*beta.*cw.*k12.^2.*k23.*k34.*k41+beta.*c.*k12.* ...
    k23.^2.*k34.*k41+cw.*k12.*k23.^2.*k34.*k41+(-1).*beta.*c.*k12.* ...
    k23.*k32.*k34.*k41+(-1).*cw.*k12.*k23.*k32.*k34.*k41+beta.*c.* ...
    k12.*k14.*k21.*k23.*k43+beta.^2.*c.*k12.*k14.*k21.*k23.*k43+cw.* ...
    k12.*k14.*k21.*k23.*k43+beta.*cw.*k12.*k14.*k21.*k23.*k43+(-1).* ...
    beta.^2.*c.*k12.*k14.*k21.*k32.*k43+(-1).*cw.*k12.*k14.*k21.*k32.* ...
    k43+beta.*c.*k12.*k21.*k23.*k32.*k43+beta.*cw.*k12.*k21.*k23.* ...
    k32.*k43+beta.*c.*k14.*k21.*k23.*k32.*k43+cw.*k14.*k21.*k23.*k32.* ...
    k43+(-1).*beta.*c.*k14.*k21.*k32.^2.*k43+(-1).*cw.*k14.*k21.* ...
    k32.^2.*k43+beta.^2.*c.*k12.^2.*k23.*k34.*k43+beta.*cw.*k12.^2.* ...
    k23.*k34.*k43+beta.*c.*k12.*k23.*k32.*k34.*k43+beta.*cw.*k12.* ...
    k23.*k32.*k34.*k43+(-1).*beta.^2.*c.*k12.^2.*k34.*k41.*k43+(-1).* ...
    beta.*cw.*k12.^2.*k34.*k41.*k43+beta.^2.*c.*k12.*k23.*k34.*k41.* ...
    k43+cw.*k12.*k23.*k34.*k41.*k43+(-1).*beta.*c.*k12.*k32.*k34.* ...
    k41.*k43+(-1).*beta.^2.*c.*k12.*k32.*k34.*k41.*k43+(-1).*cw.*k12.* ...
    k32.*k34.*k41.*k43+(-1).*beta.*cw.*k12.*k32.*k34.*k41.*k43+beta.* ...
    c.*k23.*k32.*k34.*k41.*k43+cw.*k23.*k32.*k34.*k41.*k43+(-1).* ...
    beta.*c.*k32.^2.*k34.*k41.*k43+(-1).*cw.*k32.^2.*k34.*k41.*k43+ ...
    beta.^2.*c.*k12.*k14.*k21.*k43.^2+beta.*cw.*k12.*k14.*k21.*k43.^2+ ...
    beta.^2.*c.*k12.*k21.*k32.*k43.^2+beta.*cw.*k12.*k21.*k32.*k43.^2+ ...
    beta.*c.*k14.*k21.*k32.*k43.^2+beta.*cw.*k14.*k21.*k32.*k43.^2+ ...
    beta.*c.*k21.*k32.^2.*k43.^2+beta.*cw.*k21.*k32.^2.*k43.^2+(((-1) ...
    .*beta.*c.*k12.*k14.*k21.*k23.^2+(-1).*cw.*k12.*k14.*k21.*k23.^2+ ...
    beta.*c.*k12.*k14.*k21.*k23.*k32+cw.*k12.*k14.*k21.*k23.*k32+(-1) ...
    .*beta.*c.*k12.^2.*k23.^2.*k34+(-1).*beta.*cw.*k12.^2.*k23.^2.* ...
    k34+beta.*c.*k12.^2.*k23.*k34.*k41+beta.*cw.*k12.^2.*k23.*k34.* ...
    k41+(-1).*beta.*c.*k12.*k23.^2.*k34.*k41+(-1).*cw.*k12.*k23.^2.* ...
    k34.*k41+beta.*c.*k12.*k23.*k32.*k34.*k41+cw.*k12.*k23.*k32.*k34.* ...
    k41+(-1).*beta.*c.*k12.*k14.*k21.*k23.*k43+(-1).*beta.^2.*c.*k12.* ...
    k14.*k21.*k23.*k43+(-1).*cw.*k12.*k14.*k21.*k23.*k43+(-1).*beta.* ...
    cw.*k12.*k14.*k21.*k23.*k43+beta.^2.*c.*k12.*k14.*k21.*k32.*k43+ ...
    cw.*k12.*k14.*k21.*k32.*k43+(-1).*beta.*c.*k12.*k21.*k23.*k32.* ...
    k43+(-1).*beta.*cw.*k12.*k21.*k23.*k32.*k43+(-1).*beta.*c.*k14.* ...
    k21.*k23.*k32.*k43+(-1).*cw.*k14.*k21.*k23.*k32.*k43+beta.*c.* ...
    k14.*k21.*k32.^2.*k43+cw.*k14.*k21.*k32.^2.*k43+(-1).*beta.^2.*c.* ...
    k12.^2.*k23.*k34.*k43+(-1).*beta.*cw.*k12.^2.*k23.*k34.*k43+(-1).* ...
    beta.*c.*k12.*k23.*k32.*k34.*k43+(-1).*beta.*cw.*k12.*k23.*k32.* ...
    k34.*k43+beta.^2.*c.*k12.^2.*k34.*k41.*k43+beta.*cw.*k12.^2.*k34.* ...
    k41.*k43+(-1).*beta.^2.*c.*k12.*k23.*k34.*k41.*k43+(-1).*cw.*k12.* ...
    k23.*k34.*k41.*k43+beta.*c.*k12.*k32.*k34.*k41.*k43+beta.^2.*c.* ...
    k12.*k32.*k34.*k41.*k43+cw.*k12.*k32.*k34.*k41.*k43+beta.*cw.* ...
    k12.*k32.*k34.*k41.*k43+(-1).*beta.*c.*k23.*k32.*k34.*k41.*k43+( ...
    -1).*cw.*k23.*k32.*k34.*k41.*k43+beta.*c.*k32.^2.*k34.*k41.*k43+ ...
    cw.*k32.^2.*k34.*k41.*k43+(-1).*beta.^2.*c.*k12.*k14.*k21.*k43.^2+ ...
    (-1).*beta.*cw.*k12.*k14.*k21.*k43.^2+(-1).*beta.^2.*c.*k12.*k21.* ...
    k32.*k43.^2+(-1).*beta.*cw.*k12.*k21.*k32.*k43.^2+(-1).*beta.*c.* ...
    k14.*k21.*k32.*k43.^2+(-1).*beta.*cw.*k14.*k21.*k32.*k43.^2+(-1).* ...
    beta.*c.*k21.*k32.^2.*k43.^2+(-1).*beta.*cw.*k21.*k32.^2.*k43.^2) ...
    .^2+(-4).*((-1).*beta.*c.^2.*k12.*k21.*k23.^2.*k34+(-1).*c.*cw.* ...
    k12.*k21.*k23.^2.*k34+(-1).*beta.*c.*cw.*k12.*k21.*k23.^2.*k34+( ...
    -1).*cw.^2.*k12.*k21.*k23.^2.*k34+beta.*c.^2.*k12.*k21.*k23.*k32.* ...
    k34+c.*cw.*k12.*k21.*k23.*k32.*k34+beta.*c.*cw.*k12.*k21.*k23.* ...
    k32.*k34+cw.^2.*k12.*k21.*k23.*k32.*k34+(-1).*beta.^2.*c.^2.*k12.* ...
    k21.*k23.*k34.*k43+(-2).*beta.*c.*cw.*k12.*k21.*k23.*k34.*k43+(-1) ...
    .*cw.^2.*k12.*k21.*k23.*k34.*k43+beta.^2.*c.^2.*k12.*k21.*k32.* ...
    k34.*k43+2.*beta.*c.*cw.*k12.*k21.*k32.*k34.*k43+cw.^2.*k12.*k21.* ...
    k32.*k34.*k43+(-1).*beta.*c.^2.*k21.*k23.*k32.*k34.*k43+(-1).*c.* ...
    cw.*k21.*k23.*k32.*k34.*k43+(-1).*beta.*c.*cw.*k21.*k23.*k32.* ...
    k34.*k43+(-1).*cw.^2.*k21.*k23.*k32.*k34.*k43+beta.*c.^2.*k21.* ...
    k32.^2.*k34.*k43+c.*cw.*k21.*k32.^2.*k34.*k43+beta.*c.*cw.*k21.* ...
    k32.^2.*k34.*k43+cw.^2.*k21.*k32.^2.*k34.*k43).*((-1).*beta.* ...
    k12.^2.*k14.*k23.^2+(-1).*beta.*k12.^2.*k23.^2.*k41+(-1).*beta.* ...
    k12.^2.*k14.*k23.*k43+(-1).*beta.^2.*k12.^2.*k14.*k23.*k43+(-2).* ...
    beta.*k12.*k14.*k23.*k32.*k43+(-1).*beta.*k12.^2.*k23.*k41.*k43+( ...
    -1).*beta.^2.*k12.^2.*k23.*k41.*k43+(-2).*beta.*k12.*k23.*k32.* ...
    k41.*k43+(-1).*beta.^2.*k12.^2.*k14.*k43.^2+(-1).*beta.*k12.*k14.* ...
    k32.*k43.^2+(-1).*beta.^2.*k12.*k14.*k32.*k43.^2+(-1).*beta.*k14.* ...
    k32.^2.*k43.^2+(-1).*beta.^2.*k12.^2.*k41.*k43.^2+(-1).*beta.* ...
    k12.*k32.*k41.*k43.^2+(-1).*beta.^2.*k12.*k32.*k41.*k43.^2+(-1).* ...
    beta.*k32.^2.*k41.*k43.^2)).^(1/2));
  
  
    % record output factors
    validFlags1 = real(a11)==a11 & real(a11)>0;
    validFlags2 = real(a12)==a12 & real(a12)>0;
    
    a1FactorVec = NaN(size(validFlags1));
    a1FactorVec(validFlags1) = a11(validFlags1);    
    a1FactorVec(~validFlags1&validFlags2) = a11(~validFlags1&validFlags2);
    
    validFlags = validFlags1|validFlags2;