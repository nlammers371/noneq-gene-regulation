(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     60708,       1546]
NotebookOptionsPosition[     53561,       1420]
NotebookOutlinePosition[     53907,       1435]
CellTagsIndexPosition[     53864,       1432]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[StyleBox["Sharpness calculations", "Chapter"]], "Section",
 CellChangeTimes->{{3.766585934056647*^9, 3.766585974405374*^9}, {
  3.7903540634633904`*^9, 3.7903540872564287`*^9}, {3.7998463249019165`*^9, 
  3.7998463255144157`*^9}, {3.8091131168504567`*^9, 
  3.8091131220587234`*^9}},ExpressionUUID->"53bbe826-6243-4623-bfbc-\
1fc0a6d7cf3d"],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.7665860727694225`*^9, 3.7665860727953434`*^9}, 
   3.790350446024684*^9, 3.790353136444847*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"09a89208-e8c8-4a30-a36f-b4bd2445d91a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Q", " ", "=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "r4"}], "-", "k3"}], ",", "                  ", "k2", 
        ",", "                 ", "0", ",", "                         ", 
        "r1"}], "}"}], ",", "\[IndentingNewLine]", "     ", 
      RowBox[{"{", 
       RowBox[{"r4", "                          ", ",", 
        RowBox[{
         RowBox[{"-", "r3"}], "-", "k2"}], ",", "         ", "k1", ",", 
        "                          ", "0"}], "}"}], ",", 
      "\[IndentingNewLine]", "    ", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "                                   ", "r3", ",", 
        "             ", 
        RowBox[{
         RowBox[{"-", "k1"}], "-", "r2"}], ",", "              ", "k4"}], 
       "}"}], ",", "\[IndentingNewLine]", "    ", 
      RowBox[{"{", 
       RowBox[{
       "k3", ",", "                          ", "0", ",", 
        "                        ", "r2", ",", "           ", 
        RowBox[{
         RowBox[{"-", "k4"}], "-", "r1"}]}], "}"}]}], "}"}], " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"r2", "\[Rule]", 
       RowBox[{"c", "*", "r2"}]}], ",", 
      RowBox[{"k2", "\[Rule]", 
       RowBox[{"c", "*", "k2"}]}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.789583824008664*^9, 3.789583828946269*^9}, {
   3.7907836403413167`*^9, 3.7907836618887463`*^9}, {3.796939511091936*^9, 
   3.7969395285218353`*^9}, {3.796939604518115*^9, 3.796939609106264*^9}, 
   3.797700003956501*^9, {3.8091335510262957`*^9, 3.809133551386372*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"689ad0c0-dea0-4cad-8a2d-060acfc140d0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "Q", "]"}]], "Input",
 CellChangeTimes->{{3.789583830469346*^9, 3.7895838337843866`*^9}, 
   3.796939497680771*^9},
 CellLabel->"In[3]:=",ExpressionUUID->"628a347c-779f-4fe0-b274-94b8b6d49941"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "k3"}], "-", "r4"}], 
      RowBox[{"c", " ", "k2"}], "0", "r1"},
     {"r4", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "c"}], " ", "k2"}], "-", "r3"}], "k1", "0"},
     {"0", "r3", 
      RowBox[{
       RowBox[{"-", "k1"}], "-", 
       RowBox[{"c", " ", "r2"}]}], "k4"},
     {"k3", "0", 
      RowBox[{"c", " ", "r2"}], 
      RowBox[{
       RowBox[{"-", "k4"}], "-", "r1"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.790783454623201*^9, 3.7907836644558144`*^9, {3.7907846129483705`*^9, 
   3.790784624694351*^9}, 3.7907846735886397`*^9, 3.790784904084306*^9, 
   3.7907878364854527`*^9, 3.7907879646963544`*^9, 3.7910406107351117`*^9, 
   3.791040721219733*^9, 3.791041507737971*^9, {3.7910418340692997`*^9, 
   3.7910418403291364`*^9}, 3.791041954561898*^9, 3.7969395580836363`*^9, 
   3.796939612938048*^9, 3.7976788006335015`*^9, 3.797690715464012*^9, 
   3.7976917480128174`*^9, 3.797691797903495*^9, 3.7976922746192365`*^9, 
   3.7977248147217193`*^9, 3.8014281563617477`*^9, 3.8014285063202395`*^9, 
   3.801428556193905*^9, 3.8045207749893975`*^9, 3.8047906924337406`*^9, 
   3.808854727873333*^9, 3.808855210510989*^9, 3.808855647164612*^9, 
   3.809128954573065*^9, 3.809130438679103*^9, 3.809130487008586*^9, 
   3.80913325763646*^9, 3.8091334472429743`*^9, 3.8091335962534637`*^9, 
   3.8091408971072874`*^9, 3.809192696923826*^9, 3.8091950184327726`*^9, 
   3.8091987284198303`*^9, 3.8091998495739636`*^9, 3.8092001150059977`*^9, 
   3.8105797756380544`*^9, 3.8105799687239456`*^9, 3.810580030918251*^9, 
   3.810580182958108*^9, 3.8106503414716935`*^9, 3.81065735008912*^9, 
   3.810993172734497*^9, 3.8112565505764785`*^9, 3.8129096474236*^9, 
   3.813087663997733*^9},
 CellLabel->
  "Out[3]//MatrixForm=",ExpressionUUID->"144e8936-ece6-44b3-a6db-\
6f306f9283c8"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7910419372696214`*^9, 3.7910419438610525`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"64bb8e01-35f2-4ab7-897b-2d302dfdfe44"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", "Q", "]"}]], "Input",
 CellChangeTimes->{{3.7895838717169123`*^9, 3.7895838741134496`*^9}, 
   3.796939497685714*^9},
 CellLabel->"In[5]:=",ExpressionUUID->"1c70661a-586e-4afd-bbfa-0af317b7b526"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGBQA+JngkdTxLzeOP4XX5ANop0ui0XVe79xNGkq1G4F0pOz
m9eA6JYb+zeBaDee8Hcg+tnamxenAuks5l7xZUFvHE8f9HYG0S/SOzxBtI7z
I42eiDeO0y/3f+GPfOOYv/lvxIUEoDlcQVNB9KXw56dBtE5PiH1Y4htH5u/X
f4Boh6ZH/0D0hwKzyAggfePlywIQ7RHR1QyiJxxSE4kB0rPCFeJLgbTboYDG
MiAtN00gsAJIa2Sb3gXRIc+T/oHoSZo/l0ulvHH0EZM+AKInNT88DqLfTXl0
C0SvfrJJxhZICxw82uEApBecn9H0BEg3i1+VSU1949hm9N6zJwPo7n2MZo+B
NABXl5s/
  "],
 CellLabel->"Out[5]=",ExpressionUUID->"b49f920f-64ce-4241-983f-759f5973c9f1"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"eigVectors4", " ", "=", " ", 
   RowBox[{"Eigenvectors", "[", "Q", "  ", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.7895828931904736`*^9, {3.7895838893159084`*^9, 3.7895838909643126`*^9}, {
   3.790784603464886*^9, 3.790784621901783*^9}, 3.7910407181927743`*^9, {
   3.791041829293586*^9, 3.7910418384017344`*^9}, {3.791041950940197*^9, 
   3.7910419523067074`*^9}, 3.796939497696683*^9, 3.8091332389777956`*^9, 
   3.8091335483743877`*^9},
 CellLabel->"In[6]:=",ExpressionUUID->"35c06f23-f104-453a-927e-9756152eb189"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ssVec", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"eigVectors4", "[", 
      RowBox[{"[", "1", "]"}], "]"}], " ", "/", " ", 
     RowBox[{"Total", "[", 
      RowBox[{"eigVectors4", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7895828991696534`*^9, 3.789582907509968*^9}, {
   3.789583894558428*^9, 3.7895839033497224`*^9}, 3.810579997246051*^9},
 CellLabel->"In[7]:=",ExpressionUUID->"dc484be2-c9eb-40bd-ac5d-56e1c63e48d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"pdRate", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"ssVec", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "+", " ", 
      RowBox[{"ssVec", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"NL", " ", "to", " ", 
     RowBox[{"AR", ":", " ", 
      RowBox[{
      "if", " ", "you", " ", "want", " ", "to", " ", "switch", " ", "around", 
       " ", "which", " ", "states", " ", "produce", " ", "mRNA"}]}]}], ",", 
    " ", 
    RowBox[{
    "simply", " ", "change", " ", "the", " ", "indices", " ", "here"}]}], " ",
    "*)"}]}]], "Input",
 CellChangeTimes->{{3.797690670594017*^9, 3.797690691455095*^9}, {
   3.8088545907183447`*^9, 3.8088545932226477`*^9}, 3.8088552028235254`*^9, 
   3.8088556314875393`*^9, {3.809113040706851*^9, 3.809113067755361*^9}, {
   3.8091332318189287`*^9, 3.8091332519377007`*^9}, {3.8091999717572827`*^9, 
   3.80919997417655*^9}, {3.8105796219840527`*^9, 3.81057962550924*^9}, {
   3.8105799965062914`*^9, 3.8105800105983925`*^9}, {3.8112565577120523`*^9, 
   3.81125658997678*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"e0b90688-52d0-4126-80a5-8f6b8cbefb2d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Sharpness", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{"pdRate", ",", "c"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8091130768075113`*^9, 3.8091131074101496`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"2835703c-faa1-4479-ab2c-423a6b5520f9"],

Cell[CellGroupData[{

Cell["Export to matlab format", "Subsection",
 CellChangeTimes->{{3.811256598747637*^9, 
  3.811256602530752*^9}},ExpressionUUID->"5d28bd94-bc73-4346-9e3d-\
99d744aa0dc9"],

Cell[BoxData[
 RowBox[{"<<", "ToMatlab`"}]], "Input",
 CellLabel->"In[10]:=",ExpressionUUID->"e87db274-8d91-4982-b693-f0e74ac44410"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pdRate", " ", "//", "ToMatlab"}]], "Input",
 CellLabel->"In[11]:=",ExpressionUUID->"47885fb7-13c8-42bd-94ee-0ebdaaf420c6"],

Cell[BoxData["\<\"(c.*k2.*k3.*(k1+k4+c.*r2)+k3.*(k4+c.*r2).*r3+(k4+r1+c.*r2).*\
r3.* ...\\n  \
r4).*(c.^2.*k2.*(k3+r1).*r2+(k1+r3).*(k3.*k4+(k4+r1).*r4)+c.*(k2.* ...\\n  \
k3.*k4+k1.*k2.*(k3+k4+r1)+(k3+r1).*r2.*r3+r2.*(r1+r3).*r4)).^(-1); ...\\n  \
\\n\"\>"], "Output",
 CellChangeTimes->{3.8112565534796333`*^9, 3.812909649201309*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"d096096b-1a76-4e2d-9e8a-f85a64299f96"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Sharpness", " ", "//", " ", "ToMatlab"}]], "Input",
 CellLabel->"In[12]:=",ExpressionUUID->"887164a1-0659-44d1-9fc9-8567081e612f"],

Cell[BoxData["\<\"(c.^2.*k2.*(k3+r1).*r2+(k1+r3).*(k3.*k4+(k4+r1).*r4)+c.*(k2.\
*k3.* ...\\n  \
k4+k1.*k2.*(k3+k4+r1)+(k3+r1).*r2.*r3+r2.*(r1+r3).*r4)).^(-2).*( ...\\n  \
k1.^2.*k2.*k3.*(k3.*k4+(k4+r1).*r4)+k1.*(c.^2.*k2.^2.*k3.*k4.*r2+ ...\\n  \
k2.*(k3.*(k4+2.*c.*r2)+(-1).*(k4+r1).*r3).*(k3.*k4+(k4+r1).*r4)+ ...\\n  \
r2.*r3.*(k3+r4).*(k3.*k4+(k4+r1).*r4))+r1.*r2.*((-2).*c.*k2.*r3.*( ...\\n  \
k3.*k4+(k4+r1).*r4)+(-1).*r3.*(r3+r4).*(k3.*k4+(k4+r1).*r4)+(-1).* ...\\n  \
c.^2.*k2.*(k2.*k3.*k4+r2.*((-1).*k3+r3).*r4)));\\n\"\>"], "Output",
 CellChangeTimes->{3.8112565535261374`*^9, 3.812909649230761*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"aee336a7-85ea-4d8f-876e-c99c0bdf29cd"]
}, Open  ]]
}, Open  ]],

Cell[TextData[StyleBox["Solve for passage times from OFF to ON and vice \
versa", "Section"]], "Subsection",
 CellChangeTimes->{{3.8047906449419923`*^9, 3.8047906500752687`*^9}, {
  3.8091331541609793`*^9, 3.8091331659465027`*^9}, {3.8109931917027617`*^9, 
  3.8109931950192366`*^9}},ExpressionUUID->"1857f6e4-9744-4305-a9bc-\
09a799a37bf0"],

Cell[CellGroupData[{

Cell["Solve for cycle flux ", "Subsection",
 CellChangeTimes->{{3.8091916521984525`*^9, 
  3.809191655988432*^9}},ExpressionUUID->"2e29538f-066a-41c3-867a-\
a5fe9cded690"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Z", " ", "=", " ", 
   RowBox[{"Denominator", "[", "pdRate", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.801509890307944*^9, 3.801509895087841*^9}, 
   3.809191808135372*^9},
 CellLabel->"In[13]:=",ExpressionUUID->"0c1b0679-5c2d-432c-afb1-0dee381d6c61"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Jp", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Q", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], "*", 
      RowBox[{"Q", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "3"}], "]"}], "]"}], "*", 
      RowBox[{"Q", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "4"}], "]"}], "]"}], "*", 
      RowBox[{"Q", "[", 
       RowBox[{"[", 
        RowBox[{"4", ",", "1"}], "]"}], "]"}]}], ")"}], " ", "/", " ", 
    "Z"}]}], " ", ";"}]], "Input",
 CellChangeTimes->{{3.8015096726403036`*^9, 3.8015097177615533`*^9}, {
   3.8015099001622086`*^9, 3.8015099130552564`*^9}, {3.8046100063795385`*^9, 
   3.804610024590043*^9}, 3.80919180091991*^9},
 CellLabel->"In[14]:=",ExpressionUUID->"d11b5662-d0ed-46b8-a00c-b0c0ad7f00af"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Jm", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Q", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", 
      RowBox[{"Q", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "2"}], "]"}], "]"}], "*", 
      RowBox[{"Q", "[", 
       RowBox[{"[", 
        RowBox[{"4", ",", "3"}], "]"}], "]"}], "*", 
      RowBox[{"Q", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "4"}], "]"}], "]"}]}], ")"}], " ", "/", " ", 
    "Z"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8015099368955555`*^9, 3.8015099593324957`*^9}, {
   3.8046100357010403`*^9, 3.8046100373442383`*^9}, 3.8046101054635334`*^9, 
   3.809191797918765*^9},
 CellLabel->"In[15]:=",ExpressionUUID->"66cba8b4-c235-4fdd-8095-8dfb585a624e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solve for passage times out of OFF states", "Subsection",
 CellChangeTimes->{{3.8091916737046885`*^9, 3.809191677037258*^9}, {
  3.8091986109799833`*^9, 3.8091986319324436`*^9}, {3.8105797535187654`*^9, 
  3.8105797538171806`*^9}},ExpressionUUID->"b579afb2-8b6f-42d8-8990-\
5ddfd9925c6f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqET2ON", " ", "=", " ", 
   RowBox[{"ET2ON", " ", "\[Equal]", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "/", 
      RowBox[{"Q", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "*", 
     RowBox[{"(", 
      RowBox[{"1", " ", "+", 
       RowBox[{
        RowBox[{"Q", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}], "*", "ET1ON"}]}], 
      ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7903526643834977`*^9, 3.790352741300044*^9}, {
  3.790352771329322*^9, 3.7903527888450565`*^9}, {3.796939497707224*^9, 
  3.796939497709179*^9}, {3.797691309545168*^9, 3.797691321798501*^9}, {
  3.797691437136017*^9, 3.797691447559453*^9}, {3.7976914892740564`*^9, 
  3.7976915419262304`*^9}, {3.7977247418084974`*^9, 3.797724781139964*^9}, {
  3.8091132983596773`*^9, 3.809113319853002*^9}, {3.8091134828206825`*^9, 
  3.809113482863633*^9}, {3.8091303638214903`*^9, 3.809130393568552*^9}, {
  3.8091333378998027`*^9, 3.8091333398605576`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"c634d029-5498-4d9d-899b-49105f0ac7e6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqET1ON", " ", "=", " ", 
   RowBox[{"ET1ON", " ", "\[Equal]", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "/", 
      RowBox[{"Q", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "*", 
     RowBox[{"(", 
      RowBox[{"1", " ", "+", 
       RowBox[{
        RowBox[{"Q", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", "ET2ON"}]}], 
      ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7903527933020215`*^9, 3.7903528424044085`*^9}, {
  3.7969394977162066`*^9, 3.7969394977211485`*^9}, {3.7976913115668573`*^9, 
  3.7976913199286685`*^9}, {3.797691440480961*^9, 3.797691450682639*^9}, {
  3.7976915021135836`*^9, 3.797691520975018*^9}, {3.7976915616003685`*^9, 
  3.7976915764082785`*^9}, {3.797724783893737*^9, 3.797724811074451*^9}, {
  3.8091133259651136`*^9, 3.80911332609035*^9}, {3.80911335715033*^9, 
  3.809113371177786*^9}, {3.809113480517356*^9, 3.8091134805759516`*^9}, {
  3.8091304079151945`*^9, 3.809130409659158*^9}, {3.809133312289928*^9, 
  3.8091333432246895`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"d880dadb-2289-4195-ad4e-0686c6cc6f3e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"solETON", "=", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eqET1ON", ",", "eqET2ON"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ET1ON", ",", "ET2ON"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7977248521361184`*^9, 3.7977248808104863`*^9}, {
  3.8091133796405272`*^9, 3.8091133818185263`*^9}, {3.8091333486267405`*^9, 
  3.809133352867082*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"14fde9d1-3cd0-47ea-b0d4-a71385fe202f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ET1ONval", " ", "=", " ", 
   RowBox[{"ET1ON", " ", "/.", " ", 
    RowBox[{"solETON", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7977248877758446`*^9, 3.7977249034842606`*^9}, {
  3.8091133864423475`*^9, 3.8091133906257815`*^9}, {3.809133356226132*^9, 
  3.8091333587004786`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"73445a63-6c17-4c6d-ac84-36bd6246e862"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ET2ONval", " ", "=", " ", 
   RowBox[{"ET2ON", " ", "/.", " ", 
    RowBox[{"solETON", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7977249093103094`*^9, 3.7977249177440896`*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"86bc9981-aaef-4511-b7aa-4adb8e6d2a89"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TauOff", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"ssVec", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "*", "k1", "*", "ET2ONval"}], "+", 
      RowBox[{
       RowBox[{"ssVec", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "*", "r1", "*", "ET1ONval"}]}], ")"}],
     "/", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"ssVec", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "*", "k1"}], "+", 
      RowBox[{
       RowBox[{"ssVec", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "*", "r1"}]}], ")"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7977249233261013`*^9, 3.7977249395565014`*^9}, {
   3.797724988987359*^9, 3.7977250031495123`*^9}, 3.797725209531647*^9, {
   3.809113426828415*^9, 3.809113450326397*^9}, {3.809113507830828*^9, 
   3.809113513573223*^9}, {3.8091137975583553`*^9, 3.8091138027298126`*^9}, {
   3.80912894163996*^9, 3.809128943262169*^9}, {3.8091304827913165`*^9, 
   3.8091304841217895`*^9}, {3.809131651084964*^9, 3.8091316569851832`*^9}, {
   3.8091333619777145`*^9, 3.8091333629302063`*^9}, {3.80913340834813*^9, 
   3.809133437599765*^9}, {3.809191761103484*^9, 3.809191764777996*^9}, {
   3.8091918690272875`*^9, 3.8091918911133723`*^9}, {3.8091919322836657`*^9, 
   3.8091919439578886`*^9}, {3.8091998014970455`*^9, 3.80919984536535*^9}, {
   3.8100585665543785`*^9, 3.8100585705490446`*^9}, {3.810579760186672*^9, 
   3.8105797605300727`*^9}, {3.810579884693327*^9, 3.8105799051854362`*^9}, {
   3.8105799554503994`*^9, 3.8105799608315105`*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"838b8b91-6b4f-4235-82e5-c11b4bfaedd2"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"k1", " ", "k3", " ", "k4"}], "+", 
   RowBox[{"c", " ", "k1", " ", "k2", " ", 
    RowBox[{"(", 
     RowBox[{"k4", "+", "r1"}], ")"}]}], "+", 
   RowBox[{
    SuperscriptBox["c", "2"], " ", "k2", " ", "r1", " ", "r2"}], "+", 
   RowBox[{"k1", " ", 
    RowBox[{"(", 
     RowBox[{"k4", "+", "r1"}], ")"}], " ", "r4"}], "+", 
   RowBox[{"c", " ", "r1", " ", "r2", " ", 
    RowBox[{"(", 
     RowBox[{"r3", "+", "r4"}], ")"}]}]}], 
  RowBox[{
   RowBox[{"c", " ", "k1", " ", "k2", " ", "k3", " ", 
    RowBox[{"(", 
     RowBox[{"k4", "+", "r1"}], ")"}]}], "+", 
   RowBox[{
    SuperscriptBox["c", "2"], " ", "k2", " ", "k3", " ", "r1", " ", "r2"}], 
   "+", 
   RowBox[{"k1", " ", "k3", " ", "k4", " ", "r3"}], "+", 
   RowBox[{"k1", " ", 
    RowBox[{"(", 
     RowBox[{"k4", "+", "r1"}], ")"}], " ", "r3", " ", "r4"}], "+", 
   RowBox[{"c", " ", "r1", " ", "r2", " ", "r3", " ", 
    RowBox[{"(", 
     RowBox[{"k3", "+", "r4"}], ")"}]}]}]]], "Output",
 CellChangeTimes->{3.8091334516751523`*^9, 3.8091336014411306`*^9, 
  3.809140903992941*^9, 3.8091919728629527`*^9, 3.809192701163785*^9, 
  3.8091950230847135`*^9, 3.8091987331135373`*^9, 3.8091998541469975`*^9, 
  3.8092001196305704`*^9, 3.810579793970358*^9, 3.810579976763488*^9, 
  3.810580037848159*^9, 3.810580189490852*^9, 3.8106503479508696`*^9, 
  3.8106573563398523`*^9, 3.8109931746723056`*^9, 3.8112565541462984`*^9, 
  3.8129096496395764`*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"26d00e10-877b-40c2-9d82-971c8f983135"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"konEff", " ", "=", " ", 
  RowBox[{"1", "/", "TauOff"}]}]], "Input",
 CellChangeTimes->{{3.809198591085495*^9, 3.809198593582676*^9}, {
  3.8091987083220434`*^9, 3.809198708745072*^9}, {3.810579764944683*^9, 
  3.8105797663501596`*^9}, {3.810579813135214*^9, 3.8105798134651527`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"b6a82ad5-47b2-424a-acc7-4f0123f9696d"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"c", " ", "k1", " ", "k2", " ", "k3", " ", 
    RowBox[{"(", 
     RowBox[{"k4", "+", "r1"}], ")"}]}], "+", 
   RowBox[{
    SuperscriptBox["c", "2"], " ", "k2", " ", "k3", " ", "r1", " ", "r2"}], 
   "+", 
   RowBox[{"k1", " ", "k3", " ", "k4", " ", "r3"}], "+", 
   RowBox[{"k1", " ", 
    RowBox[{"(", 
     RowBox[{"k4", "+", "r1"}], ")"}], " ", "r3", " ", "r4"}], "+", 
   RowBox[{"c", " ", "r1", " ", "r2", " ", "r3", " ", 
    RowBox[{"(", 
     RowBox[{"k3", "+", "r4"}], ")"}]}]}], 
  RowBox[{
   RowBox[{"k1", " ", "k3", " ", "k4"}], "+", 
   RowBox[{"c", " ", "k1", " ", "k2", " ", 
    RowBox[{"(", 
     RowBox[{"k4", "+", "r1"}], ")"}]}], "+", 
   RowBox[{
    SuperscriptBox["c", "2"], " ", "k2", " ", "r1", " ", "r2"}], "+", 
   RowBox[{"k1", " ", 
    RowBox[{"(", 
     RowBox[{"k4", "+", "r1"}], ")"}], " ", "r4"}], "+", 
   RowBox[{"c", " ", "r1", " ", "r2", " ", 
    RowBox[{"(", 
     RowBox[{"r3", "+", "r4"}], ")"}]}]}]]], "Output",
 CellChangeTimes->{3.8091985940019865`*^9, 3.8091987332588797`*^9, 
  3.809199854305031*^9, 3.809200119775182*^9, 3.8105797941715484`*^9, 
  3.810579976913921*^9, 3.810580037912721*^9, 3.8105801895671606`*^9, 
  3.8106503480196466`*^9, 3.810657356405678*^9, 3.8109931746915083`*^9, 
  3.8112565541871567`*^9, 3.8129096496686473`*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"3003f3cc-7de2-4d21-9473-059d436420a2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solve for passage times out of ON states", "Subsection",
 CellChangeTimes->{{3.8091986419468756`*^9, 3.809198645330735*^9}, 
   3.8105797310894322`*^9},ExpressionUUID->"1fc4c8e4-7e11-4b6e-9d96-\
e86729779e30"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqET3OFF", " ", "=", " ", 
   RowBox[{"ET3OFF", " ", "\[Equal]", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "/", 
      RowBox[{"Q", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "*", 
     RowBox[{"(", 
      RowBox[{"1", " ", "+", 
       RowBox[{
        RowBox[{"Q", "[", 
         RowBox[{"[", 
          RowBox[{"4", ",", "3"}], "]"}], "]"}], "*", "ET4OFF"}]}], 
      ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7903526643834977`*^9, 3.790352741300044*^9}, {
  3.790352771329322*^9, 3.7903527888450565`*^9}, {3.796939497707224*^9, 
  3.796939497709179*^9}, {3.797691309545168*^9, 3.797691321798501*^9}, {
  3.797691437136017*^9, 3.797691447559453*^9}, {3.7976914892740564`*^9, 
  3.7976915419262304`*^9}, {3.7977247418084974`*^9, 3.797724781139964*^9}, {
  3.797726452447869*^9, 3.797726489862119*^9}, {3.797726578593175*^9, 
  3.7977265789043317`*^9}, {3.8091135268231926`*^9, 3.809113537522169*^9}, {
  3.8091333712271504`*^9, 3.8091333828993793`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"d5ce43c1-b428-49f0-a514-59d8e766e09f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqET4OFF", " ", "=", " ", 
   RowBox[{"ET4OFF", " ", "\[Equal]", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "/", 
      RowBox[{"Q", "[", 
       RowBox[{"[", 
        RowBox[{"4", ",", "4"}], "]"}], "]"}]}], "*", 
     RowBox[{"(", 
      RowBox[{"1", " ", "+", 
       RowBox[{
        RowBox[{"Q", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "4"}], "]"}], "]"}], "*", "ET3OFF"}]}], 
      ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7903527933020215`*^9, 3.7903528424044085`*^9}, {
  3.7969394977162066`*^9, 3.7969394977211485`*^9}, {3.7976913115668573`*^9, 
  3.7976913199286685`*^9}, {3.797691440480961*^9, 3.797691450682639*^9}, {
  3.7976915021135836`*^9, 3.797691520975018*^9}, {3.7976915616003685`*^9, 
  3.7976915764082785`*^9}, {3.797724783893737*^9, 3.797724811074451*^9}, {
  3.797726494619665*^9, 3.7977265138508267`*^9}, {3.7977265721777964`*^9, 
  3.797726575383752*^9}, {3.8091135422687063`*^9, 3.8091135456429996`*^9}, {
  3.8091333900947266`*^9, 3.8091333927665367`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"bc013709-557a-4107-bbc9-2a59fff48a4e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solETOFF", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"eqET3OFF", ",", "eqET4OFF"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"ET3OFF", ",", "ET4OFF"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7977248521361184`*^9, 3.7977248808104863`*^9}, {
   3.797726520981132*^9, 3.7977265889162164`*^9}, 3.797726700060444*^9, {
   3.809113553355644*^9, 3.8091135577748723`*^9}, {3.8091333963130517`*^9, 
   3.8091334008440933`*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"677ffd6b-034f-4f2b-bdd3-aff9f5118ccf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ET3OFF", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "k4"}], "-", "r1", "-", 
        RowBox[{"c", " ", "r2"}]}], 
       RowBox[{
        RowBox[{"k1", " ", "k4"}], "+", 
        RowBox[{"k1", " ", "r1"}], "+", 
        RowBox[{"c", " ", "r1", " ", "r2"}]}]]}]}], ",", 
    RowBox[{"ET4OFF", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "k1"}], "-", "k4", "-", 
        RowBox[{"c", " ", "r2"}]}], 
       RowBox[{
        RowBox[{"k1", " ", "k4"}], "+", 
        RowBox[{"k1", " ", "r1"}], "+", 
        RowBox[{"c", " ", "r1", " ", "r2"}]}]]}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.8047907226066008`*^9, 3.808854762271002*^9, 
  3.8088552251495075`*^9, 3.8088556615134506`*^9, 3.809113558382378*^9, 
  3.8091289564392767`*^9, 3.8091304407694736`*^9, 3.809130489583703*^9, 
  3.8091334519483967`*^9, 3.80913360165456*^9, 3.8091409042383285`*^9, 
  3.8091919730068645`*^9, 3.809192701308858*^9, 3.8091950233277197`*^9, 
  3.8091987334205947`*^9, 3.8091998544718823`*^9, 3.809200119941737*^9, 
  3.8105797944353514`*^9, 3.8105799771743813`*^9, 3.8105800382245693`*^9, 
  3.810580189873475*^9, 3.810650348211176*^9, 3.8106573566111307`*^9, 
  3.8109931747409515`*^9, 3.8112565543027725`*^9, 3.812909649743332*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"eaba5ec1-7931-459b-8345-f59599e7d6dc"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ET3OFFval", " ", "=", " ", 
   RowBox[{"ET3OFF", " ", "/.", " ", 
    RowBox[{"solETOFF", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7977248877758446`*^9, 3.7977249034842606`*^9}, {
   3.797726544220775*^9, 3.7977265552822275`*^9}, 3.797726596497665*^9, {
   3.809113562951575*^9, 3.8091135663350587`*^9}, {3.809133403594606*^9, 
   3.8091334235953617`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"3d79e30b-c186-40aa-8b8f-e9621f37b9d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ET4OFFval", " ", "=", " ", 
   RowBox[{"ET4OFF", " ", "/.", " ", 
    RowBox[{"solETOFF", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7977249093103094`*^9, 3.7977249177440896`*^9}, {
  3.79772660133076*^9, 3.797726608326315*^9}, {3.7977266917741013`*^9, 
  3.797726712423646*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"aeef49ba-86a0-40f8-a85a-7d7af1e971b6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TauOn", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"ssVec", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "*", "r3", "*", "ET3OFFval"}], "+", 
      RowBox[{
       RowBox[{"ssVec", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "*", "k3", "*", "ET4OFFval"}]}], 
     ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"ssVec", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "*", "r3"}], "+", 
      RowBox[{
       RowBox[{"ssVec", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "*", "k3"}]}], ")"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7977249233261013`*^9, 3.7977249395565014`*^9}, {
   3.797724988987359*^9, 3.7977250031495123`*^9}, 3.797725209531647*^9, {
   3.7977266126278176`*^9, 3.7977266415639954`*^9}, 3.797726718879698*^9, {
   3.809113572877442*^9, 3.8091135846749053`*^9}, {3.8091137417896204`*^9, 
   3.809113760612014*^9}, {3.809128936569214*^9, 3.8091289462650986`*^9}, {
   3.8091304625955315`*^9, 3.809130466481138*^9}, {3.8091334317416124`*^9, 
   3.8091334398158383`*^9}, 3.809133614485281*^9, {3.8091919078448277`*^9, 
   3.8091919793438663`*^9}, {3.809199712900734*^9, 3.80919978631422*^9}, {
   3.810058523505707*^9, 3.8100585249431715`*^9}, {3.8100585770430555`*^9, 
   3.8100585802764935`*^9}, {3.810579735996231*^9, 3.810579736870017*^9}, {
   3.810579955460333*^9, 3.810579955477315*^9}, {3.8105800965414243`*^9, 
   3.8105801161600513`*^9}, {3.8105801591402445`*^9, 3.810580161150533*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"40c3db1e-d5aa-4a52-8d96-f939059c9029"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"c", " ", "k2", " ", "k3", " ", 
    RowBox[{"(", 
     RowBox[{"k1", "+", "k4", "+", 
      RowBox[{"c", " ", "r2"}]}], ")"}]}], "+", 
   RowBox[{"k3", " ", 
    RowBox[{"(", 
     RowBox[{"k4", "+", 
      RowBox[{"c", " ", "r2"}]}], ")"}], " ", "r3"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"k4", "+", "r1", "+", 
      RowBox[{"c", " ", "r2"}]}], ")"}], " ", "r3", " ", "r4"}]}], 
  RowBox[{
   RowBox[{"c", " ", "k1", " ", "k2", " ", "k3", " ", 
    RowBox[{"(", 
     RowBox[{"k4", "+", "r1"}], ")"}]}], "+", 
   RowBox[{
    SuperscriptBox["c", "2"], " ", "k2", " ", "k3", " ", "r1", " ", "r2"}], 
   "+", 
   RowBox[{"k1", " ", "k3", " ", "k4", " ", "r3"}], "+", 
   RowBox[{"k1", " ", 
    RowBox[{"(", 
     RowBox[{"k4", "+", "r1"}], ")"}], " ", "r3", " ", "r4"}], "+", 
   RowBox[{"c", " ", "r1", " ", "r2", " ", "r3", " ", 
    RowBox[{"(", 
     RowBox[{"k3", "+", "r4"}], ")"}]}]}]]], "Output",
 CellChangeTimes->{
  3.8091919803084497`*^9, 3.8091927015899925`*^9, 3.809195023582267*^9, 
   3.8091987336981707`*^9, 3.809199854880571*^9, 3.8092001203895397`*^9, 
   3.810579799277359*^9, 3.8105799776273403`*^9, 3.8105800429629803`*^9, {
   3.8105801625072565`*^9, 3.8105801904002447`*^9}, 3.8106503487983074`*^9, 
   3.8106573571646857`*^9, 3.810993174851241*^9, 3.8112565545770483`*^9, 
   3.8129096499649115`*^9},
 CellLabel->"Out[28]=",ExpressionUUID->"167643e8-0b86-4d60-9ee4-69e4c84db1b9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"koffEff", " ", "=", " ", 
  RowBox[{"1", "/", "TauOn"}]}]], "Input",
 CellChangeTimes->{{3.8091985742533193`*^9, 3.8091985779911633`*^9}, {
  3.809198695151467*^9, 3.809198697071311*^9}, {3.810579740780826*^9, 
  3.810579746369131*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"11e52587-1ad6-4307-b1b6-c6295c05a8a3"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"c", " ", "k1", " ", "k2", " ", "k3", " ", 
    RowBox[{"(", 
     RowBox[{"k4", "+", "r1"}], ")"}]}], "+", 
   RowBox[{
    SuperscriptBox["c", "2"], " ", "k2", " ", "k3", " ", "r1", " ", "r2"}], 
   "+", 
   RowBox[{"k1", " ", "k3", " ", "k4", " ", "r3"}], "+", 
   RowBox[{"k1", " ", 
    RowBox[{"(", 
     RowBox[{"k4", "+", "r1"}], ")"}], " ", "r3", " ", "r4"}], "+", 
   RowBox[{"c", " ", "r1", " ", "r2", " ", "r3", " ", 
    RowBox[{"(", 
     RowBox[{"k3", "+", "r4"}], ")"}]}]}], 
  RowBox[{
   RowBox[{"c", " ", "k2", " ", "k3", " ", 
    RowBox[{"(", 
     RowBox[{"k1", "+", "k4", "+", 
      RowBox[{"c", " ", "r2"}]}], ")"}]}], "+", 
   RowBox[{"k3", " ", 
    RowBox[{"(", 
     RowBox[{"k4", "+", 
      RowBox[{"c", " ", "r2"}]}], ")"}], " ", "r3"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"k4", "+", "r1", "+", 
      RowBox[{"c", " ", "r2"}]}], ")"}], " ", "r3", " ", "r4"}]}]]], "Output",
 CellChangeTimes->{
  3.809198578818167*^9, 3.8091987337529945`*^9, 3.8091998549480877`*^9, 
   3.8092001204503813`*^9, 3.8105797995313187`*^9, 3.810579977694091*^9, 
   3.8105800431320667`*^9, {3.810580165140219*^9, 3.8105801904660673`*^9}, 
   3.8106503488681617`*^9, 3.8106573572304707`*^9, 3.810993174870793*^9, 
   3.811256554622471*^9, 3.812909649996826*^9},
 CellLabel->"Out[29]=",ExpressionUUID->"f277522a-3896-4c3f-a8bc-6764a22f25e3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sanity check for self-consistency", "Subsection",
 CellChangeTimes->{{3.8092827358260736`*^9, 
  3.8092827430170217`*^9}},ExpressionUUID->"b3a98ca1-fea4-4e08-96ae-\
216fab1881f5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pdRateAlt", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"konEff", " ", "/", " ", 
    RowBox[{"(", 
     RowBox[{"konEff", "+", "koffEff"}], ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8091986814353914`*^9, 3.8091987233442526`*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"7d7563f2-60aa-43dc-baa5-bc14bcea3144"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"c", " ", "k2", " ", "k3", " ", 
    RowBox[{"(", 
     RowBox[{"k1", "+", "k4", "+", 
      RowBox[{"c", " ", "r2"}]}], ")"}]}], "+", 
   RowBox[{"k3", " ", 
    RowBox[{"(", 
     RowBox[{"k4", "+", 
      RowBox[{"c", " ", "r2"}]}], ")"}], " ", "r3"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"k4", "+", "r1", "+", 
      RowBox[{"c", " ", "r2"}]}], ")"}], " ", "r3", " ", "r4"}]}], 
  RowBox[{
   RowBox[{
    SuperscriptBox["c", "2"], " ", "k2", " ", 
    RowBox[{"(", 
     RowBox[{"k3", "+", "r1"}], ")"}], " ", "r2"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"k1", "+", "r3"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"k3", " ", "k4"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"k4", "+", "r1"}], ")"}], " ", "r4"}]}], ")"}]}], "+", 
   RowBox[{"c", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"k2", " ", "k3", " ", "k4"}], "+", 
      RowBox[{"k1", " ", "k2", " ", 
       RowBox[{"(", 
        RowBox[{"k3", "+", "k4", "+", "r1"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"k3", "+", "r1"}], ")"}], " ", "r2", " ", "r3"}], "+", 
      RowBox[{"r2", " ", 
       RowBox[{"(", 
        RowBox[{"r1", "+", "r3"}], ")"}], " ", "r4"}]}], ")"}]}]}]]], "Output",
 CellChangeTimes->{
  3.809198734950424*^9, 3.8091998552939353`*^9, 3.8092001207406006`*^9, 
   3.8105797996114597`*^9, 3.810579983107894*^9, 3.8105800593973117`*^9, {
   3.81058016782436*^9, 3.810580190863472*^9}, 3.8106503492441783`*^9, 
   3.810657357594531*^9, 3.8109931749503255`*^9, 3.811256554665959*^9, 
   3.812909650030697*^9},
 CellLabel->"Out[30]=",ExpressionUUID->"423f520f-8a51-485f-9bd7-3d119739a888"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["pdRate"], "Input",
 CellChangeTimes->{{3.8091998815446763`*^9, 3.8091998822172112`*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"706bf252-1e0f-44f1-9ffe-bb98ba34047e"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"c", " ", "k2", " ", "k3", " ", 
    RowBox[{"(", 
     RowBox[{"k1", "+", "k4", "+", 
      RowBox[{"c", " ", "r2"}]}], ")"}]}], "+", 
   RowBox[{"k3", " ", 
    RowBox[{"(", 
     RowBox[{"k4", "+", 
      RowBox[{"c", " ", "r2"}]}], ")"}], " ", "r3"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"k4", "+", "r1", "+", 
      RowBox[{"c", " ", "r2"}]}], ")"}], " ", "r3", " ", "r4"}]}], 
  RowBox[{
   RowBox[{
    SuperscriptBox["c", "2"], " ", "k2", " ", 
    RowBox[{"(", 
     RowBox[{"k3", "+", "r1"}], ")"}], " ", "r2"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"k1", "+", "r3"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"k3", " ", "k4"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"k4", "+", "r1"}], ")"}], " ", "r4"}]}], ")"}]}], "+", 
   RowBox[{"c", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"k2", " ", "k3", " ", "k4"}], "+", 
      RowBox[{"k1", " ", "k2", " ", 
       RowBox[{"(", 
        RowBox[{"k3", "+", "k4", "+", "r1"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"k3", "+", "r1"}], ")"}], " ", "r2", " ", "r3"}], "+", 
      RowBox[{"r2", " ", 
       RowBox[{"(", 
        RowBox[{"r1", "+", "r3"}], ")"}], " ", "r4"}]}], ")"}]}]}]]], "Output",
 CellChangeTimes->{3.80919988286627*^9, 3.8091999805286894`*^9, 
  3.809200120867262*^9, 3.8105797996885805`*^9, 3.8105799832733254`*^9, 
  3.8105800595184584`*^9, 3.8105801909914713`*^9, 3.8106503494207087`*^9, 
  3.8106573576653485`*^9, 3.810993174972728*^9, 3.8112565547105017`*^9, 
  3.812909650061861*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"aa97aed3-a3d8-45b4-acc0-feb4fb34fa1a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"pdRateAlt", "/", "pdRate"}], "]"}]], "Input",
 CellChangeTimes->{{3.809199920237712*^9, 3.8091999286466923`*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"2f724109-c696-4092-a28d-e37f3cf648ea"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.8091999293143134`*^9, 3.8092001209261045`*^9, 3.810579800242873*^9, 
   3.8105799967433925`*^9, 3.810580076153293*^9, {3.810580172601699*^9, 
   3.8105801911126094`*^9}, 3.810650349497545*^9, 3.8106573578348527`*^9, 
   3.8109931749973803`*^9, 3.8112565547563834`*^9, 3.812909650094033*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"ada20261-e17c-4668-bf90-24bcf757a302"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TauCycle", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"TauOff", "+", "TauOn"}], " ", "]"}]}]], "Input",
 CellChangeTimes->{{3.810657319557191*^9, 3.8106573419548736`*^9}, {
   3.810657732155799*^9, 3.8106577394846077`*^9}, 3.8129098307375016`*^9},
 CellLabel->"In[56]:=",ExpressionUUID->"bb8188c9-adb0-4f54-9ce5-67ea91c8a07c"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    SuperscriptBox["c", "2"], " ", "k2", " ", 
    RowBox[{"(", 
     RowBox[{"k3", "+", "r1"}], ")"}], " ", "r2"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"k1", "+", "r3"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"k3", " ", "k4"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"k4", "+", "r1"}], ")"}], " ", "r4"}]}], ")"}]}], "+", 
   RowBox[{"c", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"k2", " ", "k3", " ", "k4"}], "+", 
      RowBox[{"k1", " ", "k2", " ", 
       RowBox[{"(", 
        RowBox[{"k3", "+", "k4", "+", "r1"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"k3", "+", "r1"}], ")"}], " ", "r2", " ", "r3"}], "+", 
      RowBox[{"r2", " ", 
       RowBox[{"(", 
        RowBox[{"r1", "+", "r3"}], ")"}], " ", "r4"}]}], ")"}]}]}], 
  RowBox[{
   RowBox[{"c", " ", "k1", " ", "k2", " ", "k3", " ", 
    RowBox[{"(", 
     RowBox[{"k4", "+", "r1"}], ")"}]}], "+", 
   RowBox[{
    SuperscriptBox["c", "2"], " ", "k2", " ", "k3", " ", "r1", " ", "r2"}], 
   "+", 
   RowBox[{"k1", " ", "k3", " ", "k4", " ", "r3"}], "+", 
   RowBox[{"k1", " ", 
    RowBox[{"(", 
     RowBox[{"k4", "+", "r1"}], ")"}], " ", "r3", " ", "r4"}], "+", 
   RowBox[{"c", " ", "r1", " ", "r2", " ", "r3", " ", 
    RowBox[{"(", 
     RowBox[{"k3", "+", "r4"}], ")"}]}]}]]], "Output",
 CellChangeTimes->{
  3.810657358054306*^9, 3.810657741518218*^9, 3.8109931752393355`*^9, 
   3.811256555166333*^9, 3.812909650430315*^9, {3.8129098274002857`*^9, 
   3.812909831431261*^9}},
 CellLabel->"Out[56]=",ExpressionUUID->"60e6140f-8f12-4dbd-9f2d-13a242e2583d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol", " ", "=", " ", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TauCycle", "\[Equal]", "T"}], ",", 
      RowBox[{"r2", " ", "\[Equal]", " ", 
       RowBox[{"k1", "*", "k2", "*", "k3", "*", 
        RowBox[{"k4", "/", 
         RowBox[{"(", 
          RowBox[{"r1", "*", "r3", "*", "r4"}], ")"}]}]}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"k1", ",", "r1"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.812909872428094*^9, 3.8129099042995863`*^9}, {
  3.812914299646345*^9, 3.8129143067759714`*^9}, {3.812914386789116*^9, 
  3.812914421056408*^9}, {3.8129144719871197`*^9, 3.8129144748881693`*^9}},
 CellLabel->"",ExpressionUUID->"80596dd5-81c0-4657-bce1-a0926df8118e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"k1", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"k4", "+", 
         RowBox[{"c", " ", "r2"}]}], ")"}], " ", "r3", " ", "r4"}], 
      RowBox[{"k4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "c"}], " ", "k2"}], "-", "r4", "+", 
         RowBox[{"c", " ", "k2", " ", "k3", " ", "T"}], "+", 
         RowBox[{"r3", " ", "r4", " ", "T"}]}], ")"}]}]]}], ",", 
    RowBox[{"r1", "\[Rule]", 
     FractionBox[
      RowBox[{"k2", " ", "k3", " ", 
       RowBox[{"(", 
        RowBox[{"k4", "+", 
         RowBox[{"c", " ", "r2"}]}], ")"}]}], 
      RowBox[{"r2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "c"}], " ", "k2"}], "-", "r4", "+", 
         RowBox[{"c", " ", "k2", " ", "k3", " ", "T"}], "+", 
         RowBox[{"r3", " ", "r4", " ", "T"}]}], ")"}]}]]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8129098904528227`*^9, 3.812909916806748*^9}, 
   3.812914307589359*^9, 3.8129144222097673`*^9},
 CellLabel->"Out[60]=",ExpressionUUID->"e28c3687-9925-4d42-9d0e-8f917b26c0b6"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["What changes when we drive these rates away from equilibrium", \
"Subsection",
 CellChangeTimes->{{3.8092827785558987`*^9, 
  3.8092827992020473`*^9}},ExpressionUUID->"6c7b72d3-3443-4ac7-91e9-\
58d76551312a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"konEffEq", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"konEff", " ", "/.", 
    RowBox[{"{", 
     RowBox[{"r4", "\[Rule]", 
      RowBox[{"k1", "*", "k2", "*", "k3", "*", 
       RowBox[{"k4", " ", "/", " ", 
        RowBox[{"(", 
         RowBox[{"r1", "*", "r2", "*", "r3"}], ")"}]}]}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8092832019040623`*^9, 3.809283204959598*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"67f7f591-5027-4e7d-98f8-c5dab45922e5"],

Cell[BoxData[
 FractionBox[
  RowBox[{"k3", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"k1", " ", "k4"}], "+", 
     RowBox[{"c", " ", "r1", " ", "r2"}]}], ")"}], " ", "r3"}], 
  RowBox[{
   RowBox[{"k1", " ", "k3", " ", "k4"}], "+", 
   RowBox[{"c", " ", "r1", " ", "r2", " ", "r3"}]}]]], "Output",
 CellChangeTimes->{3.809283205739066*^9, 3.8105798006543665`*^9, 
  3.8105799972573233`*^9, 3.810580191196154*^9, 3.810650349563361*^9, 
  3.810657358120138*^9, 3.8109931755990996`*^9, 3.8112565557033415`*^9, 
  3.8129096509536767`*^9},
 CellLabel->"Out[37]=",ExpressionUUID->"b1664b4e-b787-4251-af4d-89181b8bf4b4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"koffEffEq", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"koffEff", " ", "/.", 
    RowBox[{"{", 
     RowBox[{"r4", "\[Rule]", 
      RowBox[{"k1", "*", "k2", "*", "k3", "*", 
       RowBox[{"k4", " ", "/", " ", 
        RowBox[{"(", 
         RowBox[{"r1", "*", "r2", "*", "r3"}], ")"}]}]}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.809283798662925*^9, 3.809283801965743*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"f9bfbdb0-f6e4-4b56-bef3-d612486062c0"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"k1", " ", "k4"}], "+", 
   RowBox[{"c", " ", "r1", " ", "r2"}]}], 
  RowBox[{"k4", "+", 
   RowBox[{"c", " ", "r2"}]}]]], "Output",
 CellChangeTimes->{3.809283805512349*^9, 3.8105798008457394`*^9, 
  3.810579997466992*^9, 3.8105801912665367`*^9, 3.8106503496261997`*^9, 
  3.810657358185933*^9, 3.810993175620347*^9, 3.811256555748401*^9, 
  3.812909650991912*^9},
 CellLabel->"Out[38]=",ExpressionUUID->"2083725a-99e3-420c-aad2-86ad9f6f5885"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"konEffNeq", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"konEff", " ", "/.", 
      RowBox[{"{", 
       RowBox[{"r4", "\[Rule]", 
        RowBox[{"k1", "*", "k2", "*", "k3", "*", 
         RowBox[{
          RowBox[{"k4", " ", "/", " ", 
           RowBox[{"(", 
            RowBox[{"r1", "*", "r2", "*", "r3"}], ")"}]}], "/", "B"}]}]}], 
       "}"}]}], ")"}], " ", "-", "konEffEq"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.809282852201005*^9, 3.8092829387831516`*^9}, {
  3.8092830316461053`*^9, 3.8092830619367075`*^9}, {3.809283209224785*^9, 
  3.8092832322350693`*^9}, {3.8092836497774487`*^9, 3.809283653206223*^9}, {
  3.8092868689008007`*^9, 3.809286869146778*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"0cfbe9ca-d608-441a-b55b-598703c5553e"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "B"}], ")"}], " ", "c", " ", "k1", " ", "k2", 
   " ", "k3", " ", "k4", " ", "r1", " ", "r2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"k1", " ", 
      RowBox[{"(", 
       RowBox[{"k4", "+", "r1"}], ")"}]}], "+", 
     RowBox[{"c", " ", "r1", " ", "r2"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"k3", "-", "r3"}], ")"}], " ", "r3"}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"k1", " ", "k3", " ", "k4"}], "+", 
     RowBox[{"c", " ", "r1", " ", "r2", " ", "r3"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["k1", "2"], " ", "k2", " ", "k3", " ", "k4", " ", 
      RowBox[{"(", 
       RowBox[{"k4", "+", "r1"}], ")"}]}], "+", 
     RowBox[{"B", " ", "c", " ", 
      SuperscriptBox["r1", "2"], " ", 
      SuperscriptBox["r2", "2"], " ", "r3", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", " ", "k2"}], "+", "r3"}], ")"}]}], "+", 
     RowBox[{"k1", " ", "r1", " ", "r2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"B", " ", "k3", " ", "k4", " ", "r3"}], "+", 
        RowBox[{"c", " ", "k2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"k3", " ", "k4"}], "+", 
           RowBox[{"B", " ", 
            RowBox[{"(", 
             RowBox[{"k4", "+", "r1"}], ")"}], " ", "r3"}]}], ")"}]}]}], 
       ")"}]}]}], ")"}]}]]], "Output",
 CellChangeTimes->{
  3.8092829122940693`*^9, 3.8092829475472903`*^9, 3.8092830648166275`*^9, {
   3.8092832144822645`*^9, 3.8092832333029485`*^9}, {3.8092836501841536`*^9, 
   3.809283653726222*^9}, 3.8092868703797073`*^9, 3.8105798023100104`*^9, 
   3.8105799977023077`*^9, 3.810580191417534*^9, 3.810650349757807*^9, 
   3.8106573583485126`*^9, 3.8109931757090425`*^9, 3.8112565558878984`*^9, 
   3.812909651126848*^9},
 CellLabel->"Out[39]=",ExpressionUUID->"e6d1d5a2-bc6e-4faf-8b94-2555f6391280"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sharpnessNeq", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"koffEff", "*", 
       RowBox[{"D", "[", 
        RowBox[{"konEff", ",", "c"}], "]"}]}], " ", "-", " ", 
      RowBox[{"konEff", "*", 
       RowBox[{"D", "[", 
        RowBox[{"koffEff", ",", "c"}], "]"}]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"konEff", "+", "koffEff"}], ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.810061393667221*^9, 3.8100614475950575`*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"b230c887-3891-44a3-a200-ec532f2bfdb7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", "k1", " ", "k2", " ", "k3", " ", 
       RowBox[{"(", 
        RowBox[{"k4", "+", "r1"}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["c", "2"], " ", "k2", " ", "k3", " ", "r1", " ", "r2"}],
       "+", 
      RowBox[{"k1", " ", "k3", " ", "k4", " ", "r3"}], "+", 
      RowBox[{"k1", " ", 
       RowBox[{"(", 
        RowBox[{"k4", "+", "r1"}], ")"}], " ", "r3", " ", "r4"}], "+", 
      RowBox[{"c", " ", "r1", " ", "r2", " ", "r3", " ", 
       RowBox[{"(", 
        RowBox[{"k3", "+", "r4"}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["k1", "2"], " ", "k2", " ", "k3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"k3", " ", "k4"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"k4", "+", "r1"}], ")"}], " ", "r4"}]}], ")"}]}], "+", 
      RowBox[{"k1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["c", "2"], " ", 
          SuperscriptBox["k2", "2"], " ", "k3", " ", "k4", " ", "r2"}], "+", 
         RowBox[{"k2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k3", " ", 
             RowBox[{"(", 
              RowBox[{"k4", "+", 
               RowBox[{"2", " ", "c", " ", "r2"}]}], ")"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"k4", "+", "r1"}], ")"}], " ", "r3"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k3", " ", "k4"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"k4", "+", "r1"}], ")"}], " ", "r4"}]}], ")"}]}], "+", 
         RowBox[{"r2", " ", "r3", " ", 
          RowBox[{"(", 
           RowBox[{"k3", "+", "r4"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k3", " ", "k4"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"k4", "+", "r1"}], ")"}], " ", "r4"}]}], ")"}]}]}], 
        ")"}]}], "+", 
      RowBox[{"r1", " ", "r2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "c", " ", "k2", " ", "r3", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k3", " ", "k4"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"k4", "+", "r1"}], ")"}], " ", "r4"}]}], ")"}]}], "-", 
         RowBox[{"r3", " ", 
          RowBox[{"(", 
           RowBox[{"r3", "+", "r4"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k3", " ", "k4"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"k4", "+", "r1"}], ")"}], " ", "r4"}]}], ")"}]}], "-", 
         RowBox[{
          SuperscriptBox["c", "2"], " ", "k2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k2", " ", "k3", " ", "k4"}], "+", 
            RowBox[{"r2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "k3"}], "+", "r3"}], ")"}], " ", "r4"}]}], 
           ")"}]}]}], ")"}]}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", "k2", " ", "k3", " ", 
       RowBox[{"(", 
        RowBox[{"k1", "+", "k4", "+", 
         RowBox[{"c", " ", "r2"}]}], ")"}]}], "+", 
      RowBox[{"k3", " ", 
       RowBox[{"(", 
        RowBox[{"k4", "+", 
         RowBox[{"c", " ", "r2"}]}], ")"}], " ", "r3"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"k4", "+", "r1", "+", 
         RowBox[{"c", " ", "r2"}]}], ")"}], " ", "r3", " ", "r4"}]}], ")"}], 
    " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"k1", " ", "k3", " ", "k4"}], "+", 
      RowBox[{"c", " ", "k1", " ", "k2", " ", 
       RowBox[{"(", 
        RowBox[{"k4", "+", "r1"}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["c", "2"], " ", "k2", " ", "r1", " ", "r2"}], "+", 
      RowBox[{"k1", " ", 
       RowBox[{"(", 
        RowBox[{"k4", "+", "r1"}], ")"}], " ", "r4"}], "+", 
      RowBox[{"c", " ", "r1", " ", "r2", " ", 
       RowBox[{"(", 
        RowBox[{"r3", "+", "r4"}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["c", "2"], " ", "k2", " ", 
       RowBox[{"(", 
        RowBox[{"k3", "+", "r1"}], ")"}], " ", "r2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"k1", "+", "r3"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"k3", " ", "k4"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"k4", "+", "r1"}], ")"}], " ", "r4"}]}], ")"}]}], "+", 
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"k2", " ", "k3", " ", "k4"}], "+", 
         RowBox[{"k1", " ", "k2", " ", 
          RowBox[{"(", 
           RowBox[{"k3", "+", "k4", "+", "r1"}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"k3", "+", "r1"}], ")"}], " ", "r2", " ", "r3"}], "+", 
         RowBox[{"r2", " ", 
          RowBox[{"(", 
           RowBox[{"r1", "+", "r3"}], ")"}], " ", "r4"}]}], ")"}]}]}], 
     ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.810579802515191*^9, 3.8105800257264504`*^9, 
  3.8105801996865716`*^9, 3.8106503583779974`*^9, 3.8106573664833713`*^9, 
  3.8109931778824387`*^9, 3.8112565593450084`*^9, 3.812909654245573*^9},
 CellLabel->"Out[40]=",ExpressionUUID->"5e873485-f1c3-4f35-bed1-c804ee60fe42"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1920, 1037},
WindowMargins->{{1912, Automatic}, {Automatic, -8}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 354, 5, 73, "Section",ExpressionUUID->"53bbe826-6243-4623-bfbc-1fc0a6d7cf3d"],
Cell[937, 29, 269, 4, 28, "Input",ExpressionUUID->"09a89208-e8c8-4a30-a36f-b4bd2445d91a"],
Cell[1209, 35, 1724, 41, 86, "Input",ExpressionUUID->"689ad0c0-dea0-4cad-8a2d-060acfc140d0"],
Cell[CellGroupData[{
Cell[2958, 80, 235, 4, 28, "Input",ExpressionUUID->"628a347c-779f-4fe0-b274-94b8b6d49941"],
Cell[3196, 86, 2372, 53, 96, "Output",ExpressionUUID->"144e8936-ece6-44b3-a6db-6f306f9283c8"]
}, Open  ]],
Cell[5583, 142, 174, 2, 28, "Input",ExpressionUUID->"64bb8e01-35f2-4ab7-897b-2d302dfdfe44"],
Cell[CellGroupData[{
Cell[5782, 148, 232, 4, 28, "Input",ExpressionUUID->"1c70661a-586e-4afd-bbfa-0af317b7b526"],
Cell[6017, 154, 589, 12, 32, "Output",ExpressionUUID->"b49f920f-64ce-4241-983f-759f5973c9f1"]
}, Open  ]],
Cell[6621, 169, 560, 10, 28, "Input",ExpressionUUID->"35c06f23-f104-453a-927e-9756152eb189"],
Cell[7184, 181, 549, 12, 28, "Input",ExpressionUUID->"dc484be2-c9eb-40bd-ac5d-56e1c63e48d4"],
Cell[7736, 195, 1239, 28, 28, "Input",ExpressionUUID->"e0b90688-52d0-4126-80a5-8f6b8cbefb2d"],
Cell[8978, 225, 334, 7, 28, "Input",ExpressionUUID->"2835703c-faa1-4479-ab2c-423a6b5520f9"],
Cell[CellGroupData[{
Cell[9337, 236, 171, 3, 53, "Subsection",ExpressionUUID->"5d28bd94-bc73-4346-9e3d-99d744aa0dc9"],
Cell[9511, 241, 132, 2, 28, "Input",ExpressionUUID->"e87db274-8d91-4982-b693-f0e74ac44410"],
Cell[CellGroupData[{
Cell[9668, 247, 146, 2, 28, "Input",ExpressionUUID->"47885fb7-13c8-42bd-94ee-0ebdaaf420c6"],
Cell[9817, 251, 414, 6, 109, "Output",ExpressionUUID->"d096096b-1a76-4e2d-9e8a-f85a64299f96"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10268, 262, 154, 2, 28, "Input",ExpressionUUID->"887164a1-0659-44d1-9fc9-8567081e612f"],
Cell[10425, 266, 688, 9, 166, "Output",ExpressionUUID->"aee336a7-85ea-4d8f-876e-c99c0bdf29cd"]
}, Open  ]]
}, Open  ]],
Cell[11140, 279, 341, 5, 64, "Subsection",ExpressionUUID->"1857f6e4-9744-4305-a9bc-09a799a37bf0"],
Cell[CellGroupData[{
Cell[11506, 288, 171, 3, 37, "Subsection",ExpressionUUID->"2e29538f-066a-41c3-867a-a5fe9cded690"],
Cell[11680, 293, 292, 6, 28, "Input",ExpressionUUID->"0c1b0679-5c2d-432c-afb1-0dee381d6c61"],
Cell[11975, 301, 825, 22, 28, "Input",ExpressionUUID->"d11b5662-d0ed-46b8-a00c-b0c0ad7f00af"],
Cell[12803, 325, 797, 22, 28, "Input",ExpressionUUID->"66cba8b4-c235-4fdd-8095-8dfb585a624e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13637, 352, 294, 4, 53, "Subsection",ExpressionUUID->"b579afb2-8b6f-42d8-8990-5ddfd9925c6f"],
Cell[13934, 358, 1128, 25, 28, "Input",ExpressionUUID->"c634d029-5498-4d9d-899b-49105f0ac7e6"],
Cell[15065, 385, 1181, 26, 28, "Input",ExpressionUUID->"d880dadb-2289-4195-ad4e-0686c6cc6f3e"],
Cell[16249, 413, 510, 12, 28, "Input",ExpressionUUID->"14fde9d1-3cd0-47ea-b0d4-a71385fe202f"],
Cell[16762, 427, 438, 9, 28, "Input",ExpressionUUID->"73445a63-6c17-4c6d-ac84-36bd6246e862"],
Cell[17203, 438, 334, 7, 28, "Input",ExpressionUUID->"86bc9981-aaef-4511-b7aa-4adb8e6d2a89"],
Cell[CellGroupData[{
Cell[17562, 449, 1689, 35, 28, "Input",ExpressionUUID->"838b8b91-6b4f-4235-82e5-c11b4bfaedd2"],
Cell[19254, 486, 1544, 36, 63, "Output",ExpressionUUID->"26d00e10-877b-40c2-9d82-971c8f983135"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20835, 527, 387, 6, 28, "Input",ExpressionUUID->"b6a82ad5-47b2-424a-acc7-4f0123f9696d"],
Cell[21225, 535, 1420, 34, 63, "Output",ExpressionUUID->"3003f3cc-7de2-4d21-9473-059d436420a2"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[22694, 575, 215, 3, 53, "Subsection",ExpressionUUID->"1fc4c8e4-7e11-4b6e-9d96-e86729779e30"],
Cell[22912, 580, 1129, 25, 28, "Input",ExpressionUUID->"d5ce43c1-b428-49f0-a514-59d8e766e09f"],
Cell[24044, 607, 1141, 25, 28, "Input",ExpressionUUID->"bc013709-557a-4107-bbc9-2a59fff48a4e"],
Cell[CellGroupData[{
Cell[25210, 636, 567, 12, 28, "Input",ExpressionUUID->"677ffd6b-034f-4f2b-bdd3-aff9f5118ccf"],
Cell[25780, 650, 1459, 33, 57, "Output",ExpressionUUID->"eaba5ec1-7931-459b-8345-f59599e7d6dc"]
}, Open  ]],
Cell[27254, 686, 515, 10, 28, "Input",ExpressionUUID->"3d79e30b-c186-40aa-8b8f-e9621f37b9d4"],
Cell[27772, 698, 436, 9, 28, "Input",ExpressionUUID->"aeef49ba-86a0-40f8-a85a-7d7af1e971b6"],
Cell[CellGroupData[{
Cell[28233, 711, 1632, 34, 28, "Input",ExpressionUUID->"40c3db1e-d5aa-4a52-8d96-f939059c9029"],
Cell[29868, 747, 1470, 36, 61, "Output",ExpressionUUID->"167643e8-0b86-4d60-9ee4-69e4c84db1b9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31375, 788, 339, 6, 28, "Input",ExpressionUUID->"11e52587-1ad6-4307-b1b6-c6295c05a8a3"],
Cell[31717, 796, 1414, 35, 61, "Output",ExpressionUUID->"f277522a-3896-4c3f-a8bc-6764a22f25e3"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[33180, 837, 185, 3, 53, "Subsection",ExpressionUUID->"b3a98ca1-fea4-4e08-96ae-216fab1881f5"],
Cell[CellGroupData[{
Cell[33390, 844, 356, 7, 28, "Input",ExpressionUUID->"7d7563f2-60aa-43dc-baa5-bc14bcea3144"],
Cell[33749, 853, 1720, 48, 61, "Output",ExpressionUUID->"423f520f-8a51-485f-9bd7-3d119739a888"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35506, 906, 181, 2, 28, "Input",ExpressionUUID->"706bf252-1e0f-44f1-9ffe-bb98ba34047e"],
Cell[35690, 910, 1693, 47, 61, "Output",ExpressionUUID->"aa97aed3-a3d8-45b4-acc0-feb4fb34fa1a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37420, 962, 248, 4, 28, "Input",ExpressionUUID->"2f724109-c696-4092-a28d-e37f3cf648ea"],
Cell[37671, 968, 422, 6, 32, "Output",ExpressionUUID->"ada20261-e17c-4668-bf90-24bcf757a302"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38130, 979, 366, 6, 28, "Input",ExpressionUUID->"bb8188c9-adb0-4f54-9ce5-67ea91c8a07c"],
Cell[38499, 987, 1669, 47, 63, "Output",ExpressionUUID->"60e6140f-8f12-4dbd-9f2d-13a242e2583d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40205, 1039, 751, 17, 28, "Input",ExpressionUUID->"80596dd5-81c0-4657-bce1-a0926df8118e"],
Cell[40959, 1058, 1179, 33, 59, "Output",ExpressionUUID->"e28c3687-9925-4d42-9d0e-8f917b26c0b6"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[42187, 1097, 214, 4, 53, "Subsection",ExpressionUUID->"6c7b72d3-3443-4ac7-91e9-58d76551312a"],
Cell[CellGroupData[{
Cell[42426, 1105, 510, 12, 28, "Input",ExpressionUUID->"67f7f591-5027-4e7d-98f8-c5dab45922e5"],
Cell[42939, 1119, 621, 14, 57, "Output",ExpressionUUID->"b1664b4e-b787-4251-af4d-89181b8bf4b4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43597, 1138, 510, 12, 28, "Input",ExpressionUUID->"f9bfbdb0-f6e4-4b56-bef3-d612486062c0"],
Cell[44110, 1152, 494, 11, 57, "Output",ExpressionUUID->"2083725a-99e3-420c-aad2-86ad9f6f5885"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44641, 1168, 822, 18, 28, "Input",ExpressionUUID->"0cfbe9ca-d608-441a-b55b-598703c5553e"],
Cell[45466, 1188, 1952, 51, 61, "Output",ExpressionUUID->"e6d1d5a2-bc6e-4faf-8b94-2555f6391280"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47455, 1244, 603, 15, 28, "Input",ExpressionUUID->"b230c887-3891-44a3-a200-ec532f2bfdb7"],
Cell[48061, 1261, 5460, 154, 82, "Output",ExpressionUUID->"5e873485-f1c3-4f35-bed1-c804ee60fe42"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

