(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     26608,        730]
NotebookOptionsPosition[     23032,        674]
NotebookOutlinePosition[     23375,        689]
CellTagsIndexPosition[     23332,        686]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Verifying Expressions for Expectation and Variation of Accumulated Reward \
from Markov Reward Process\
\>", "Section",
 CellChangeTimes->{{3.766585934056647*^9, 
  3.766585974405374*^9}},ExpressionUUID->"0cd71903-4765-4253-86c7-\
583733eb7283"],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.7665860727694225`*^9, 3.7665860727953434`*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"f53ddaf6-0803-4542-a92f-8240a1d82c27"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ass", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"k1", ">", "0"}], ",", 
     RowBox[{"k2", ">", "0"}], ",", 
     RowBox[{"k3", ">", "0"}], ",", 
     RowBox[{"k4", ">", "0"}], ",", 
     RowBox[{"r1", ">", "0"}], ",", 
     RowBox[{"r2", ">", "0"}], ",", 
     RowBox[{"r3", ">", "0"}], ",", 
     RowBox[{"r4", ">", "0"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7665973527897034`*^9, 3.7665973820416327`*^9}, 
   3.766601196298565*^9},
 CellLabel->"In[62]:=",ExpressionUUID->"a93bd09d-17ad-4522-901a-fa6e5c4b0f05"],

Cell[BoxData[
 RowBox[{
  RowBox[{"valVec", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"k2", "\[Rule]", "1"}], ",", 
     RowBox[{"k3", "\[Rule]", "10"}], ",", 
     RowBox[{"r1", "\[Rule]", "10"}], ",", 
     RowBox[{"r2", "\[Rule]", "1"}], ",", 
     RowBox[{"r4", "\[Rule]", "1"}], ",", 
     RowBox[{"c", "\[Rule]", "10"}], ",", 
     RowBox[{"b", "\[Rule]", "100"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.766602543336111*^9, 3.766602569305874*^9}, {
  3.7666027776049385`*^9, 3.766602802533371*^9}, {3.7668380576744623`*^9, 
  3.766838070048565*^9}, {3.766838406398007*^9, 3.7668384079379873`*^9}, {
  3.7673045698676414`*^9, 3.7673045715493307`*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"29321b1a-90f1-4c75-8f1a-7434896df5af"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Q4", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "r4"}], "-", "c"}], ",", "r1", ",", "0", ",", "b"}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c", ",", 
      RowBox[{
       RowBox[{"-", "r1"}], "-", "k2"}], ",", "r2", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "k2", ",", 
      RowBox[{
       RowBox[{"-", "r2"}], "-", "k3"}], ",", "c"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"r4", ",", "0", ",", "k3", ",", 
      RowBox[{
       RowBox[{"-", "c"}], "-", "b"}]}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.7665970485156336`*^9, 3.7665970506267967`*^9}, {
   3.76659709635977*^9, 3.7665972549757605`*^9}, 3.766597670769878*^9, {
   3.76659877422307*^9, 3.766598798872613*^9}, 3.7668379732594795`*^9, {
   3.7668380192182255`*^9, 3.7668380333733864`*^9}, 3.7673043615049086`*^9, {
   3.767304474930873*^9, 3.7673044962673674`*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"9c208344-b914-4a91-af3b-57aa27d1e452"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "c"}], "-", "r4"}], ",", "r1", ",", "0", ",", "b"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{
      RowBox[{"-", "k2"}], "-", "r1"}], ",", "r2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "k2", ",", 
     RowBox[{
      RowBox[{"-", "k3"}], "-", "r2"}], ",", "c"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"r4", ",", "0", ",", "k3", ",", 
     RowBox[{
      RowBox[{"-", "b"}], "-", "c"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.767304362024638*^9, 3.767304501669815*^9, 
  3.7673045450346375`*^9, 3.7673045776905155`*^9},
 CellLabel->"Out[64]=",ExpressionUUID->"091066bb-a139-4b8b-a141-59b7560d50fa"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Refine", "[", 
   RowBox[{
    RowBox[{"Eigenvalues", "[", "Q4", "]"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", " ", "ass"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7665978637781224`*^9, 3.766597906076456*^9}, 
   3.7665980593033695`*^9},
 CellLabel->"In[65]:=",ExpressionUUID->"59cb4cf4-27f2-4409-937f-21b6551d42d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eigVectors", " ", "=", " ", 
   RowBox[{"Eigenvectors", "[", "Q4", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7665979196138344`*^9, 3.7665979301282406`*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"5d25927e-1ef7-47f6-a1dc-8569ff8b995e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ssRaw", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"eigVectors", "[", 
      RowBox[{"[", "1", "]"}], "]"}], " ", "/", " ", 
     RowBox[{"Total", "[", 
      RowBox[{"eigVectors", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.766597934072912*^9, 3.7665979843979015`*^9}, {
  3.766598018209607*^9, 3.7665980277008443`*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"1b51bc59-d5a1-412b-9f72-d20ee10c2b54"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7665980880250993`*^9, 3.7665981617711353`*^9}, {
   3.766599697241766*^9, 3.766599698650004*^9}, 3.766601218251429*^9},
 CellLabel->"In[68]:=",ExpressionUUID->"4fe61074-1312-425c-ae10-f001d7295dbd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"r", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.766599276299369*^9, 3.76659928364874*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"fd7c28c3-652c-4b27-b207-09b80f324c5f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"g4", " ", "=", " ", 
   RowBox[{"r", ".", "ssRaw"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.766599915617947*^9, 3.7665999286536217`*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"dd6edc2a-abb3-4355-b2b7-a9b600e99bc1"],

Cell[CellGroupData[{

Cell["Define system of equations to find w\[CloseCurlyQuote]s", \
"Subsubsection",
 CellChangeTimes->{{3.7665992529379115`*^9, 
  3.7665992651413913`*^9}},ExpressionUUID->"4bbb22a6-f9b4-4c69-8d47-\
32491673556f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"wVecRaw", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"w1", ",", "w2", ",", "w3", ",", "w4"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.766599966577458*^9, 3.766599970158909*^9}, {
  3.766601280481094*^9, 3.7666012816579475`*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"ca8e9be0-0b84-4e9d-9416-0b70501605ff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eq1", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"Q4", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", 
      RowBox[{"(", 
       RowBox[{"w2", "-", "w1"}], ")"}]}], "  ", "+", " ", 
     RowBox[{
      RowBox[{"Q4", "[", 
       RowBox[{"[", 
        RowBox[{"4", ",", "1"}], "]"}], "]"}], "*", 
      RowBox[{"(", 
       RowBox[{"w4", "-", "w1"}], ")"}]}]}], " ", "\[Equal]", " ", "g4"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.766599268941347*^9, 3.7665994312433834`*^9}, {
  3.7665995074780436`*^9, 3.766599508997341*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"627ec138-4cf3-45df-95dd-9dca55ad5796"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eq2", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{"[", "2", "]"}], "]"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"Q4", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], "*", 
      RowBox[{"(", 
       RowBox[{"w1", "-", "w2"}], ")"}]}], "  ", "+", " ", 
     RowBox[{
      RowBox[{"Q4", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "2"}], "]"}], "]"}], "*", 
      RowBox[{"(", 
       RowBox[{"w3", "-", "w2"}], ")"}]}]}], " ", "\[Equal]", " ", "g4"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.766599393798574*^9, 3.766599393874333*^9}, {
  3.7665995132929764`*^9, 3.7665995436005173`*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"f498e0d9-a95c-4e8d-bc15-854e2613ed30"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eq3", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{"[", "3", "]"}], "]"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"Q4", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "3"}], "]"}], "]"}], "*", 
      RowBox[{"(", 
       RowBox[{"w2", "-", "w3"}], ")"}]}], "  ", "+", " ", 
     RowBox[{
      RowBox[{"Q4", "[", 
       RowBox[{"[", 
        RowBox[{"4", ",", "3"}], "]"}], "]"}], "*", 
      RowBox[{"(", 
       RowBox[{"w4", "-", "w3"}], ")"}]}]}], " ", "\[Equal]", " ", "g4"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.766599550238562*^9, 3.7665995774927416`*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"bf44010f-bcbe-4e20-b538-313668dbb678"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eq4", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{"[", "4", "]"}], "]"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"Q4", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "4"}], "]"}], "]"}], "*", 
      RowBox[{"(", 
       RowBox[{"w1", "-", "w4"}], ")"}]}], "  ", "+", " ", 
     RowBox[{
      RowBox[{"Q4", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "4"}], "]"}], "]"}], "*", 
      RowBox[{"(", 
       RowBox[{"w3", "-", "w4"}], ")"}]}]}], " ", "\[Equal]", " ", "g4"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.766599585241108*^9, 3.7665996301698136`*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"fa518dc3-7d43-4e49-af75-3f71a5204214"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eq5", "=", " ", 
   RowBox[{
    RowBox[{"ssRaw", ".", "wVecRaw"}], "\[Equal]", "0"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.766599455613988*^9, 3.7665995036213503`*^9}, {
   3.7665996646438036`*^9, 3.7665997433036566`*^9}, {3.7665998437946806`*^9, 
   3.766599872805852*^9}, 3.766599962605076*^9, {3.7666012519164586`*^9, 
   3.7666012534184294`*^9}, {3.7666012855535345`*^9, 3.7666012857769704`*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"e379dcb2-a5ad-40f2-9be5-267b2ed7185a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"solw", " ", "=", " ", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eq1", ",", "eq2", ",", "eq3", ",", "eq4", ",", "eq5"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"w1", ",", "w2", ",", "w3", ",", "w4"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.766599877817956*^9, 3.7665999526670647`*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"2c6f4674-9887-4b04-8adc-f8feb90a44c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"wVec", " ", "=", " ", 
   RowBox[{"ArrayReshape", "[", 
    RowBox[{
     RowBox[{"wVecRaw", " ", "/.", "solw"}], ",", "4"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7665999770300136`*^9, 3.766600042517169*^9}, {
  3.7666012650912247`*^9, 3.766601290929227*^9}, {3.7666018532581973`*^9, 
  3.7666018668055086`*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"77bcbbd5-e42c-4088-8b3e-43edf1ecbb7a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"s1", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Q4", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"wVec", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "^", "2"}], "-", 
       RowBox[{
        RowBox[{"wVec", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "^", "2"}]}], ")"}]}], " ", "+", " ", 
    RowBox[{
     RowBox[{"Q4", "[", 
      RowBox[{"[", 
       RowBox[{"4", ",", "1"}], "]"}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"wVec", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "^", "2"}], "-", 
       RowBox[{
        RowBox[{"wVec", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "^", "2"}]}], ")"}]}], " ", "+", " ", 
    RowBox[{"2", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "-", "g4"}], ")"}], "*", 
     RowBox[{"wVec", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7666000339891157`*^9, 3.7666000526993103`*^9}, {
   3.766600168811973*^9, 3.766600259767084*^9}, {3.7666002976929703`*^9, 
   3.7666003037956977`*^9}, 3.766600361377178*^9, {3.7666014091896005`*^9, 
   3.7666014132432065`*^9}, 3.7666016212978563`*^9, {3.766601662830435*^9, 
   3.7666016900218353`*^9}, 3.7666019135371017`*^9},
 CellLabel->"In[79]:=",ExpressionUUID->"0e464976-b146-49e2-9878-98e36c496bc6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"s2", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Q4", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"wVec", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "-", 
       RowBox[{
        RowBox[{"wVec", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], ")"}]}], " ", "+", " ", 
    RowBox[{
     RowBox[{"Q4", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "2"}], "]"}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"wVec", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "^", "2"}], "-", 
       RowBox[{
        RowBox[{"wVec", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], ")"}]}], " ", "+", " ", 
    RowBox[{"2", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "-", "g4"}], ")"}], "*", 
     RowBox[{"wVec", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.766600268862155*^9, 3.766600285848935*^9}, {
  3.766600369384775*^9, 3.7666004064354115`*^9}, {3.766600481166391*^9, 
  3.766600481247178*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"2f9a8cef-843c-4fe2-80b9-e97521d837ce"],

Cell[BoxData[
 RowBox[{
  RowBox[{"s3", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Q4", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "3"}], "]"}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"wVec", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "^", "2"}], "-", 
       RowBox[{
        RowBox[{"wVec", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "^", "2"}]}], ")"}]}], " ", "+", " ", 
    RowBox[{
     RowBox[{"Q4", "[", 
      RowBox[{"[", 
       RowBox[{"4", ",", "3"}], "]"}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"wVec", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "^", "2"}], "-", 
       RowBox[{
        RowBox[{"wVec", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "^", "2"}]}], ")"}]}], " ", "+", " ", 
    RowBox[{"2", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "-", "g4"}], ")"}], "*", 
     RowBox[{"wVec", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.766600411947711*^9, 3.766600443721468*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"53666c8c-fb46-484e-be23-8c50d746d1dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"s4", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Q4", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "4"}], "]"}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"wVec", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "-", 
       RowBox[{
        RowBox[{"wVec", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "^", "2"}]}], ")"}]}], " ", "+", " ", 
    RowBox[{
     RowBox[{"Q4", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "4"}], "]"}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"wVec", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "^", "2"}], "-", 
       RowBox[{
        RowBox[{"wVec", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "^", "2"}]}], ")"}]}], " ", "+", " ", 
    RowBox[{"2", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "-", "g4"}], ")"}], "*", 
     RowBox[{"wVec", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.766600450461507*^9, 3.766600489942967*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"60cd2514-dee5-4179-81f7-ea78671bdfc2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sVec", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"s1", ",", "s2", ",", "s3", ",", "s4"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.766600510118795*^9, 3.7666005178272886`*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"a40d4302-426d-4e33-8ed0-93733df7984d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gammaVar", " ", "=", " ", 
   RowBox[{"ssRaw", ".", "sVec"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7666005280261364`*^9, 3.766600553151595*^9}, 
   3.7666006873720584`*^9, {3.766601049972251*^9, 3.7666010513904476`*^9}, {
   3.7668378943493185`*^9, 3.766837894586684*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"1fd77435-91b8-408c-b024-5186bd73b771"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gammaVarLow", " ", "=", " ", 
   RowBox[{"gammaVar", " ", "/.", " ", 
    RowBox[{"c", "\[Rule]", "1"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.766838357187209*^9, 3.766838375300937*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"bb75a9c7-5275-4134-956a-1a7184aea070"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ssRawLow", " ", "=", " ", 
   RowBox[{"ssRaw", " ", "/.", " ", 
    RowBox[{"c", "\[Rule]", "1"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7668381377039037`*^9, 3.7668381578256397`*^9}, {
  3.766838300025345*^9, 3.7668383044813643`*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"8e8c3fd7-8c89-4308-81b5-fecdcf60758e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"logLRate", "[", 
   RowBox[{"_", ",", "b_"}], "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{".5", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ssRawLow", ".", "r"}], " ", "-", " ", 
         RowBox[{"ssRaw", ".", "r"}]}], ")"}], "/", "gammaVarLow"}], ")"}], 
     "^", "2"}]}], " ", "/.", " ", "valVec"}]}]], "Input",
 CellChangeTimes->{{3.7668378580260878`*^9, 3.766837861390381*^9}, {
  3.7668380926940603`*^9, 3.7668380970704207`*^9}, {3.7668381615626493`*^9, 
  3.766838215855661*^9}, {3.766838286126874*^9, 3.766838286884881*^9}, {
  3.7668383205235963`*^9, 3.7668383482292414`*^9}, {3.7668383784644823`*^9, 
  3.7668384119672804`*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"6c138430-fe9e-4567-b36f-1138ac7bb426"],

Cell[BoxData["362.29974465831356`"], "Output",
 CellChangeTimes->{3.7673043080475583`*^9, 3.767304546422282*^9, 
  3.767304578312703*^9},
 CellLabel->"Out[87]=",ExpressionUUID->"e7d45123-7de5-4366-a6c1-a452cb89052f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"gammaVar", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.767304598444868*^9, 3.7673046200835867`*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"3f7070b9-5476-47a3-a363-9878b0af2ef3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"c", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "+", "c"}], ")"}], " ", "k2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"k2", "+", "r1"}], ")"}], " ", "r4"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["c", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["k2", "2"], " ", "k3"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"c", "+", "r1"}], ")"}], "2"], " ", "r2"}]}], ")"}]}], 
      "+", 
      RowBox[{
       SuperscriptBox["b", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"k3", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"c", "+", "k2", "+", "r1"}], ")"}], "2"]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"c", "+", "r1"}], ")"}], "2"], " ", "r2"}]}], ")"}]}], 
      "+", 
      RowBox[{"2", " ", "c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"k2", " ", "k3", " ", 
          RowBox[{"(", 
           RowBox[{"k2", "+", "r1"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"c", "+", "r1"}], ")"}], "2"], " ", "r2"}]}], ")"}], " ", 
       "r4"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"k3", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"k2", "+", "r1"}], ")"}], "2"]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"c", "+", "r1"}], ")"}], "2"], " ", "r2"}]}], ")"}], " ", 
       SuperscriptBox["r4", "2"]}], "+", 
      RowBox[{"2", " ", "b", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "k2", " ", "k3", " ", 
          RowBox[{"(", 
           RowBox[{"c", "+", "k2", "+", "r1"}], ")"}]}], "+", 
         RowBox[{"c", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"c", "+", "r1"}], ")"}], "2"], " ", "r2"}], "+", 
         RowBox[{"k3", " ", 
          RowBox[{"(", 
           RowBox[{"k2", "+", "r1"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"c", "+", "k2", "+", "r1"}], ")"}], " ", "r4"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"c", "+", "r1"}], ")"}], "2"], " ", "r2", " ", "r4"}]}], 
        ")"}]}]}], ")"}]}], ")"}], "/", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"c", " ", "k2", " ", 
      RowBox[{"(", 
       RowBox[{"c", "+", "k3"}], ")"}]}], "+", 
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{"c", "+", "r1"}], ")"}], " ", "r2"}], "+", 
     RowBox[{"b", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"k3", " ", 
         RowBox[{"(", 
          RowBox[{"k2", "+", "r1"}], ")"}]}], "+", 
        RowBox[{"r1", " ", "r2"}], "+", 
        RowBox[{"c", " ", 
         RowBox[{"(", 
          RowBox[{"k2", "+", "k3", "+", "r2"}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"c", "+", "k3"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"k2", "+", "r1"}], ")"}], " ", "r4"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"c", "+", "r1"}], ")"}], " ", "r2", " ", "r4"}]}], ")"}], 
   "3"]}]], "Output",
 CellChangeTimes->{{3.767304602349674*^9, 3.7673046222690077`*^9}},
 CellLabel->"Out[90]=",ExpressionUUID->"7aca96a3-62c1-47be-b272-dcd99d215643"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7665997466497107`*^9, 3.76659977198212*^9}, 
   3.7665998410360575`*^9},
 CellLabel->"In[88]:=",ExpressionUUID->"2a39eaeb-83bb-4e82-8b50-0f74543f6bbb"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1280, 677},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 255, 6, 105, "Section",ExpressionUUID->"0cd71903-4765-4253-86c7-583733eb7283"],
Cell[838, 30, 222, 3, 28, "Input",ExpressionUUID->"f53ddaf6-0803-4542-a92f-8240a1d82c27"],
Cell[1063, 35, 579, 15, 28, "Input",ExpressionUUID->"a93bd09d-17ad-4522-901a-fa6e5c4b0f05"],
Cell[1645, 52, 763, 16, 28, "Input",ExpressionUUID->"29321b1a-90f1-4c75-8f1a-7434896df5af"],
Cell[CellGroupData[{
Cell[2433, 72, 1052, 26, 28, "Input",ExpressionUUID->"9c208344-b914-4a91-af3b-57aa27d1e452"],
Cell[3488, 100, 769, 22, 32, "Output",ExpressionUUID->"091066bb-a139-4b8b-a141-59b7560d50fa"]
}, Open  ]],
Cell[4272, 125, 365, 8, 28, "Input",ExpressionUUID->"59cb4cf4-27f2-4409-937f-21b6551d42d3"],
Cell[4640, 135, 276, 5, 28, "Input",ExpressionUUID->"5d25927e-1ef7-47f6-a1dc-8569ff8b995e"],
Cell[4919, 142, 525, 12, 28, "Input",ExpressionUUID->"1b51bc59-d5a1-412b-9f72-d20ee10c2b54"],
Cell[5447, 156, 247, 3, 28, "Input",ExpressionUUID->"4fe61074-1312-425c-ae10-f001d7295dbd"],
Cell[5697, 161, 290, 6, 28, "Input",ExpressionUUID->"fd7c28c3-652c-4b27-b207-09b80f324c5f"],
Cell[5990, 169, 253, 5, 28, "Input",ExpressionUUID->"dd6edc2a-abb3-4355-b2b7-a9b600e99bc1"],
Cell[CellGroupData[{
Cell[6268, 178, 212, 4, 44, "Subsubsection",ExpressionUUID->"4bbb22a6-f9b4-4c69-8d47-32491673556f"],
Cell[6483, 184, 352, 7, 28, "Input",ExpressionUUID->"ca8e9be0-0b84-4e9d-9416-0b70501605ff"],
Cell[6838, 193, 782, 22, 28, "Input",ExpressionUUID->"627ec138-4cf3-45df-95dd-9dca55ad5796"],
Cell[7623, 217, 782, 22, 28, "Input",ExpressionUUID->"f498e0d9-a95c-4e8d-bc15-854e2613ed30"],
Cell[8408, 241, 731, 21, 28, "Input",ExpressionUUID->"bf44010f-bcbe-4e20-b538-313668dbb678"],
Cell[9142, 264, 731, 21, 28, "Input",ExpressionUUID->"fa518dc3-7d43-4e49-af75-3f71a5204214"],
Cell[9876, 287, 519, 9, 28, "Input",ExpressionUUID->"e379dcb2-a5ad-40f2-9be5-267b2ed7185a"],
Cell[10398, 298, 464, 12, 28, "Input",ExpressionUUID->"2c6f4674-9887-4b04-8adc-f8feb90a44c3"],
Cell[10865, 312, 440, 10, 28, "Input",ExpressionUUID->"77bcbbd5-e42c-4088-8b3e-43edf1ecbb7a"],
Cell[11308, 324, 1483, 40, 28, "Input",ExpressionUUID->"0e464976-b146-49e2-9878-98e36c496bc6"],
Cell[12794, 366, 1299, 38, 28, "Input",ExpressionUUID->"2f9a8cef-843c-4fe2-80b9-e97521d837ce"],
Cell[14096, 406, 1199, 36, 28, "Input",ExpressionUUID->"53666c8c-fb46-484e-be23-8c50d746d1dc"],
Cell[15298, 444, 1199, 36, 28, "Input",ExpressionUUID->"60cd2514-dee5-4179-81f7-ea78671bdfc2"],
Cell[16500, 482, 300, 6, 28, "Input",ExpressionUUID->"a40d4302-426d-4e33-8ed0-93733df7984d"],
Cell[16803, 490, 390, 7, 28, "Input",ExpressionUUID->"1fd77435-91b8-408c-b024-5186bd73b771"],
Cell[17196, 499, 305, 6, 28, "Input",ExpressionUUID->"bb75a9c7-5275-4134-956a-1a7184aea070"],
Cell[17504, 507, 354, 7, 28, "Input",ExpressionUUID->"8e8c3fd7-8c89-4308-81b5-fecdcf60758e"],
Cell[CellGroupData[{
Cell[17883, 518, 818, 19, 28, "Input",ExpressionUUID->"6c138430-fe9e-4567-b36f-1138ac7bb426"],
Cell[18704, 539, 216, 3, 32, "Output",ExpressionUUID->"e7d45123-7de5-4366-a6c1-a452cb89052f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18957, 547, 271, 5, 28, "Input",ExpressionUUID->"3f7070b9-5476-47a3-a363-9878b0af2ef3"],
Cell[19231, 554, 3558, 110, 112, "Output",ExpressionUUID->"7aca96a3-62c1-47be-b272-dcd99d215643"]
}, Open  ]],
Cell[22804, 667, 200, 3, 28, "Input",ExpressionUUID->"2a39eaeb-83bb-4e82-8b50-0f74543f6bbb"]
}, Open  ]]
}, Open  ]]
}
]
*)

