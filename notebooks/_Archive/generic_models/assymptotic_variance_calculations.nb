(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     24885,        686]
NotebookOptionsPosition[     21012,        627]
NotebookOutlinePosition[     21353,        642]
CellTagsIndexPosition[     21310,        639]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Verifying Expressions for Expectation and Variation of Accumulated Reward \
from Markov Reward Process\
\>", "Section",
 CellChangeTimes->{{3.766585934056647*^9, 
  3.766585974405374*^9}},ExpressionUUID->"0cd71903-4765-4253-86c7-\
583733eb7283"],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.7665860727694225`*^9, 3.7665860727953434`*^9}},
 CellLabel->
  "In[1063]:=",ExpressionUUID->"f53ddaf6-0803-4542-a92f-8240a1d82c27"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ass", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"k1", ">", "0"}], ",", 
     RowBox[{"k2", ">", "0"}], ",", 
     RowBox[{"k3", ">", "0"}], ",", 
     RowBox[{"k4", ">", "0"}], ",", 
     RowBox[{"r1", ">", "0"}], ",", 
     RowBox[{"r2", ">", "0"}], ",", 
     RowBox[{"r3", ">", "0"}], ",", 
     RowBox[{"r4", ">", "0"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7665973527897034`*^9, 3.7665973820416327`*^9}, 
   3.766601196298565*^9},
 CellLabel->
  "In[1064]:=",ExpressionUUID->"a93bd09d-17ad-4522-901a-fa6e5c4b0f05"],

Cell[BoxData[
 RowBox[{
  RowBox[{"valVec", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"k1", "\[Rule]", "1"}], ",", 
     RowBox[{"k2", "\[Rule]", "1"}], ",", 
     RowBox[{"k3", "\[Rule]", "10"}], ",", 
     RowBox[{"k4", "\[Rule]", "100"}], ",", 
     RowBox[{"r1", "\[Rule]", "10"}], ",", 
     RowBox[{"r2", "\[Rule]", "1"}], ",", 
     RowBox[{"r3", "\[Rule]", "1"}], ",", 
     RowBox[{"r4", "\[Rule]", "1"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.766602543336111*^9, 3.766602569305874*^9}, {
  3.7666027776049385`*^9, 3.766602802533371*^9}},
 CellLabel->
  "In[1065]:=",ExpressionUUID->"29321b1a-90f1-4c75-8f1a-7434896df5af"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Q4", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "r4"}], "-", "k1"}], ",", "r1", ",", "0", ",", "k4"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k1", ",", 
       RowBox[{
        RowBox[{"-", "r1"}], "-", "k2"}], ",", "r2", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "k2", ",", 
       RowBox[{
        RowBox[{"-", "r2"}], "-", "k3"}], ",", "r3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"r4", ",", "0", ",", "k3", ",", 
       RowBox[{
        RowBox[{"-", "r3"}], "-", "k4"}]}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7665970485156336`*^9, 3.7665970506267967`*^9}, {
   3.76659709635977*^9, 3.7665972549757605`*^9}, 3.766597670769878*^9, {
   3.76659877422307*^9, 3.766598798872613*^9}},
 CellLabel->
  "In[1066]:=",ExpressionUUID->"9c208344-b914-4a91-af3b-57aa27d1e452"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Refine", "[", 
   RowBox[{
    RowBox[{"Eigenvalues", "[", "Q4", "]"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", " ", "ass"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7665978637781224`*^9, 3.766597906076456*^9}, 
   3.7665980593033695`*^9},
 CellLabel->
  "In[1067]:=",ExpressionUUID->"59cb4cf4-27f2-4409-937f-21b6551d42d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eigVectors", " ", "=", " ", 
   RowBox[{"Eigenvectors", "[", "Q4", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7665979196138344`*^9, 3.7665979301282406`*^9}},
 CellLabel->
  "In[1068]:=",ExpressionUUID->"5d25927e-1ef7-47f6-a1dc-8569ff8b995e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ssRaw", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"eigVectors", "[", 
      RowBox[{"[", "1", "]"}], "]"}], " ", "/", " ", 
     RowBox[{"Total", "[", 
      RowBox[{"eigVectors", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.766597934072912*^9, 3.7665979843979015`*^9}, {
  3.766598018209607*^9, 3.7665980277008443`*^9}},
 CellLabel->
  "In[1069]:=",ExpressionUUID->"1b51bc59-d5a1-412b-9f72-d20ee10c2b54"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7665980880250993`*^9, 3.7665981617711353`*^9}, {
   3.766599697241766*^9, 3.766599698650004*^9}, 3.766601218251429*^9},
 CellLabel->
  "In[1070]:=",ExpressionUUID->"4fe61074-1312-425c-ae10-f001d7295dbd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"r", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.766599276299369*^9, 3.76659928364874*^9}},
 CellLabel->
  "In[1071]:=",ExpressionUUID->"fd7c28c3-652c-4b27-b207-09b80f324c5f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"g4", " ", "=", " ", 
   RowBox[{"r", ".", "ssRaw"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.766599915617947*^9, 3.7665999286536217`*^9}},
 CellLabel->
  "In[1072]:=",ExpressionUUID->"dd6edc2a-abb3-4355-b2b7-a9b600e99bc1"],

Cell[CellGroupData[{

Cell["Define system of equations to find w\[CloseCurlyQuote]s", \
"Subsubsection",
 CellChangeTimes->{{3.7665992529379115`*^9, 
  3.7665992651413913`*^9}},ExpressionUUID->"4bbb22a6-f9b4-4c69-8d47-\
32491673556f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"wVecRaw", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"w1", ",", "w2", ",", "w3", ",", "w4"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.766599966577458*^9, 3.766599970158909*^9}, {
  3.766601280481094*^9, 3.7666012816579475`*^9}},
 CellLabel->
  "In[1073]:=",ExpressionUUID->"ca8e9be0-0b84-4e9d-9416-0b70501605ff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eq1", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"Q4", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", 
      RowBox[{"(", 
       RowBox[{"w2", "-", "w1"}], ")"}]}], "  ", "+", " ", 
     RowBox[{
      RowBox[{"Q4", "[", 
       RowBox[{"[", 
        RowBox[{"4", ",", "1"}], "]"}], "]"}], "*", 
      RowBox[{"(", 
       RowBox[{"w4", "-", "w1"}], ")"}]}]}], " ", "\[Equal]", " ", "g4"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.766599268941347*^9, 3.7665994312433834`*^9}, {
  3.7665995074780436`*^9, 3.766599508997341*^9}},
 CellLabel->
  "In[1074]:=",ExpressionUUID->"627ec138-4cf3-45df-95dd-9dca55ad5796"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eq2", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{"[", "2", "]"}], "]"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"Q4", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], "*", 
      RowBox[{"(", 
       RowBox[{"w1", "-", "w2"}], ")"}]}], "  ", "+", " ", 
     RowBox[{
      RowBox[{"Q4", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "2"}], "]"}], "]"}], "*", 
      RowBox[{"(", 
       RowBox[{"w3", "-", "w2"}], ")"}]}]}], " ", "\[Equal]", " ", "g4"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.766599393798574*^9, 3.766599393874333*^9}, {
  3.7665995132929764`*^9, 3.7665995436005173`*^9}},
 CellLabel->
  "In[1075]:=",ExpressionUUID->"f498e0d9-a95c-4e8d-bc15-854e2613ed30"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eq3", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{"[", "3", "]"}], "]"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"Q4", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "3"}], "]"}], "]"}], "*", 
      RowBox[{"(", 
       RowBox[{"w2", "-", "w3"}], ")"}]}], "  ", "+", " ", 
     RowBox[{
      RowBox[{"Q4", "[", 
       RowBox[{"[", 
        RowBox[{"4", ",", "3"}], "]"}], "]"}], "*", 
      RowBox[{"(", 
       RowBox[{"w4", "-", "w3"}], ")"}]}]}], " ", "\[Equal]", " ", "g4"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.766599550238562*^9, 3.7665995774927416`*^9}},
 CellLabel->
  "In[1076]:=",ExpressionUUID->"bf44010f-bcbe-4e20-b538-313668dbb678"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eq4", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{"[", "4", "]"}], "]"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"Q4", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "4"}], "]"}], "]"}], "*", 
      RowBox[{"(", 
       RowBox[{"w1", "-", "w4"}], ")"}]}], "  ", "+", " ", 
     RowBox[{
      RowBox[{"Q4", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "4"}], "]"}], "]"}], "*", 
      RowBox[{"(", 
       RowBox[{"w3", "-", "w4"}], ")"}]}]}], " ", "\[Equal]", " ", "g4"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.766599585241108*^9, 3.7665996301698136`*^9}},
 CellLabel->
  "In[1077]:=",ExpressionUUID->"fa518dc3-7d43-4e49-af75-3f71a5204214"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eq5", "=", " ", 
   RowBox[{
    RowBox[{"ssRaw", ".", "wVecRaw"}], "\[Equal]", "0"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.766599455613988*^9, 3.7665995036213503`*^9}, {
   3.7665996646438036`*^9, 3.7665997433036566`*^9}, {3.7665998437946806`*^9, 
   3.766599872805852*^9}, 3.766599962605076*^9, {3.7666012519164586`*^9, 
   3.7666012534184294`*^9}, {3.7666012855535345`*^9, 3.7666012857769704`*^9}},
 CellLabel->
  "In[1078]:=",ExpressionUUID->"e379dcb2-a5ad-40f2-9be5-267b2ed7185a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"solw", " ", "=", " ", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eq1", ",", "eq2", ",", "eq3", ",", "eq4", ",", "eq5"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"w1", ",", "w2", ",", "w3", ",", "w4"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.766599877817956*^9, 3.7665999526670647`*^9}},
 CellLabel->
  "In[1079]:=",ExpressionUUID->"2c6f4674-9887-4b04-8adc-f8feb90a44c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"wVec", " ", "=", " ", 
   RowBox[{"ArrayReshape", "[", 
    RowBox[{
     RowBox[{"wVecRaw", " ", "/.", "solw"}], ",", "4"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7665999770300136`*^9, 3.766600042517169*^9}, {
  3.7666012650912247`*^9, 3.766601290929227*^9}, {3.7666018532581973`*^9, 
  3.7666018668055086`*^9}},
 CellLabel->
  "In[1080]:=",ExpressionUUID->"77bcbbd5-e42c-4088-8b3e-43edf1ecbb7a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"wN", " ", "=", " ", 
   RowBox[{"N", "[", 
    RowBox[{"wVec", " ", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"k1", "\[Rule]", "1"}], ",", 
       RowBox[{"k2", "\[Rule]", "1"}], ",", 
       RowBox[{"k3", "\[Rule]", "1"}], ",", 
       RowBox[{"k4", "\[Rule]", "1"}], ",", 
       RowBox[{"r1", "\[Rule]", "1"}], ",", 
       RowBox[{"r2", "\[Rule]", "1"}], ",", 
       RowBox[{"r3", "\[Rule]", "1"}], ",", 
       RowBox[{"r4", "\[Rule]", "1"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7666013480710764`*^9, 3.766601369813942*^9}, 
   3.766601401897358*^9, {3.766601557157755*^9, 3.766601592580266*^9}},
 CellLabel->
  "In[1081]:=",ExpressionUUID->"690ddcee-ea56-4d0e-a016-e2a2fdf994f8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"QN", " ", "=", " ", 
   RowBox[{"N", "[", 
    RowBox[{"Q4", " ", "/.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"k1", "\[Rule]", "1"}], ",", 
       RowBox[{"k2", "\[Rule]", "1"}], ",", 
       RowBox[{"k3", "\[Rule]", "1"}], ",", 
       RowBox[{"k4", "\[Rule]", "1"}], ",", 
       RowBox[{"r1", "\[Rule]", "1"}], ",", 
       RowBox[{"r2", "\[Rule]", "1"}], ",", 
       RowBox[{"r3", "\[Rule]", "1"}], ",", 
       RowBox[{"r4", "\[Rule]", "1"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7666013918362455`*^9, 3.766601402754099*^9}, {
  3.766601594997807*^9, 3.7666016150376425`*^9}},
 CellLabel->
  "In[1082]:=",ExpressionUUID->"ca135eab-329f-4610-a2aa-4a865fcc44d2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ng4", " ", "=", " ", 
   RowBox[{"N", "[", 
    RowBox[{"g4", " ", "/.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"k1", "\[Rule]", "1"}], ",", 
       RowBox[{"k2", "\[Rule]", "1"}], ",", 
       RowBox[{"k3", "\[Rule]", "1"}], ",", 
       RowBox[{"k4", "\[Rule]", "1"}], ",", 
       RowBox[{"r1", "\[Rule]", "1"}], ",", 
       RowBox[{"r2", "\[Rule]", "1"}], ",", 
       RowBox[{"r3", "\[Rule]", "1"}], ",", 
       RowBox[{"r4", "\[Rule]", "1"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7666000059619894`*^9, 3.7666000253740435`*^9}, {
  3.766601626005273*^9, 3.7666016485288496`*^9}},
 CellLabel->
  "In[1083]:=",ExpressionUUID->"cc912d2f-6d6a-4bcd-ab2c-220081908be5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "wVec", "]"}]], "Input",
 CellChangeTimes->{{3.766601777915556*^9, 3.7666017812117434`*^9}, {
  3.7666018120035176`*^9, 3.766601817505119*^9}},
 CellLabel->
  "In[1084]:=",ExpressionUUID->"e2ec7bff-132f-4825-855e-08099fc55687"],

Cell[BoxData[
 RowBox[{"{", "4", "}"}]], "Output",
 CellChangeTimes->{
  3.76660190687893*^9, {3.7666025583990326`*^9, 3.7666025751642556`*^9}, 
   3.7666028085549526`*^9},
 CellLabel->
  "Out[1084]=",ExpressionUUID->"bbf2ceb9-88a3-4d18-8ddd-bd8b581b1128"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"s1", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Q4", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"wVec", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "^", "2"}], "-", 
       RowBox[{
        RowBox[{"wVec", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "^", "2"}]}], ")"}]}], " ", "+", " ", 
    RowBox[{
     RowBox[{"Q4", "[", 
      RowBox[{"[", 
       RowBox[{"4", ",", "1"}], "]"}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"wVec", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "^", "2"}], "-", 
       RowBox[{
        RowBox[{"wVec", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "^", "2"}]}], ")"}]}], " ", "+", " ", 
    RowBox[{"2", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "-", "g4"}], ")"}], "*", 
     RowBox[{"wVec", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7666000339891157`*^9, 3.7666000526993103`*^9}, {
   3.766600168811973*^9, 3.766600259767084*^9}, {3.7666002976929703`*^9, 
   3.7666003037956977`*^9}, 3.766600361377178*^9, {3.7666014091896005`*^9, 
   3.7666014132432065`*^9}, 3.7666016212978563`*^9, {3.766601662830435*^9, 
   3.7666016900218353`*^9}, 3.7666019135371017`*^9},
 CellLabel->
  "In[1085]:=",ExpressionUUID->"0e464976-b146-49e2-9878-98e36c496bc6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"s2", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Q4", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"wVec", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "-", 
       RowBox[{
        RowBox[{"wVec", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], ")"}]}], " ", "+", " ", 
    RowBox[{
     RowBox[{"Q4", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "2"}], "]"}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"wVec", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "^", "2"}], "-", 
       RowBox[{
        RowBox[{"wVec", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], ")"}]}], " ", "+", " ", 
    RowBox[{"2", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "-", "g4"}], ")"}], "*", 
     RowBox[{"wVec", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.766600268862155*^9, 3.766600285848935*^9}, {
  3.766600369384775*^9, 3.7666004064354115`*^9}, {3.766600481166391*^9, 
  3.766600481247178*^9}},
 CellLabel->
  "In[1086]:=",ExpressionUUID->"2f9a8cef-843c-4fe2-80b9-e97521d837ce"],

Cell[BoxData[
 RowBox[{
  RowBox[{"s3", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Q4", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "3"}], "]"}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"wVec", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "^", "2"}], "-", 
       RowBox[{
        RowBox[{"wVec", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "^", "2"}]}], ")"}]}], " ", "+", " ", 
    RowBox[{
     RowBox[{"Q4", "[", 
      RowBox[{"[", 
       RowBox[{"4", ",", "3"}], "]"}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"wVec", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "^", "2"}], "-", 
       RowBox[{
        RowBox[{"wVec", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "^", "2"}]}], ")"}]}], " ", "+", " ", 
    RowBox[{"2", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "-", "g4"}], ")"}], "*", 
     RowBox[{"wVec", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.766600411947711*^9, 3.766600443721468*^9}},
 CellLabel->
  "In[1087]:=",ExpressionUUID->"53666c8c-fb46-484e-be23-8c50d746d1dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"s4", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Q4", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "4"}], "]"}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"wVec", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "-", 
       RowBox[{
        RowBox[{"wVec", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "^", "2"}]}], ")"}]}], " ", "+", " ", 
    RowBox[{
     RowBox[{"Q4", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "4"}], "]"}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"wVec", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "^", "2"}], "-", 
       RowBox[{
        RowBox[{"wVec", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "^", "2"}]}], ")"}]}], " ", "+", " ", 
    RowBox[{"2", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "-", "g4"}], ")"}], "*", 
     RowBox[{"wVec", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.766600450461507*^9, 3.766600489942967*^9}},
 CellLabel->
  "In[1088]:=",ExpressionUUID->"60cd2514-dee5-4179-81f7-ea78671bdfc2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sVec", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"s1", ",", "s2", ",", "s3", ",", "s4"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.766600510118795*^9, 3.7666005178272886`*^9}},
 CellLabel->
  "In[1089]:=",ExpressionUUID->"a40d4302-426d-4e33-8ed0-93733df7984d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gamma", " ", "=", " ", 
   RowBox[{"ssRaw", ".", "sVec"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7666005280261364`*^9, 3.766600553151595*^9}, 
   3.7666006873720584`*^9, {3.766601049972251*^9, 3.7666010513904476`*^9}},
 CellLabel->
  "In[1090]:=",ExpressionUUID->"1fd77435-91b8-408c-b024-5186bd73b771"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{"ssRaw", " ", "/.", "valVec"}], "]"}]], "Input",
 CellChangeTimes->{{3.7666010563508406`*^9, 3.7666011141989098`*^9}, {
  3.766602553054135*^9, 3.7666025541951194`*^9}},
 CellLabel->
  "In[1091]:=",ExpressionUUID->"9c4ee586-e389-4513-a360-a1bd24a5f102"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.8993559982027857`", ",", "0.08252209075932306`", ",", 
   "0.00838700014976786`", ",", "0.00973491088812341`"}], "}"}]], "Output",
 CellChangeTimes->{{3.7666011063982267`*^9, 3.7666011155592237`*^9}, 
   3.7666013079557123`*^9, 3.7666013615730066`*^9, 3.76660143396585*^9, 
   3.7666019074204817`*^9, {3.766602558793974*^9, 3.7666025754465027`*^9}, 
   3.7666028088023396`*^9},
 CellLabel->
  "Out[1091]=",ExpressionUUID->"ccb91022-00cb-498f-80cb-cf8bb1fc6955"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{"gamma", " ", "/.", "valVec"}], "]"}]], "Input",
 CellChangeTimes->{{3.766601135145914*^9, 3.7666011626684504`*^9}, {
  3.7666025344767933`*^9, 3.766602539500366*^9}},
 CellLabel->
  "In[1092]:=",ExpressionUUID->"c0d76549-0799-44aa-a974-9d928939a97f"],

Cell[BoxData["0.0015127260283620643`"], "Output",
 CellChangeTimes->{
  3.766601167064699*^9, 3.766601313427122*^9, 3.7666013617245636`*^9, 
   3.766601434139351*^9, 3.766601907794485*^9, {3.76660255905328*^9, 
   3.766602575584134*^9}, 3.766602808842247*^9},
 CellLabel->
  "Out[1092]=",ExpressionUUID->"ed9e893d-4269-497a-b53f-10b1b094c66e"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.766600016196229*^9, 3.766600016206195*^9}, 
   3.7666004037944202`*^9},
 CellLabel->
  "In[1093]:=",ExpressionUUID->"c33a1c32-6680-4818-9ea8-529f3ac7fe6c"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7665997466497107`*^9, 3.76659977198212*^9}, 
   3.7665998410360575`*^9},
 CellLabel->
  "In[1094]:=",ExpressionUUID->"2a39eaeb-83bb-4e82-8b50-0f74543f6bbb"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1264, 661},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 255, 6, 105, "Section",ExpressionUUID->"0cd71903-4765-4253-86c7-583733eb7283"],
Cell[838, 30, 227, 4, 28, "Input",ExpressionUUID->"f53ddaf6-0803-4542-a92f-8240a1d82c27"],
Cell[1068, 36, 584, 16, 28, "Input",ExpressionUUID->"a93bd09d-17ad-4522-901a-fa6e5c4b0f05"],
Cell[1655, 54, 660, 16, 28, "Input",ExpressionUUID->"29321b1a-90f1-4c75-8f1a-7434896df5af"],
Cell[2318, 72, 946, 26, 28, "Input",ExpressionUUID->"9c208344-b914-4a91-af3b-57aa27d1e452"],
Cell[3267, 100, 370, 9, 28, "Input",ExpressionUUID->"59cb4cf4-27f2-4409-937f-21b6551d42d3"],
Cell[3640, 111, 281, 6, 28, "Input",ExpressionUUID->"5d25927e-1ef7-47f6-a1dc-8569ff8b995e"],
Cell[3924, 119, 530, 13, 28, "Input",ExpressionUUID->"1b51bc59-d5a1-412b-9f72-d20ee10c2b54"],
Cell[4457, 134, 252, 4, 28, "Input",ExpressionUUID->"4fe61074-1312-425c-ae10-f001d7295dbd"],
Cell[4712, 140, 295, 7, 28, "Input",ExpressionUUID->"fd7c28c3-652c-4b27-b207-09b80f324c5f"],
Cell[5010, 149, 258, 6, 28, "Input",ExpressionUUID->"dd6edc2a-abb3-4355-b2b7-a9b600e99bc1"],
Cell[CellGroupData[{
Cell[5293, 159, 212, 4, 44, "Subsubsection",ExpressionUUID->"4bbb22a6-f9b4-4c69-8d47-32491673556f"],
Cell[5508, 165, 357, 8, 28, "Input",ExpressionUUID->"ca8e9be0-0b84-4e9d-9416-0b70501605ff"],
Cell[5868, 175, 787, 23, 28, "Input",ExpressionUUID->"627ec138-4cf3-45df-95dd-9dca55ad5796"],
Cell[6658, 200, 787, 23, 28, "Input",ExpressionUUID->"f498e0d9-a95c-4e8d-bc15-854e2613ed30"],
Cell[7448, 225, 736, 22, 28, "Input",ExpressionUUID->"bf44010f-bcbe-4e20-b538-313668dbb678"],
Cell[8187, 249, 736, 22, 28, "Input",ExpressionUUID->"fa518dc3-7d43-4e49-af75-3f71a5204214"],
Cell[8926, 273, 524, 10, 28, "Input",ExpressionUUID->"e379dcb2-a5ad-40f2-9be5-267b2ed7185a"],
Cell[9453, 285, 469, 13, 28, "Input",ExpressionUUID->"2c6f4674-9887-4b04-8adc-f8feb90a44c3"],
Cell[9925, 300, 445, 11, 28, "Input",ExpressionUUID->"77bcbbd5-e42c-4088-8b3e-43edf1ecbb7a"],
Cell[10373, 313, 758, 18, 28, "Input",ExpressionUUID->"690ddcee-ea56-4d0e-a016-e2a2fdf994f8"],
Cell[11134, 333, 740, 18, 28, "Input",ExpressionUUID->"ca135eab-329f-4610-a2aa-4a865fcc44d2"],
Cell[11877, 353, 743, 18, 28, "Input",ExpressionUUID->"cc912d2f-6d6a-4bcd-ab2c-220081908be5"],
Cell[CellGroupData[{
Cell[12645, 375, 269, 5, 28, InheritFromParent,ExpressionUUID->"e2ec7bff-132f-4825-855e-08099fc55687"],
Cell[12917, 382, 256, 6, 32, "Output",ExpressionUUID->"bbf2ceb9-88a3-4d18-8ddd-bd8b581b1128"]
}, Open  ]],
Cell[13188, 391, 1488, 41, 28, "Input",ExpressionUUID->"0e464976-b146-49e2-9878-98e36c496bc6"],
Cell[14679, 434, 1304, 39, 28, "Input",ExpressionUUID->"2f9a8cef-843c-4fe2-80b9-e97521d837ce"],
Cell[15986, 475, 1204, 37, 28, "Input",ExpressionUUID->"53666c8c-fb46-484e-be23-8c50d746d1dc"],
Cell[17193, 514, 1204, 37, 28, "Input",ExpressionUUID->"60cd2514-dee5-4179-81f7-ea78671bdfc2"],
Cell[18400, 553, 305, 7, 28, "Input",ExpressionUUID->"a40d4302-426d-4e33-8ed0-93733df7984d"],
Cell[18708, 562, 340, 7, 28, "Input",ExpressionUUID->"1fd77435-91b8-408c-b024-5186bd73b771"],
Cell[CellGroupData[{
Cell[19073, 573, 297, 6, 28, "Input",ExpressionUUID->"9c4ee586-e389-4513-a360-a1bd24a5f102"],
Cell[19373, 581, 506, 10, 32, "Output",ExpressionUUID->"ccb91022-00cb-498f-80cb-cf8bb1fc6955"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19916, 596, 295, 6, 28, "Input",ExpressionUUID->"c0d76549-0799-44aa-a974-9d928939a97f"],
Cell[20214, 604, 343, 6, 32, "Output",ExpressionUUID->"ed9e893d-4269-497a-b53f-10b1b094c66e"]
}, Open  ]],
Cell[20572, 613, 204, 4, 28, InheritFromParent,ExpressionUUID->"c33a1c32-6680-4818-9ea8-529f3ac7fe6c"],
Cell[20779, 619, 205, 4, 28, "Input",ExpressionUUID->"2a39eaeb-83bb-4e82-8b50-0f74543f6bbb"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

