(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     29063,        787]
NotebookOptionsPosition[     26532,        739]
NotebookOutlinePosition[     26878,        754]
CellTagsIndexPosition[     26835,        751]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[StyleBox["Solution to general 4 state model with forward k \
rates and reverse r rates ", "Section"]], "Text",
 CellChangeTimes->{{3.750384041936879*^9, 3.7503840629025908`*^9}, {
  3.7541376872592278`*^9, 
  3.7541376890619497`*^9}},ExpressionUUID->"d1518c95-f8f3-413c-b038-\
17f90c0a1e60"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ass", "=", 
   RowBox[{"{", " ", 
    RowBox[{
     RowBox[{"koff", ">", "0"}], " ", ",", " ", 
     RowBox[{"km", ">", "0"}], ",", " ", 
     RowBox[{"kp", ">", "0"}], ",", " ", 
     RowBox[{"kon", ">", "0"}], ",", " ", 
     RowBox[{"c0", "<", "c1"}], ",", " ", 
     RowBox[{"c1", ">", "0"}], ",", " ", 
     RowBox[{"c0", ">", "0"}], ",", " ", 
     RowBox[{"b", " ", ">", " ", "1"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.750345019237339*^9, 3.7503450539523153`*^9}, {
  3.7541376911164703`*^9, 3.754137691796073*^9}, {3.754139973332193*^9, 
  3.754140007229397*^9}, {3.754142059571416*^9, 3.754142059771084*^9}, {
  3.754143332172714*^9, 3.75414333445453*^9}, {3.754143472486924*^9, 
  3.754143474028854*^9}, {3.7571713474989743`*^9, 3.757171356767172*^9}},
 CellLabel->
  "In[114]:=",ExpressionUUID->"c95437b1-8467-44ee-b3ad-5728a54b961b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"J", ",", "J", ",", "J", ",", "J", ",", "1"}], "}"}], 
      "\[Equal]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"k1", " ", "p1"}], " ", "-", " ", 
         RowBox[{"r1", " ", "p2"}]}], ",", " ", 
        RowBox[{
         RowBox[{"k2", " ", "p2"}], " ", "-", " ", 
         RowBox[{"r2", " ", "p3"}]}], ",", " ", 
        RowBox[{
         RowBox[{"k3", " ", "p3"}], " ", "-", " ", 
         RowBox[{"r3", " ", "p4"}]}], ",", " ", 
        RowBox[{
         RowBox[{"k4", " ", "p4"}], " ", "-", " ", 
         RowBox[{"r4", " ", "p1"}]}], ",", " ", 
        RowBox[{"p1", "+", "p2", "+", "p3", "+", "p4"}]}], "}"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"J", ",", " ", "p1", ",", "p2", ",", "p3", ",", "p4"}], "}"}]}],
     "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7450741599696827`*^9, 3.7450741968805532`*^9}, {
   3.750343738376728*^9, 3.750343740147134*^9}, {3.750357778746254*^9, 
   3.750357778821937*^9}, {3.7541379940669727`*^9, 3.754137994633065*^9}, {
   3.754139921940263*^9, 3.7541399257643223`*^9}, {3.754142072152648*^9, 
   3.754142076472227*^9}, 3.7541445815119257`*^9},
 CellLabel->
  "In[115]:=",ExpressionUUID->"7fb5bbc1-0e7f-4bb4-a355-efe1fde738a9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"J", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"k1", " ", "k2", " ", "k3", " ", "k4"}], "-", 
       RowBox[{"r1", " ", "r2", " ", "r3", " ", "r4"}]}], 
      RowBox[{
       RowBox[{"k2", " ", "k3", " ", "k4"}], "+", 
       RowBox[{"k4", " ", "r1", " ", 
        RowBox[{"(", 
         RowBox[{"k3", "+", "r2"}], ")"}]}], "+", 
       RowBox[{"r1", " ", "r2", " ", "r3"}], "+", 
       RowBox[{"k1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"k4", " ", 
           RowBox[{"(", 
            RowBox[{"k3", "+", "r2"}], ")"}]}], "+", 
          RowBox[{"r2", " ", "r3"}], "+", 
          RowBox[{"k2", " ", 
           RowBox[{"(", 
            RowBox[{"k3", "+", "k4", "+", "r3"}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"r1", " ", 
        RowBox[{"(", 
         RowBox[{"k3", "+", "r2"}], ")"}], " ", "r4"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"r1", "+", "r2"}], ")"}], " ", "r3", " ", "r4"}], "+", 
       RowBox[{"k2", " ", 
        RowBox[{"(", 
         RowBox[{"k3", "+", "r3"}], ")"}], " ", "r4"}]}]]}], ",", 
    RowBox[{"p1", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"k2", " ", "k3", " ", "k4"}], "+", 
       RowBox[{"k3", " ", "k4", " ", "r1"}], "+", 
       RowBox[{"r1", " ", "r2", " ", 
        RowBox[{"(", 
         RowBox[{"k4", "+", "r3"}], ")"}]}]}], 
      RowBox[{
       RowBox[{"k2", " ", "k3", " ", "k4"}], "+", 
       RowBox[{"k4", " ", "r1", " ", 
        RowBox[{"(", 
         RowBox[{"k3", "+", "r2"}], ")"}]}], "+", 
       RowBox[{"r1", " ", "r2", " ", "r3"}], "+", 
       RowBox[{"k1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"k4", " ", 
           RowBox[{"(", 
            RowBox[{"k3", "+", "r2"}], ")"}]}], "+", 
          RowBox[{"r2", " ", "r3"}], "+", 
          RowBox[{"k2", " ", 
           RowBox[{"(", 
            RowBox[{"k3", "+", "k4", "+", "r3"}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"r1", " ", 
        RowBox[{"(", 
         RowBox[{"k3", "+", "r2"}], ")"}], " ", "r4"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"r1", "+", "r2"}], ")"}], " ", "r3", " ", "r4"}], "+", 
       RowBox[{"k2", " ", 
        RowBox[{"(", 
         RowBox[{"k3", "+", "r3"}], ")"}], " ", "r4"}]}]]}], ",", 
    RowBox[{"p2", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"k1", " ", "k4", " ", 
        RowBox[{"(", 
         RowBox[{"k3", "+", "r2"}], ")"}]}], "+", 
       RowBox[{"k1", " ", "r2", " ", "r3"}], "+", 
       RowBox[{"r2", " ", "r3", " ", "r4"}]}], 
      RowBox[{
       RowBox[{"k2", " ", "k3", " ", "k4"}], "+", 
       RowBox[{"k4", " ", "r1", " ", 
        RowBox[{"(", 
         RowBox[{"k3", "+", "r2"}], ")"}]}], "+", 
       RowBox[{"r1", " ", "r2", " ", "r3"}], "+", 
       RowBox[{"k1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"k4", " ", 
           RowBox[{"(", 
            RowBox[{"k3", "+", "r2"}], ")"}]}], "+", 
          RowBox[{"r2", " ", "r3"}], "+", 
          RowBox[{"k2", " ", 
           RowBox[{"(", 
            RowBox[{"k3", "+", "k4", "+", "r3"}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"r1", " ", 
        RowBox[{"(", 
         RowBox[{"k3", "+", "r2"}], ")"}], " ", "r4"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"r1", "+", "r2"}], ")"}], " ", "r3", " ", "r4"}], "+", 
       RowBox[{"k2", " ", 
        RowBox[{"(", 
         RowBox[{"k3", "+", "r3"}], ")"}], " ", "r4"}]}]]}], ",", 
    RowBox[{"p3", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"k1", " ", "k2", " ", 
        RowBox[{"(", 
         RowBox[{"k4", "+", "r3"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"k2", "+", "r1"}], ")"}], " ", "r3", " ", "r4"}]}], 
      RowBox[{
       RowBox[{"k2", " ", "k3", " ", "k4"}], "+", 
       RowBox[{"k4", " ", "r1", " ", 
        RowBox[{"(", 
         RowBox[{"k3", "+", "r2"}], ")"}]}], "+", 
       RowBox[{"r1", " ", "r2", " ", "r3"}], "+", 
       RowBox[{"k1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"k4", " ", 
           RowBox[{"(", 
            RowBox[{"k3", "+", "r2"}], ")"}]}], "+", 
          RowBox[{"r2", " ", "r3"}], "+", 
          RowBox[{"k2", " ", 
           RowBox[{"(", 
            RowBox[{"k3", "+", "k4", "+", "r3"}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"r1", " ", 
        RowBox[{"(", 
         RowBox[{"k3", "+", "r2"}], ")"}], " ", "r4"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"r1", "+", "r2"}], ")"}], " ", "r3", " ", "r4"}], "+", 
       RowBox[{"k2", " ", 
        RowBox[{"(", 
         RowBox[{"k3", "+", "r3"}], ")"}], " ", "r4"}]}]]}], ",", 
    RowBox[{"p4", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"k1", " ", "k2", " ", "k3"}], "+", 
       RowBox[{"k2", " ", "k3", " ", "r4"}], "+", 
       RowBox[{"r1", " ", 
        RowBox[{"(", 
         RowBox[{"k3", "+", "r2"}], ")"}], " ", "r4"}]}], 
      RowBox[{
       RowBox[{"k2", " ", "k3", " ", "k4"}], "+", 
       RowBox[{"k4", " ", "r1", " ", 
        RowBox[{"(", 
         RowBox[{"k3", "+", "r2"}], ")"}]}], "+", 
       RowBox[{"r1", " ", "r2", " ", "r3"}], "+", 
       RowBox[{"k1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"k4", " ", 
           RowBox[{"(", 
            RowBox[{"k3", "+", "r2"}], ")"}]}], "+", 
          RowBox[{"r2", " ", "r3"}], "+", 
          RowBox[{"k2", " ", 
           RowBox[{"(", 
            RowBox[{"k3", "+", "k4", "+", "r3"}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"r1", " ", 
        RowBox[{"(", 
         RowBox[{"k3", "+", "r2"}], ")"}], " ", "r4"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"r1", "+", "r2"}], ")"}], " ", "r3", " ", "r4"}], "+", 
       RowBox[{"k2", " ", 
        RowBox[{"(", 
         RowBox[{"k3", "+", "r3"}], ")"}], " ", "r4"}]}]]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.754409976383402*^9, 3.7571712673519435`*^9, 
  3.7571730638906927`*^9, 3.7579438018250227`*^9, 3.75830164418342*^9},
 CellLabel->
  "Out[115]=",ExpressionUUID->"954c8f1e-93ec-478c-b98b-f292795249ff"]
}, Open  ]],

Cell["\<\
Our specific system has symmetry, concentration dependence of activator \
binding (c) and energy input (b) on edge from state 2->1. when b = 1 then the \
system obeys detailed balance by construction\
\>", "Text",
 CellChangeTimes->{{3.750384069847657*^9, 3.750384073926244*^9}, {
  3.75413811648597*^9, 3.754138144004209*^9}, {3.754138220034409*^9, 
  3.754138238383642*^9}, {3.754139444317975*^9, 3.754139471025515*^9}, {
  3.754409984809718*^9, 
  3.754409985084999*^9}},ExpressionUUID->"57476a6a-3be2-4c96-bdb7-\
d81fff26d895"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"symSol", " ", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"sol", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"k1", "\[Rule]", " ", 
       RowBox[{"c", " ", "kon"}]}], ",", " ", 
      RowBox[{"r1", "\[Rule]", "  ", "koff"}], ",", " ", 
      RowBox[{"k3", "\[Rule]", " ", "koff"}], ",", " ", 
      RowBox[{"r3", "\[Rule]", " ", 
       RowBox[{"c", " ", "kon"}]}], ",", " ", 
      RowBox[{"k2", "\[Rule]", "  ", "kp"}], ",", " ", 
      RowBox[{"r2", "\[Rule]", " ", "km"}], ",", " ", 
      RowBox[{"k4", "\[Rule]", " ", 
       RowBox[{"b", " ", "km"}]}], ",", " ", 
      RowBox[{"r4", "\[Rule]", "  ", "kp"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.750270828442218*^9, 3.7502709253892717`*^9}, {
   3.750271135055722*^9, 3.7502711415787287`*^9}, {3.750273120141753*^9, 
   3.7502731252525797`*^9}, 3.750273174328928*^9, {3.75034470917811*^9, 
   3.7503447093443947`*^9}, {3.750357805818123*^9, 3.750357835662365*^9}, {
   3.75413825427017*^9, 3.754138272719884*^9}, {3.7583016101274705`*^9, 
   3.7583016241838884`*^9}},
 CellLabel->
  "In[116]:=",ExpressionUUID->"4d1ce54a-26aa-4a0e-866a-5330bf9dd464"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"J", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "b"}], ")"}], " ", "c", " ", "km", " ", 
       "koff", " ", "kon", " ", "kp"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"koff", "+", 
         RowBox[{"c", " ", "kon"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "kon", " ", 
          RowBox[{"(", 
           RowBox[{"km", "+", "kp"}], ")"}]}], "+", 
         RowBox[{"b", " ", "km", " ", 
          RowBox[{"(", 
           RowBox[{"km", "+", "koff", "+", "kp"}], ")"}]}], "+", 
         RowBox[{"kp", " ", 
          RowBox[{"(", 
           RowBox[{"km", "+", "koff", "+", "kp"}], ")"}]}]}], ")"}]}]]}], ",", 
    RowBox[{"p1", "\[Rule]", 
     FractionBox[
      RowBox[{"km", " ", "koff", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "kon"}], "+", 
         RowBox[{"b", " ", 
          RowBox[{"(", 
           RowBox[{"km", "+", "koff", "+", "kp"}], ")"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"koff", "+", 
         RowBox[{"c", " ", "kon"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "kon", " ", 
          RowBox[{"(", 
           RowBox[{"km", "+", "kp"}], ")"}]}], "+", 
         RowBox[{"b", " ", "km", " ", 
          RowBox[{"(", 
           RowBox[{"km", "+", "koff", "+", "kp"}], ")"}]}], "+", 
         RowBox[{"kp", " ", 
          RowBox[{"(", 
           RowBox[{"km", "+", "koff", "+", "kp"}], ")"}]}]}], ")"}]}]]}], ",", 
    RowBox[{"p2", "\[Rule]", 
     FractionBox[
      RowBox[{"c", " ", "km", " ", "kon", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"b", " ", 
          RowBox[{"(", 
           RowBox[{"km", "+", "koff"}], ")"}]}], "+", 
         RowBox[{"c", " ", "kon"}], "+", "kp"}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"koff", "+", 
         RowBox[{"c", " ", "kon"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "kon", " ", 
          RowBox[{"(", 
           RowBox[{"km", "+", "kp"}], ")"}]}], "+", 
         RowBox[{"b", " ", "km", " ", 
          RowBox[{"(", 
           RowBox[{"km", "+", "koff", "+", "kp"}], ")"}]}], "+", 
         RowBox[{"kp", " ", 
          RowBox[{"(", 
           RowBox[{"km", "+", "koff", "+", "kp"}], ")"}]}]}], ")"}]}]]}], ",", 
    RowBox[{"p3", "\[Rule]", 
     FractionBox[
      RowBox[{"c", " ", "kon", " ", "kp", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"b", " ", "km"}], "+", "koff", "+", 
         RowBox[{"c", " ", "kon"}], "+", "kp"}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"koff", "+", 
         RowBox[{"c", " ", "kon"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "kon", " ", 
          RowBox[{"(", 
           RowBox[{"km", "+", "kp"}], ")"}]}], "+", 
         RowBox[{"b", " ", "km", " ", 
          RowBox[{"(", 
           RowBox[{"km", "+", "koff", "+", "kp"}], ")"}]}], "+", 
         RowBox[{"kp", " ", 
          RowBox[{"(", 
           RowBox[{"km", "+", "koff", "+", "kp"}], ")"}]}]}], ")"}]}]]}], ",", 
    RowBox[{"p4", "\[Rule]", 
     FractionBox[
      RowBox[{"koff", " ", "kp", " ", 
       RowBox[{"(", 
        RowBox[{"km", "+", "koff", "+", 
         RowBox[{"c", " ", "kon"}], "+", "kp"}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"koff", "+", 
         RowBox[{"c", " ", "kon"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "kon", " ", 
          RowBox[{"(", 
           RowBox[{"km", "+", "kp"}], ")"}]}], "+", 
         RowBox[{"b", " ", "km", " ", 
          RowBox[{"(", 
           RowBox[{"km", "+", "koff", "+", "kp"}], ")"}]}], "+", 
         RowBox[{"kp", " ", 
          RowBox[{"(", 
           RowBox[{"km", "+", "koff", "+", "kp"}], ")"}]}]}], ")"}]}]]}]}], 
   "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.750270919819333*^9, 3.750270925973634*^9}, 
   3.750271142598151*^9, 3.750273125986121*^9, 3.750273175023505*^9, 
   3.750343772690199*^9, 3.75034471093965*^9, 3.75035780658092*^9, 
   3.75035783684374*^9, {3.7541382417816057`*^9, 3.754138273639433*^9}, 
   3.754142623945938*^9, 3.7541434792438393`*^9, 3.7541442793190804`*^9, 
   3.7541445868881187`*^9, 3.754409987836501*^9, 3.7571712678196926`*^9, 
   3.7571730643025894`*^9, 3.757943802169448*^9, 3.7583016445733767`*^9},
 CellLabel->
  "Out[116]=",ExpressionUUID->"d70fd5c0-8eba-4818-87cb-f7e98745eb52"]
}, Open  ]],

Cell[TextData[StyleBox["We are treating state 3 as the productive state - \
i.e. the one in which transcription happens. Copied p3 from above solution", \
"Subsubsection"]], "Text",
 CellChangeTimes->{{3.754138276459917*^9, 3.754138333055722*^9}, {
  3.754138513073224*^9, 3.754138513839487*^9}, {3.754138654558078*^9, 
  3.754138728796371*^9}, {3.754409995772583*^9, 
  3.754410002669238*^9}},ExpressionUUID->"19646b47-4fc7-459f-8a88-\
4f006c354ecf"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"p3cb", "[", "c_", "]"}], " ", "=", " ", 
   RowBox[{"p3", "/.", " ", 
    RowBox[{"symSol", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"p3cb", "[", "c", "]"}], " ", "/.", " ", 
   RowBox[{"{", 
    RowBox[{"b", " ", "\[Rule]", " ", "1"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.750270828442218*^9, 3.7502709253892717`*^9}, {
   3.750271135055722*^9, 3.7502711415787287`*^9}, {3.750273120141753*^9, 
   3.7502731252525797`*^9}, 3.750273174328928*^9, {3.75034470917811*^9, 
   3.7503447093443947`*^9}, {3.750357805818123*^9, 3.750357835662365*^9}, {
   3.75413825427017*^9, 3.754138272719884*^9}, {3.75413874371506*^9, 
   3.754138837305544*^9}, {3.754142263007573*^9, 3.754142265582119*^9}, 
   3.7583016371482277`*^9},
 CellLabel->
  "In[117]:=",ExpressionUUID->"5335b349-278a-4278-9db8-36a1606a1160"],

Cell[BoxData[
 FractionBox[
  RowBox[{"c", " ", "kon", " ", "kp"}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"koff", "+", 
     RowBox[{"c", " ", "kon"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"km", "+", "kp"}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.7541388082074537`*^9, 3.754138840663299*^9}, 
   3.7541426240271187`*^9, 3.754143479343245*^9, 3.754144279399077*^9, 
   3.754144599363389*^9, 3.754410005935557*^9, 3.757171267909452*^9, 
   3.7571730644432144`*^9, 3.7579438022126036`*^9, 3.7583016446451845`*^9},
 CellLabel->
  "Out[118]=",ExpressionUUID->"8a3bdbef-ab45-4e7e-8f47-abd8b002a2a4"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"b", " ", "=", " ", 
    RowBox[{"1", " ", "forces", " ", "equilibrium"}]}], " ", "*)"}], " ", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p3c", "[", "c_", "]"}], " ", "=", " ", 
    FractionBox[
     RowBox[{"c", " ", "kon", " ", "kp"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"koff", "+", 
        RowBox[{"c", " ", "kon"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"km", "+", "kp"}], ")"}]}]]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.754138858220316*^9, 3.754138866534433*^9}, {
  3.754410019410137*^9, 3.754410029264928*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"5cd25b71-61f7-4757-8e0b-fa542d01856d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"calculate", " ", "fidelity", " ", "ratios", " ", 
    RowBox[{"in", "/", "out"}], " ", "of", " ", "equilibrium"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"eqRatio", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"p3c", "[", "c1", "]"}], " ", "/", " ", 
      RowBox[{"p3c", "[", "c0", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"noneqRatio", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"p3cb", "[", "c1", "]"}], " ", "/", " ", 
      RowBox[{"p3cb", "[", "c0", "]"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.754142610648045*^9, 3.7541426633604*^9}, {
  3.754143075787678*^9, 3.7541430849103813`*^9}, {3.7544097702047853`*^9, 
  3.7544097708120832`*^9}, {3.754410035553958*^9, 3.754410046050346*^9}},
 CellLabel->
  "In[120]:=",ExpressionUUID->"a3260b4f-c2f6-4d0a-b124-5046d4161368"],

Cell[BoxData[
 FractionBox[
  RowBox[{"c1", " ", 
   RowBox[{"(", 
    RowBox[{"koff", "+", 
     RowBox[{"c0", " ", "kon"}]}], ")"}]}], 
  RowBox[{"c0", " ", 
   RowBox[{"(", 
    RowBox[{"koff", "+", 
     RowBox[{"c1", " ", "kon"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.75414265191422*^9, 3.7541426642104197`*^9}, 
   3.7541430855279493`*^9, 3.754143479476502*^9, 3.754144279523181*^9, 
   3.7541446167749863`*^9, 3.7544100489222527`*^9, 3.757171268030129*^9, 
   3.7571730645499277`*^9, 3.757943802292885*^9, 3.7583016447139997`*^9},
 CellLabel->
  "Out[120]=",ExpressionUUID->"483b3f6d-4e36-4c6c-a07d-f32395f547e4"],

Cell[BoxData[
 FractionBox[
  RowBox[{"c1", " ", 
   RowBox[{"(", 
    RowBox[{"koff", "+", 
     RowBox[{"c0", " ", "kon"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"b", " ", "km"}], "+", "koff", "+", 
     RowBox[{"c1", " ", "kon"}], "+", "kp"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"c0", " ", "kon", " ", 
      RowBox[{"(", 
       RowBox[{"km", "+", "kp"}], ")"}]}], "+", 
     RowBox[{"b", " ", "km", " ", 
      RowBox[{"(", 
       RowBox[{"km", "+", "koff", "+", "kp"}], ")"}]}], "+", 
     RowBox[{"kp", " ", 
      RowBox[{"(", 
       RowBox[{"km", "+", "koff", "+", "kp"}], ")"}]}]}], ")"}]}], 
  RowBox[{"c0", " ", 
   RowBox[{"(", 
    RowBox[{"koff", "+", 
     RowBox[{"c1", " ", "kon"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"b", " ", "km"}], "+", "koff", "+", 
     RowBox[{"c0", " ", "kon"}], "+", "kp"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"c1", " ", "kon", " ", 
      RowBox[{"(", 
       RowBox[{"km", "+", "kp"}], ")"}]}], "+", 
     RowBox[{"b", " ", "km", " ", 
      RowBox[{"(", 
       RowBox[{"km", "+", "koff", "+", "kp"}], ")"}]}], "+", 
     RowBox[{"kp", " ", 
      RowBox[{"(", 
       RowBox[{"km", "+", "koff", "+", "kp"}], ")"}]}]}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.75414265191422*^9, 3.7541426642104197`*^9}, 
   3.7541430855279493`*^9, 3.754143479476502*^9, 3.754144279523181*^9, 
   3.7541446167749863`*^9, 3.7544100489222527`*^9, 3.757171268030129*^9, 
   3.7571730645499277`*^9, 3.757943802292885*^9, 3.758301645307414*^9},
 CellLabel->
  "Out[121]=",ExpressionUUID->"96965ded-deb5-4e35-b415-4f844b07a4a5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fidelityNorm", " ", "=", " ", 
  RowBox[{"noneqRatio", " ", "*", " ", 
   RowBox[{"c0", " ", "/", " ", "c1"}]}]}]], "Input",
 CellChangeTimes->{{3.757171183744201*^9, 3.757171185119487*^9}, {
  3.7579438348880033`*^9, 3.7579438536465197`*^9}},
 CellLabel->
  "In[122]:=",ExpressionUUID->"ffa10b85-0cde-43e2-ac8b-9d49f8037980"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"koff", "+", 
     RowBox[{"c0", " ", "kon"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"b", " ", "km"}], "+", "koff", "+", 
     RowBox[{"c1", " ", "kon"}], "+", "kp"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"c0", " ", "kon", " ", 
      RowBox[{"(", 
       RowBox[{"km", "+", "kp"}], ")"}]}], "+", 
     RowBox[{"b", " ", "km", " ", 
      RowBox[{"(", 
       RowBox[{"km", "+", "koff", "+", "kp"}], ")"}]}], "+", 
     RowBox[{"kp", " ", 
      RowBox[{"(", 
       RowBox[{"km", "+", "koff", "+", "kp"}], ")"}]}]}], ")"}]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"koff", "+", 
     RowBox[{"c1", " ", "kon"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"b", " ", "km"}], "+", "koff", "+", 
     RowBox[{"c0", " ", "kon"}], "+", "kp"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"c1", " ", "kon", " ", 
      RowBox[{"(", 
       RowBox[{"km", "+", "kp"}], ")"}]}], "+", 
     RowBox[{"b", " ", "km", " ", 
      RowBox[{"(", 
       RowBox[{"km", "+", "koff", "+", "kp"}], ")"}]}], "+", 
     RowBox[{"kp", " ", 
      RowBox[{"(", 
       RowBox[{"km", "+", "koff", "+", "kp"}], ")"}]}]}], ")"}]}]]], "Output",
 CellChangeTimes->{3.7579438804285793`*^9, 3.758301645426097*^9},
 CellLabel->
  "Out[122]=",ExpressionUUID->"12947548-6dc3-49fe-9fb7-e34808ec6c89"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fidelityNorm1", " ", "=", " ", 
  RowBox[{"fidelityNorm", "  ", "/.", " ", 
   RowBox[{"c0", " ", "\[Rule]", " ", "1"}]}]}]], "Input",
 CellChangeTimes->{{3.7579438842609215`*^9, 3.7579439385334797`*^9}},
 CellLabel->
  "In[123]:=",ExpressionUUID->"0eff5cf8-535f-4356-bf10-55a154dd1653"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"koff", "+", "kon"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"b", " ", "km"}], "+", "koff", "+", 
     RowBox[{"c1", " ", "kon"}], "+", "kp"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"kon", " ", 
      RowBox[{"(", 
       RowBox[{"km", "+", "kp"}], ")"}]}], "+", 
     RowBox[{"b", " ", "km", " ", 
      RowBox[{"(", 
       RowBox[{"km", "+", "koff", "+", "kp"}], ")"}]}], "+", 
     RowBox[{"kp", " ", 
      RowBox[{"(", 
       RowBox[{"km", "+", "koff", "+", "kp"}], ")"}]}]}], ")"}]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"koff", "+", 
     RowBox[{"c1", " ", "kon"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"b", " ", "km"}], "+", "koff", "+", "kon", "+", "kp"}], ")"}], 
   " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"c1", " ", "kon", " ", 
      RowBox[{"(", 
       RowBox[{"km", "+", "kp"}], ")"}]}], "+", 
     RowBox[{"b", " ", "km", " ", 
      RowBox[{"(", 
       RowBox[{"km", "+", "koff", "+", "kp"}], ")"}]}], "+", 
     RowBox[{"kp", " ", 
      RowBox[{"(", 
       RowBox[{"km", "+", "koff", "+", "kp"}], ")"}]}]}], ")"}]}]]], "Output",
 CellChangeTimes->{3.757943939405053*^9, 3.7583016454610033`*^9},
 CellLabel->
  "Out[123]=",ExpressionUUID->"4afb0e1f-2d86-44fe-b643-1958324f1968"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"fidelityNorm1", " ", ">", " ", "1"}], " ", "&&", " ", 
    RowBox[{"b", " ", ">", " ", "1"}], " ", "&&", " ", 
    RowBox[{"km", " ", ">", "0"}], " ", "&&", " ", 
    RowBox[{"kp", " ", ">", " ", "0"}], " ", "&&", " ", 
    RowBox[{"koff", " ", ">", 
     RowBox[{"0", " ", "kon"}], " ", ">", " ", "0"}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"b", ",", "km", ",", "kp", ",", "koff", ",", "kon"}], " ", 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.757943941946258*^9, 3.757944048321095*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"ce01085a-d88c-45f0-af14-3c3e414809e0"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.7579440502954435`*^9, 3.7583016454959106`*^9},
 CellLabel->
  "Out[124]=",ExpressionUUID->"a6bd985e-337b-40dd-bcd6-12a082ffc8dd"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7579438303516874`*^9, 3.757943831286328*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"ce12d7ac-c7f1-482e-8e0c-50e52139c840"],

Cell["\<\
Evidently there is no set of parameter values for which the fidelity exceeds \
the equilibrium limit\
\>", "Subsubsection",
 CellChangeTimes->{{3.7583016782508554`*^9, 
  3.758301704891669*^9}},ExpressionUUID->"882a0bff-633c-47bd-ba58-\
7deae034ab50"]
},
WindowSize->{1920, 1037},
WindowMargins->{{1912, Automatic}, {Automatic, -8}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 305, 5, 51, "Text",ExpressionUUID->"d1518c95-f8f3-413c-b038-17f90c0a1e60"],
Cell[866, 27, 894, 19, 28, "Input",ExpressionUUID->"c95437b1-8467-44ee-b3ad-5728a54b961b"],
Cell[CellGroupData[{
Cell[1785, 50, 1382, 33, 28, "Input",ExpressionUUID->"7fb5bbc1-0e7f-4bb4-a355-efe1fde738a9"],
Cell[3170, 85, 6165, 171, 159, "Output",ExpressionUUID->"954c8f1e-93ec-478c-b98b-f292795249ff"]
}, Open  ]],
Cell[9350, 259, 541, 10, 34, "Text",ExpressionUUID->"57476a6a-3be2-4c96-bdb7-d81fff26d895"],
Cell[CellGroupData[{
Cell[9916, 273, 1161, 24, 28, "Input",ExpressionUUID->"4d1ce54a-26aa-4a0e-866a-5330bf9dd464"],
Cell[11080, 299, 4595, 126, 109, "Output",ExpressionUUID->"d70fd5c0-8eba-4818-87cb-f7e98745eb52"]
}, Open  ]],
Cell[15690, 428, 451, 7, 39, "Text",ExpressionUUID->"19646b47-4fc7-459f-8a88-4f006c354ecf"],
Cell[CellGroupData[{
Cell[16166, 439, 947, 20, 48, "Input",ExpressionUUID->"5335b349-278a-4278-9db8-36a1606a1160"],
Cell[17116, 461, 607, 14, 59, "Output",ExpressionUUID->"8a3bdbef-ab45-4e7e-8f47-abd8b002a2a4"]
}, Open  ]],
Cell[17738, 478, 711, 20, 77, "Input",ExpressionUUID->"5cd25b71-61f7-4757-8e0b-fa542d01856d"],
Cell[CellGroupData[{
Cell[18474, 502, 945, 21, 67, "Input",ExpressionUUID->"a3260b4f-c2f6-4d0a-b124-5046d4161368"],
Cell[19422, 525, 628, 15, 59, "Output",ExpressionUUID->"483b3f6d-4e36-4c6c-a07d-f32395f547e4"],
Cell[20053, 542, 1642, 45, 59, "Output",ExpressionUUID->"96965ded-deb5-4e35-b415-4f844b07a4a5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21732, 592, 350, 7, 28, "Input",ExpressionUUID->"ffa10b85-0cde-43e2-ac8b-9d49f8037980"],
Cell[22085, 601, 1401, 42, 59, "Output",ExpressionUUID->"12947548-6dc3-49fe-9fb7-e34808ec6c89"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23523, 648, 311, 6, 28, "Input",ExpressionUUID->"0eff5cf8-535f-4356-bf10-55a154dd1653"],
Cell[23837, 656, 1340, 41, 59, "Output",ExpressionUUID->"4afb0e1f-2d86-44fe-b643-1958324f1968"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25214, 702, 659, 15, 28, "Input",ExpressionUUID->"ce01085a-d88c-45f0-af14-3c3e414809e0"],
Cell[25876, 719, 196, 4, 32, "Output",ExpressionUUID->"a6bd985e-337b-40dd-bcd6-12a082ffc8dd"]
}, Open  ]],
Cell[26087, 726, 177, 3, 28, "Input",ExpressionUUID->"ce12d7ac-c7f1-482e-8e0c-50e52139c840"],
Cell[26267, 731, 261, 6, 44, "Subsubsection",ExpressionUUID->"882a0bff-633c-47bd-ba58-7deae034ab50"]
}
]
*)

