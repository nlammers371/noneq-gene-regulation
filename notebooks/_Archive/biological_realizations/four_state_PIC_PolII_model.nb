(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     27083,        694]
NotebookOptionsPosition[     24278,        638]
NotebookOutlinePosition[     24624,        653]
CellTagsIndexPosition[     24581,        650]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[StyleBox["Chromatin looping + PIC recruitment model", \
"Title"]], "Section",
 CellChangeTimes->{{3.766585934056647*^9, 3.766585974405374*^9}, {
  3.7738627675323677`*^9, 3.773862784198575*^9}, {3.773863009789218*^9, 
  3.7738630285141363`*^9}, {3.7740187051533003`*^9, 3.7740187062287717`*^9}, {
  3.7782496396953597`*^9, 
  3.7782496495157037`*^9}},ExpressionUUID->"0cd71903-4765-4253-86c7-\
583733eb7283"],

Cell[CellGroupData[{

Cell["Define transition rate matrix", "Chapter",
 CellChangeTimes->{{3.7738627970900974`*^9, 
  3.77386281294569*^9}},ExpressionUUID->"82f7376a-6e3e-4b94-9f2e-\
252776723a79"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ass", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"km2", ">", "0"}], ",", " ", 
     RowBox[{"km1", " ", "\[GreaterEqual]", " ", "0"}], ",", 
     RowBox[{"km1", "<", "1"}], ",", " ", 
     RowBox[{"kp1", ">", "0.01"}], ",", 
     RowBox[{"kp1", "<", "1"}], ",", 
     RowBox[{"kp2", ">", "0"}], ",", 
     RowBox[{"kp2", "<", "1"}], ",", 
     RowBox[{"kon2", " ", ">", " ", "0"}], ",", " ", 
     RowBox[{"kon1", " ", "\[GreaterEqual]", " ", "kon2"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7782502432353215`*^9, 3.7782503337035*^9}, {
   3.778250395696122*^9, 3.778250412713254*^9}, {3.7782504480430593`*^9, 
   3.7782504570053387`*^9}, {3.7782507733637342`*^9, 
   3.7782507990662174`*^9}, {3.77825098482119*^9, 3.778250985563266*^9}, {
   3.7782510985902123`*^9, 3.778251112534095*^9}, {3.778251181388141*^9, 
   3.7782512492840414`*^9}, {3.77825128629618*^9, 3.778251290120081*^9}, {
   3.7782513337638497`*^9, 3.778251363783965*^9}, {3.7782514374421134`*^9, 
   3.7782514379131584`*^9}, 3.7782516687035856`*^9},
 CellLabel->"In[56]:=",ExpressionUUID->"5c21804e-453c-4bbc-8632-a70479881d8c"],

Cell["\<\
Assumptions: (1) productive transcription possible whenever PIC assembled at \
promoter (states 3 and 4)
\t\t         (2) rate of PIC assembly is sensitive to local TF concentration \
(which is itself linearly proportional to nuclear concentration)
\t\t         (3) forward rates of chromatin looping are equal
\t\t         (4) rates of PIC dis-assembly and chromatin unlooping may differ \
between conditions\
\>", "Text",
 CellChangeTimes->{{3.778249634729353*^9, 
  3.778249847670272*^9}},ExpressionUUID->"6b13bc3f-4c6e-4147-9cf7-\
c3160c4d4056"],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.7665860727694225`*^9, 3.7665860727953434`*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"f53ddaf6-0803-4542-a92f-8240a1d82c27"],

Cell[BoxData[
 RowBox[{
  RowBox[{"QLoop", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "km1"}], "-", 
        RowBox[{"c", "*", "kon1"}]}], ",", "     ", "kp1", ",", 
       "                              ", "0", ",", 
       "                          ", "koff"}], "}"}], ",", 
     "\[IndentingNewLine]", "               ", 
     RowBox[{"{", 
      RowBox[{"km1", ",", "                     ", 
       RowBox[{
        RowBox[{"-", "kp1"}], "-", 
        RowBox[{"c", "*", "kon2"}]}], ",", "           ", "koff", ",", 
       "                      ", "0"}], "}"}], ",", "\[IndentingNewLine]", 
     "               ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "                               ", 
       RowBox[{"c", "*", "kon2"}], ",", "          ", 
       RowBox[{
        RowBox[{"-", "koff"}], "-", "kp2"}], ",", "              ", "km2"}], 
      "}"}], ",", "\[IndentingNewLine]", "               ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c", "*", "kon1"}], ",", "                    ", "0", ",", 
       "                               ", "kp2", ",", "              ", 
       RowBox[{
        RowBox[{"-", "koff"}], "-", "km2"}]}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7665970485156336`*^9, 3.7665970506267967`*^9}, {
   3.76659709635977*^9, 3.7665972549757605`*^9}, 3.766597670769878*^9, {
   3.76659877422307*^9, 3.766598798872613*^9}, 3.7668379732594795`*^9, {
   3.7668380192182255`*^9, 3.7668380333733864`*^9}, 3.7673043615049086`*^9, {
   3.767304474930873*^9, 3.7673044962673674`*^9}, {3.7731512671132526`*^9, 
   3.7731512816774855`*^9}, {3.773151323238453*^9, 3.7731514797083254`*^9}, 
   3.773151512774988*^9, {3.7731523994341583`*^9, 3.773152408328412*^9}, {
   3.7735816684598513`*^9, 3.773581681528512*^9}, {3.773862817472582*^9, 
   3.7738628321533165`*^9}, {3.7738628735605717`*^9, 3.773862882109705*^9}, {
   3.77386292505684*^9, 3.7738629998976727`*^9}, {3.773863224355216*^9, 
   3.7738632543240633`*^9}, {3.773863328079584*^9, 3.7738633302188625`*^9}, {
   3.7745626214299192`*^9, 3.774562758734991*^9}, {3.7782498610384297`*^9, 
   3.7782498619483175`*^9}, {3.7782499249684305`*^9, 3.778250083434354*^9}, {
   3.7782510367032976`*^9, 3.7782510627979326`*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"9c208344-b914-4a91-af3b-57aa27d1e452"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "QLoop", "]"}]], "Input",
 CellChangeTimes->{{3.7738630560684404`*^9, 3.773863059222006*^9}, {
  3.7738632598014135`*^9, 3.7738632639792395`*^9}, {3.778250092721376*^9, 
  3.7782500937582417`*^9}},
 NumberMarks->False,
 CellLabel->"In[30]:=",ExpressionUUID->"c1da6231-a226-4878-886a-1ae8cbefdc95"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "km1"}], "-", 
       RowBox[{"c", " ", "kon1"}]}], "kp1", "0", "koff"},
     {"km1", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "c"}], " ", "kon2"}], "-", "kp1"}], "koff", "0"},
     {"0", 
      RowBox[{"c", " ", "kon2"}], 
      RowBox[{
       RowBox[{"-", "koff"}], "-", "kp2"}], "km2"},
     {
      RowBox[{"c", " ", "kon1"}], "0", "kp2", 
      RowBox[{
       RowBox[{"-", "km2"}], "-", "koff"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.773151496629105*^9, 3.773152412029496*^9, 3.7735810257618675`*^9, 
   3.773581691869362*^9, 3.773776214971841*^9, {3.7738630504963436`*^9, 
   3.7738630598166823`*^9}, 3.7738632659691796`*^9, 3.7738633341304035`*^9, 
   3.7745621687932463`*^9, 3.774562215568241*^9, 3.7745627653570185`*^9, 
   3.7782500946732626`*^9, {3.77825105593322*^9, 3.778251065963135*^9}},
 CellLabel->
  "Out[30]//MatrixForm=",ExpressionUUID->"e62636af-ca39-4af5-9527-\
a48ae7666fcf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", "QLoop", "]"}]], "Input",
 CellChangeTimes->{{3.7782500985804706`*^9, 3.7782501064643917`*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"9d11d41e-d080-4fd8-bb84-4e0b16a6a224"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.778250106858431*^9, {3.7782510582281375`*^9, 3.778251068210865*^9}},
 CellLabel->"Out[31]=",ExpressionUUID->"fee9e079-7874-492d-9e39-c1f9b5849462"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculate gradient wrt c", "Chapter",
 CellChangeTimes->{{3.773863107720293*^9, 
  3.773863118998131*^9}},ExpressionUUID->"ef5b6b1a-1ae2-4e6c-ad75-\
0d1453def836"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eigVectors", " ", "=", " ", 
   RowBox[{"Eigenvectors", "[", "QLoop", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7665979196138344`*^9, 3.7665979301282406`*^9}, {
  3.773863083016367*^9, 3.773863084145347*^9}, {3.7738632933484745`*^9, 
  3.773863296439209*^9}, {3.7782501128594723`*^9, 3.778250113380406*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"5d25927e-1ef7-47f6-a1dc-8569ff8b995e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ssRaw", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"eigVectors", "[", 
     RowBox[{"[", "1", "]"}], "]"}], " ", "/", " ", 
    RowBox[{"Total", "[", 
     RowBox[{"eigVectors", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.766597934072912*^9, 3.7665979843979015`*^9}, {
   3.766598018209607*^9, 3.7665980277008443`*^9}, 3.773151589061305*^9, 
   3.773863131245374*^9},
 CellLabel->"In[33]:=",ExpressionUUID->"1b51bc59-d5a1-412b-9f72-d20ee10c2b54"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"koff", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", "kon2", " ", "kp2"}], "+", 
       RowBox[{"kp1", " ", 
        RowBox[{"(", 
         RowBox[{"km2", "+", "koff", "+", "kp2"}], ")"}]}]}], ")"}]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["c", "2"], " ", "kon1", " ", "kon2", " ", 
      RowBox[{"(", 
       RowBox[{"km2", "+", "kp2"}], ")"}]}], "+", 
     RowBox[{"km1", " ", 
      RowBox[{"(", 
       RowBox[{"koff", "+", 
        RowBox[{"c", " ", "kon2"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"km2", "+", "koff", "+", "kp2"}], ")"}]}], "+", 
     RowBox[{"koff", " ", "kp1", " ", 
      RowBox[{"(", 
       RowBox[{"km2", "+", "koff", "+", "kp2"}], ")"}]}], "+", 
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"koff", " ", "kon1", " ", "kp1"}], "+", 
        RowBox[{"km2", " ", "kon1", " ", 
         RowBox[{"(", 
          RowBox[{"koff", "+", "kp1"}], ")"}]}], "+", 
        RowBox[{"koff", " ", "kon2", " ", "kp2"}], "+", 
        RowBox[{"kon1", " ", "kp1", " ", "kp2"}]}], ")"}]}]}]], ",", 
   FractionBox[
    RowBox[{"koff", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", "km2", " ", "kon1"}], "+", 
       RowBox[{"km1", " ", 
        RowBox[{"(", 
         RowBox[{"km2", "+", "koff", "+", "kp2"}], ")"}]}]}], ")"}]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["c", "2"], " ", "kon1", " ", "kon2", " ", 
      RowBox[{"(", 
       RowBox[{"km2", "+", "kp2"}], ")"}]}], "+", 
     RowBox[{"km1", " ", 
      RowBox[{"(", 
       RowBox[{"koff", "+", 
        RowBox[{"c", " ", "kon2"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"km2", "+", "koff", "+", "kp2"}], ")"}]}], "+", 
     RowBox[{"koff", " ", "kp1", " ", 
      RowBox[{"(", 
       RowBox[{"km2", "+", "koff", "+", "kp2"}], ")"}]}], "+", 
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"koff", " ", "kon1", " ", "kp1"}], "+", 
        RowBox[{"km2", " ", "kon1", " ", 
         RowBox[{"(", 
          RowBox[{"koff", "+", "kp1"}], ")"}]}], "+", 
        RowBox[{"koff", " ", "kon2", " ", "kp2"}], "+", 
        RowBox[{"kon1", " ", "kp1", " ", "kp2"}]}], ")"}]}]}]], ",", 
   FractionBox[
    RowBox[{"c", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"km1", " ", 
        RowBox[{"(", 
         RowBox[{"km2", "+", "koff"}], ")"}], " ", "kon2"}], "+", 
       RowBox[{"km2", " ", "kon1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", "kon2"}], "+", "kp1"}], ")"}]}]}], ")"}]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["c", "2"], " ", "kon1", " ", "kon2", " ", 
      RowBox[{"(", 
       RowBox[{"km2", "+", "kp2"}], ")"}]}], "+", 
     RowBox[{"km1", " ", 
      RowBox[{"(", 
       RowBox[{"koff", "+", 
        RowBox[{"c", " ", "kon2"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"km2", "+", "koff", "+", "kp2"}], ")"}]}], "+", 
     RowBox[{"koff", " ", "kp1", " ", 
      RowBox[{"(", 
       RowBox[{"km2", "+", "koff", "+", "kp2"}], ")"}]}], "+", 
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"koff", " ", "kon1", " ", "kp1"}], "+", 
        RowBox[{"km2", " ", "kon1", " ", 
         RowBox[{"(", 
          RowBox[{"koff", "+", "kp1"}], ")"}]}], "+", 
        RowBox[{"koff", " ", "kon2", " ", "kp2"}], "+", 
        RowBox[{"kon1", " ", "kp1", " ", "kp2"}]}], ")"}]}]}]], ",", 
   FractionBox[
    RowBox[{"c", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"km1", " ", "kon2", " ", "kp2"}], "+", 
       RowBox[{"c", " ", "kon1", " ", "kon2", " ", "kp2"}], "+", 
       RowBox[{"kon1", " ", "kp1", " ", 
        RowBox[{"(", 
         RowBox[{"koff", "+", "kp2"}], ")"}]}]}], ")"}]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["c", "2"], " ", "kon1", " ", "kon2", " ", 
      RowBox[{"(", 
       RowBox[{"km2", "+", "kp2"}], ")"}]}], "+", 
     RowBox[{"km1", " ", 
      RowBox[{"(", 
       RowBox[{"koff", "+", 
        RowBox[{"c", " ", "kon2"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"km2", "+", "koff", "+", "kp2"}], ")"}]}], "+", 
     RowBox[{"koff", " ", "kp1", " ", 
      RowBox[{"(", 
       RowBox[{"km2", "+", "koff", "+", "kp2"}], ")"}]}], "+", 
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"koff", " ", "kon1", " ", "kp1"}], "+", 
        RowBox[{"km2", " ", "kon1", " ", 
         RowBox[{"(", 
          RowBox[{"koff", "+", "kp1"}], ")"}]}], "+", 
        RowBox[{"koff", " ", "kon2", " ", "kp2"}], "+", 
        RowBox[{"kon1", " ", "kp1", " ", "kp2"}]}], ")"}]}]}]]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.77315158967769*^9, 3.773152412230959*^9, 3.7735810260281563`*^9, 
   3.7735816921476192`*^9, 3.773776215051593*^9, 3.773863091385982*^9, {
   3.773863311655512*^9, 3.773863339779293*^9}, 3.7745621689907084`*^9, 
   3.774562215713893*^9, 3.7745627660942464`*^9, 3.7782501251183877`*^9, 
   3.7782510738051805`*^9},
 CellLabel->"Out[33]=",ExpressionUUID->"6c6732f6-a36a-437b-94f1-bbe79ca97c37"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pdRate", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"ssRaw", "[", 
     RowBox[{"[", "3", "]"}], "]"}], " ", "+", " ", 
    RowBox[{"ssRaw", "[", 
     RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7782501336752725`*^9, 3.778250156773085*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"f5106697-5de3-455b-be86-d0bbfb2bb9af"],

Cell[BoxData[
 FractionBox[
  RowBox[{"c", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"c", " ", "kon1", " ", "kon2", " ", 
      RowBox[{"(", 
       RowBox[{"km2", "+", "kp2"}], ")"}]}], "+", 
     RowBox[{"km1", " ", "kon2", " ", 
      RowBox[{"(", 
       RowBox[{"km2", "+", "koff", "+", "kp2"}], ")"}]}], "+", 
     RowBox[{"kon1", " ", "kp1", " ", 
      RowBox[{"(", 
       RowBox[{"km2", "+", "koff", "+", "kp2"}], ")"}]}]}], ")"}]}], 
  RowBox[{
   RowBox[{
    SuperscriptBox["c", "2"], " ", "kon1", " ", "kon2", " ", 
    RowBox[{"(", 
     RowBox[{"km2", "+", "kp2"}], ")"}]}], "+", 
   RowBox[{"km1", " ", 
    RowBox[{"(", 
     RowBox[{"koff", "+", 
      RowBox[{"c", " ", "kon2"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"km2", "+", "koff", "+", "kp2"}], ")"}]}], "+", 
   RowBox[{"koff", " ", "kp1", " ", 
    RowBox[{"(", 
     RowBox[{"km2", "+", "koff", "+", "kp2"}], ")"}]}], "+", 
   RowBox[{"c", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"koff", " ", "kon1", " ", "kp1"}], "+", 
      RowBox[{"km2", " ", "kon1", " ", 
       RowBox[{"(", 
        RowBox[{"koff", "+", "kp1"}], ")"}]}], "+", 
      RowBox[{"koff", " ", "kon2", " ", "kp2"}], "+", 
      RowBox[{"kon1", " ", "kp1", " ", "kp2"}]}], ")"}]}]}]]], "Output",
 CellChangeTimes->{3.778250160060215*^9, 3.778251086770088*^9},
 CellLabel->"Out[34]=",ExpressionUUID->"02569db8-5149-4c57-a705-773939365921"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"drdc", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"pdRate", ",", "c"}], "]"}], " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"c", "\[Rule]", "1"}], ",", 
      RowBox[{"koff", "\[Rule]", " ", ".02"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7782501654393196`*^9, 3.7782502083171797`*^9}, {
   3.7782507305971804`*^9, 3.778250745926126*^9}, {3.7782508075000267`*^9, 
   3.7782508105161877`*^9}, {3.778251081052909*^9, 3.778251081727167*^9}, {
   3.7782513863290977`*^9, 3.778251420803073*^9}, {3.7782514723346977`*^9, 
   3.77825147239851*^9}, 3.778251618656494*^9, {3.7782516750481243`*^9, 
   3.778251675725861*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"1a80eecd-0aee-4e3d-8d5a-9ba89be98083"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"kon1", " ", "kon2", " ", 
     RowBox[{"(", 
      RowBox[{"km2", "+", "kp2"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"0.02`", " ", "kon1", " ", "kp1"}], "+", 
       RowBox[{"km2", " ", "kon1", " ", 
        RowBox[{"(", 
         RowBox[{"0.02`", "\[VeryThinSpace]", "+", "kp1"}], ")"}]}], "+", 
       RowBox[{"0.02`", " ", "kon2", " ", "kp2"}], "+", 
       RowBox[{"kon1", " ", "kp1", " ", "kp2"}], "+", 
       RowBox[{"kon1", " ", "kon2", " ", 
        RowBox[{"(", 
         RowBox[{"km2", "+", "kp2"}], ")"}]}], "+", 
       RowBox[{"km1", " ", 
        RowBox[{"(", 
         RowBox[{"0.02`", "\[VeryThinSpace]", "+", "kon2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"0.02`", "\[VeryThinSpace]", "+", "km2", "+", "kp2"}], 
         ")"}]}], "+", 
       RowBox[{"0.02`", " ", "kp1", " ", 
        RowBox[{"(", 
         RowBox[{"0.02`", "\[VeryThinSpace]", "+", "km2", "+", "kp2"}], 
         ")"}]}]}], ")"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"0.02`", " ", "kon1", " ", "kp1"}], "+", 
       RowBox[{"km2", " ", "kon1", " ", 
        RowBox[{"(", 
         RowBox[{"0.02`", "\[VeryThinSpace]", "+", "kp1"}], ")"}]}], "+", 
       RowBox[{"0.02`", " ", "kon2", " ", "kp2"}], "+", 
       RowBox[{"kon1", " ", "kp1", " ", "kp2"}], "+", 
       RowBox[{"2", " ", "kon1", " ", "kon2", " ", 
        RowBox[{"(", 
         RowBox[{"km2", "+", "kp2"}], ")"}]}], "+", 
       RowBox[{"km1", " ", "kon2", " ", 
        RowBox[{"(", 
         RowBox[{"0.02`", "\[VeryThinSpace]", "+", "km2", "+", "kp2"}], 
         ")"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"km1", " ", "kon2", " ", 
        RowBox[{"(", 
         RowBox[{"0.02`", "\[VeryThinSpace]", "+", "km2", "+", "kp2"}], 
         ")"}]}], "+", 
       RowBox[{"kon1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"0.02`", " ", "kp1"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"kon2", "+", "kp1"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"km2", "+", "kp2"}], ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"0.02`", " ", "kon1", " ", "kp1"}], "+", 
       RowBox[{"km2", " ", "kon1", " ", 
        RowBox[{"(", 
         RowBox[{"0.02`", "\[VeryThinSpace]", "+", "kp1"}], ")"}]}], "+", 
       RowBox[{"0.02`", " ", "kon2", " ", "kp2"}], "+", 
       RowBox[{"kon1", " ", "kp1", " ", "kp2"}], "+", 
       RowBox[{"kon1", " ", "kon2", " ", 
        RowBox[{"(", 
         RowBox[{"km2", "+", "kp2"}], ")"}]}], "+", 
       RowBox[{"km1", " ", 
        RowBox[{"(", 
         RowBox[{"0.02`", "\[VeryThinSpace]", "+", "kon2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"0.02`", "\[VeryThinSpace]", "+", "km2", "+", "kp2"}], 
         ")"}]}], "+", 
       RowBox[{"0.02`", " ", "kp1", " ", 
        RowBox[{"(", 
         RowBox[{"0.02`", "\[VeryThinSpace]", "+", "km2", "+", "kp2"}], 
         ")"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"km1", " ", "kon2", " ", 
        RowBox[{"(", 
         RowBox[{"0.02`", "\[VeryThinSpace]", "+", "km2", "+", "kp2"}], 
         ")"}]}], "+", 
       RowBox[{"kon1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"0.02`", " ", "kp1"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"kon2", "+", "kp1"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"km2", "+", "kp2"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
   ")"}], "/", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"0.02`", " ", "kon1", " ", "kp1"}], "+", 
     RowBox[{"km2", " ", "kon1", " ", 
      RowBox[{"(", 
       RowBox[{"0.02`", "\[VeryThinSpace]", "+", "kp1"}], ")"}]}], "+", 
     RowBox[{"0.02`", " ", "kon2", " ", "kp2"}], "+", 
     RowBox[{"kon1", " ", "kp1", " ", "kp2"}], "+", 
     RowBox[{"kon1", " ", "kon2", " ", 
      RowBox[{"(", 
       RowBox[{"km2", "+", "kp2"}], ")"}]}], "+", 
     RowBox[{"km1", " ", 
      RowBox[{"(", 
       RowBox[{"0.02`", "\[VeryThinSpace]", "+", "kon2"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"0.02`", "\[VeryThinSpace]", "+", "km2", "+", "kp2"}], ")"}]}],
      "+", 
     RowBox[{"0.02`", " ", "kp1", " ", 
      RowBox[{"(", 
       RowBox[{"0.02`", "\[VeryThinSpace]", "+", "km2", "+", "kp2"}], 
       ")"}]}]}], ")"}], "2"]}]], "Output",
 CellChangeTimes->{
  3.778250211168558*^9, {3.778250740077536*^9, 3.778250747277026*^9}, 
   3.7782508129531703`*^9, 3.7782510918504715`*^9, 3.7782514228093324`*^9, 
   3.7782514748730817`*^9, 3.778251620758978*^9, 3.778251677597991*^9},
 CellLabel->"Out[57]=",ExpressionUUID->"d5e9d8fd-e0c8-4d49-954a-ca0a4e03e3a3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"drdcMax", " ", "=", " ", 
  RowBox[{"NMaximize", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"drdc", ",", "ass"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "kon1", ",", "kon2", ",", "km1", ",", "km2", ",", "kp1", ",", "kp2"}], 
     "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.778250219286409*^9, 3.778250233281192*^9}, {
   3.778250351614377*^9, 3.7782503712098465`*^9}, {3.778250753771204*^9, 
   3.7782507547653074`*^9}, {3.778250820946154*^9, 3.7782508255152645`*^9}, {
   3.778251119865145*^9, 3.7782511239521537`*^9}, 3.7782514317871685`*^9},
 CellLabel->"In[55]:=",ExpressionUUID->"47ead048-dc61-4943-b75f-9e198e9154fe"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.4261642601487131`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"kon1", "\[Rule]", "16.27568863112629`"}], ",", 
     RowBox[{"kon2", "\[Rule]", "0.10997063825027298`"}], ",", 
     RowBox[{"km1", "\[Rule]", "0.9999998522460082`"}], ",", 
     RowBox[{"km2", "\[Rule]", "0.001000000507541736`"}], ",", 
     RowBox[{"kp1", "\[Rule]", "0.010000000284517007`"}], ",", 
     RowBox[{"kp2", "\[Rule]", "0.9999999206042327`"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.7782503730658317`*^9, {3.778250435193125*^9, 3.778250463037415*^9}, 
   3.778250755668151*^9, 3.7782508281192803`*^9, 3.7782509953063407`*^9, 
   3.7782511266201563`*^9, 3.7782511879119716`*^9, 3.7782512698750505`*^9, 
   3.7782513056969824`*^9, {3.7782513466149235`*^9, 3.7782513693260837`*^9}, 
   3.7782514781429663`*^9, 3.778251633282962*^9},
 CellLabel->"Out[55]=",ExpressionUUID->"f642e9e8-873c-4e81-bdbd-91a3e010409c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"drdcSimp", " ", "=", " ", 
  RowBox[{"drdc", " ", "\[Rule]", " "}]}]], "Input",
 CellChangeTimes->{{3.7782508580802894`*^9, 3.778250927933345*^9}, {
  3.778251530999118*^9, 
  3.7782515372199044`*^9}},ExpressionUUID->"847bbcf6-7958-4a9c-b2ca-\
0e1d4813239d"],

Cell[BoxData["0.11882040598151568`"], "Output",
 CellChangeTimes->{3.7782509284992776`*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"19aa6ef6-32d5-4de5-b8fb-9ba22a96fd53"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{"1", "/", "60"}], "]"}]], "Input",
 CellChangeTimes->{{3.778251414415039*^9, 3.778251416826234*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"09e12621-16a7-4787-8be1-6d03ba74674b"],

Cell[BoxData["0.016666666666666666`"], "Output",
 CellChangeTimes->{3.7782514174602404`*^9},
 CellLabel->"Out[48]=",ExpressionUUID->"a9b86fa9-f79c-4578-b941-4d531ea78cc0"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1920, 1037},
WindowMargins->{{1912, Automatic}, {Automatic, -8}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 422, 7, 87, "Section",ExpressionUUID->"0cd71903-4765-4253-86c7-583733eb7283"],
Cell[CellGroupData[{
Cell[1005, 31, 175, 3, 56, "Chapter",ExpressionUUID->"82f7376a-6e3e-4b94-9f2e-252776723a79"],
Cell[1183, 36, 1161, 23, 28, "Input",ExpressionUUID->"5c21804e-453c-4bbc-8632-a70479881d8c"],
Cell[2347, 61, 559, 11, 100, "Text",ExpressionUUID->"6b13bc3f-4c6e-4147-9cf7-c3160c4d4056"],
Cell[2909, 74, 222, 3, 28, "Input",ExpressionUUID->"f53ddaf6-0803-4542-a92f-8240a1d82c27"],
Cell[3134, 79, 2379, 47, 86, "Input",ExpressionUUID->"9c208344-b914-4a91-af3b-57aa27d1e452"],
Cell[CellGroupData[{
Cell[5538, 130, 339, 6, 28, "Input",ExpressionUUID->"c1da6231-a226-4878-886a-1ae8cbefdc95"],
Cell[5880, 138, 1494, 40, 153, "Output",ExpressionUUID->"e62636af-ca39-4af5-9527-a48ae7666fcf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7411, 183, 211, 3, 28, "Input",ExpressionUUID->"9d11d41e-d080-4fd8-bb84-4e0b16a6a224"],
Cell[7625, 188, 265, 5, 32, "Output",ExpressionUUID->"fee9e079-7874-492d-9e39-c1f9b5849462"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[7939, 199, 169, 3, 67, "Chapter",ExpressionUUID->"ef5b6b1a-1ae2-4e6c-ad75-0d1453def836"],
Cell[8111, 204, 427, 7, 28, "Input",ExpressionUUID->"5d25927e-1ef7-47f6-a1dc-8569ff8b995e"],
Cell[CellGroupData[{
Cell[8563, 215, 549, 12, 28, "Input",ExpressionUUID->"1b51bc59-d5a1-412b-9f72-d20ee10c2b54"],
Cell[9115, 229, 5072, 138, 214, "Output",ExpressionUUID->"6c6732f6-a36a-437b-94f1-bbe79ca97c37"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14224, 372, 404, 9, 28, "Input",ExpressionUUID->"f5106697-5de3-455b-be86-d0bbfb2bb9af"],
Cell[14631, 383, 1412, 38, 61, "Output",ExpressionUUID->"02569db8-5149-4c57-a705-773939365921"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16080, 426, 802, 16, 28, "Input",ExpressionUUID->"1a80eecd-0aee-4e3d-8d5a-9ba89be98083"],
Cell[16885, 444, 4777, 123, 92, "Output",ExpressionUUID->"d5e9d8fd-e0c8-4d49-954a-ca0a4e03e3a3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21699, 572, 671, 14, 28, "Input",ExpressionUUID->"47ead048-dc61-4943-b75f-9e198e9154fe"],
Cell[22373, 588, 951, 18, 32, "Output",ExpressionUUID->"f642e9e8-873c-4e81-bdbd-91a3e010409c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23361, 611, 282, 6, 28, "Input",ExpressionUUID->"847bbcf6-7958-4a9c-b2ca-0e1d4813239d"],
Cell[23646, 619, 170, 2, 32, "Output",ExpressionUUID->"19aa6ef6-32d5-4de5-b8fb-9ba22a96fd53"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23853, 626, 223, 4, 28, "Input",ExpressionUUID->"09e12621-16a7-4787-8be1-6d03ba74674b"],
Cell[24079, 632, 171, 2, 32, "Output",ExpressionUUID->"a9b86fa9-f79c-4578-b941-4d531ea78cc0"]
}, Open  ]]
}, Open  ]]
}
]
*)

