(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     48003,       1254]
NotebookOptionsPosition[     41728,       1153]
NotebookOutlinePosition[     42132,       1169]
CellTagsIndexPosition[     42089,       1166]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[StyleBox["Sharpness calculations", "Chapter"]], "Section",
 CellChangeTimes->{{3.766585934056647*^9, 3.766585974405374*^9}, {
  3.7903540634633904`*^9, 3.7903540872564287`*^9}, {3.7998463249019165`*^9, 
  3.7998463255144157`*^9}, {3.8091131168504567`*^9, 
  3.8091131220587234`*^9}},ExpressionUUID->"53bbe826-6243-4623-bfbc-\
1fc0a6d7cf3d"],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.7665860727694225`*^9, 3.7665860727953434`*^9}, 
   3.790350446024684*^9, 3.790353136444847*^9},
 CellLabel->
  "In[256]:=",ExpressionUUID->"09a89208-e8c8-4a30-a36f-b4bd2445d91a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Q", " ", "=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "k21"}], "-", "k41"}], ",", "                  ", "k12",
         ",", "                 ", "0", ",", "                         ", 
        "k14"}], "}"}], ",", "\[IndentingNewLine]", "     ", 
      RowBox[{"{", 
       RowBox[{"k21", "                          ", ",", 
        RowBox[{
         RowBox[{"-", "k32"}], "-", "k12"}], ",", "         ", "k23", ",", 
        "                          ", "0"}], "}"}], ",", 
      "\[IndentingNewLine]", "     ", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "                                   ", "k32", ",", 
        "             ", 
        RowBox[{
         RowBox[{"-", "k43"}], "-", "k23"}], ",", "             ", "k34"}], 
       "}"}], ",", "\[IndentingNewLine]", "     ", 
      RowBox[{"{", 
       RowBox[{
       "k41", ",", "                          ", "0", ",", 
        "                         ", "k43", ",", "          ", 
        RowBox[{
         RowBox[{"-", "k34"}], "-", "k14"}]}], "}"}]}], "}"}], "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"k21", "\[Rule]", 
       RowBox[{"c", "*", "k21"}]}], ",", 
      RowBox[{"k34", "\[Rule]", 
       RowBox[{"c", "*", "k34"}]}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.789583824008664*^9, 3.789583828946269*^9}, {
   3.7907836403413167`*^9, 3.7907836618887463`*^9}, {3.796939511091936*^9, 
   3.7969395285218353`*^9}, {3.796939604518115*^9, 3.796939609106264*^9}, 
   3.797700003956501*^9, {3.8091335510262957`*^9, 3.809133551386372*^9}, {
   3.8193725879023004`*^9, 3.819372590109606*^9}, {3.819372715738633*^9, 
   3.819372717557702*^9}, {3.819647556039254*^9, 3.819647562293643*^9}, {
   3.8196475968355722`*^9, 3.8196476255645313`*^9}, {3.822678388472686*^9, 
   3.8226784186178126`*^9}, 3.8226785875311604`*^9},
 CellLabel->
  "In[257]:=",ExpressionUUID->"689ad0c0-dea0-4cad-8a2d-060acfc140d0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "Q", "]"}]], "Input",
 CellChangeTimes->{{3.789583830469346*^9, 3.7895838337843866`*^9}, 
   3.796939497680771*^9},
 CellLabel->
  "In[258]:=",ExpressionUUID->"628a347c-779f-4fe0-b274-94b8b6d49941"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "c"}], " ", "k21"}], "-", "k41"}], "k12", "0", "k14"},
     {
      RowBox[{"c", " ", "k21"}], 
      RowBox[{
       RowBox[{"-", "k12"}], "-", "k32"}], "k23", "0"},
     {"0", "k32", 
      RowBox[{
       RowBox[{"-", "k23"}], "-", "k43"}], 
      RowBox[{"c", " ", "k34"}]},
     {"k41", "0", "k43", 
      RowBox[{
       RowBox[{"-", "k14"}], "-", 
       RowBox[{"c", " ", "k34"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.790783454623201*^9, 3.7907836644558144`*^9, {3.7907846129483705`*^9, 
   3.790784624694351*^9}, 3.7907846735886397`*^9, 3.790784904084306*^9, 
   3.7907878364854527`*^9, 3.7907879646963544`*^9, 3.7910406107351117`*^9, 
   3.791040721219733*^9, 3.791041507737971*^9, {3.7910418340692997`*^9, 
   3.7910418403291364`*^9}, 3.791041954561898*^9, 3.7969395580836363`*^9, 
   3.796939612938048*^9, 3.7976788006335015`*^9, 3.797690715464012*^9, 
   3.7976917480128174`*^9, 3.797691797903495*^9, 3.7976922746192365`*^9, 
   3.7977248147217193`*^9, 3.8014281563617477`*^9, 3.8014285063202395`*^9, 
   3.801428556193905*^9, 3.8045207749893975`*^9, 3.8047906924337406`*^9, 
   3.808854727873333*^9, 3.808855210510989*^9, 3.808855647164612*^9, 
   3.809128954573065*^9, 3.809130438679103*^9, 3.809130487008586*^9, 
   3.80913325763646*^9, 3.8091334472429743`*^9, 3.8091335962534637`*^9, 
   3.8091408971072874`*^9, 3.809192696923826*^9, 3.8091950184327726`*^9, 
   3.8091987284198303`*^9, 3.8091998495739636`*^9, 3.8092001150059977`*^9, 
   3.8105797756380544`*^9, 3.8105799687239456`*^9, 3.810580030918251*^9, 
   3.810580182958108*^9, 3.8106503414716935`*^9, 3.81065735008912*^9, 
   3.810993172734497*^9, 3.8112565505764785`*^9, 3.8129096474236*^9, 
   3.8193716713819456`*^9, {3.819372720647094*^9, 3.819372730340797*^9}, 
   3.819647644399002*^9, 3.8196478210003624`*^9, {3.8226785808362937`*^9, 
   3.822678594324293*^9}, {3.8227019414597178`*^9, 3.822701962253346*^9}, 
   3.8227020244008617`*^9, 3.822703014157816*^9, 3.8227037164354143`*^9, 
   3.8227046231456347`*^9},
 CellLabel->
  "Out[258]//MatrixForm=",ExpressionUUID->"de638731-f671-4261-b15a-\
9827c10a2ebf"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7910419372696214`*^9, 3.7910419438610525`*^9}},
 CellLabel->
  "In[259]:=",ExpressionUUID->"64bb8e01-35f2-4ab7-897b-2d302dfdfe44"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", "Q", "]"}]], "Input",
 CellChangeTimes->{{3.7895838717169123`*^9, 3.7895838741134496`*^9}, 
   3.796939497685714*^9},
 CellLabel->
  "In[260]:=",ExpressionUUID->"1c70661a-586e-4afd-bbfa-0af317b7b526"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.796939558158435*^9, 3.796939613002929*^9, 3.7976788007132883`*^9, 
   3.797690715547144*^9, 3.7976917481068816`*^9, 3.79769179799518*^9, 
   3.797692274720248*^9, 3.797724814802478*^9, 3.8014281564066668`*^9, 
   3.8014285063674064`*^9, 3.801428556262684*^9, 3.8045207750706997`*^9, 
   3.804790692494579*^9, 3.8088547279281535`*^9, 3.8088552105637836`*^9, 
   3.8088556472294703`*^9, 3.809128954642111*^9, 3.809130438748903*^9, 
   3.8091304870783997`*^9, 3.8091332577012863`*^9, 3.8091334473097954`*^9, 
   3.8091335963232765`*^9, 3.8091408972112503`*^9, 3.8091926970106936`*^9, 
   3.809195018523715*^9, 3.809198728518325*^9, 3.8091998496693306`*^9, 
   3.8092001150907383`*^9, 3.8105797757863245`*^9, 3.810579968846472*^9, 
   3.810580031047311*^9, 3.81058018308068*^9, 3.8106503415904136`*^9, 
   3.810657350179817*^9, 3.810993172775345*^9, 3.81125655065912*^9, 
   3.8129096474749174`*^9, 3.8193716714519286`*^9, 3.8193727303896303`*^9, 
   3.8196476444970455`*^9, 3.8196478210941067`*^9, {3.8226785808909245`*^9, 
   3.822678594382753*^9}, {3.8227019415786943`*^9, 3.822701962344297*^9}, 
   3.822702024508953*^9, 3.822703014251229*^9, 3.822703716524522*^9, 
   3.822704623240961*^9},
 CellLabel->
  "Out[260]=",ExpressionUUID->"80e89b12-ed90-4187-8375-e1f14586e842"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"eigVectors4", " ", "=", " ", 
   RowBox[{"Eigenvectors", "[", "Q", " ", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.7895828931904736`*^9, {3.7895838893159084`*^9, 3.7895838909643126`*^9}, {
   3.790784603464886*^9, 3.790784621901783*^9}, 3.7910407181927743`*^9, {
   3.791041829293586*^9, 3.7910418384017344`*^9}, {3.791041950940197*^9, 
   3.7910419523067074`*^9}, 3.796939497696683*^9, 3.8091332389777956`*^9, 
   3.8091335483743877`*^9, 3.8226784450826864`*^9},
 CellLabel->
  "In[261]:=",ExpressionUUID->"35c06f23-f104-453a-927e-9756152eb189"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ssVec", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"eigVectors4", "[", 
      RowBox[{"[", "1", "]"}], "]"}], " ", "/", " ", 
     RowBox[{"Total", "[", 
      RowBox[{"eigVectors4", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7895828991696534`*^9, 3.789582907509968*^9}, {
   3.789583894558428*^9, 3.7895839033497224`*^9}, 3.810579997246051*^9},
 CellLabel->
  "In[262]:=",ExpressionUUID->"dc484be2-c9eb-40bd-ac5d-56e1c63e48d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ssVecRight", " ", "=", " ", 
   RowBox[{"ssVec", "/.", " ", 
    RowBox[{"{", 
     RowBox[{"c", "\[Rule]", "cr"}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.822678411283947*^9, 3.822678468103264*^9}},
 CellLabel->
  "In[263]:=",ExpressionUUID->"146fe221-9cbd-4c5a-9d81-52fc72624518"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ssVecWrong", "=", " ", 
   RowBox[{"ssVec", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"c", "\[Rule]", "cw"}], ",", 
      RowBox[{"k43", "\[Rule]", 
       RowBox[{"B", "*", "k43"}]}], ",", 
      RowBox[{"k12", "\[Rule]", 
       RowBox[{"B", "*", "k12"}]}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8226784746502123`*^9, 3.8226785035679927`*^9}},
 CellLabel->
  "In[264]:=",ExpressionUUID->"80d9bb67-42bd-4674-ab61-63a1f859ea9a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"pdRateRight", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"ssVecRight", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "+", " ", 
      RowBox[{"ssVecRight", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], ";"}], " "}]], "Input",
 CellChangeTimes->{{3.797690670594017*^9, 3.797690691455095*^9}, {
   3.8088545907183447`*^9, 3.8088545932226477`*^9}, 3.8088552028235254`*^9, 
   3.8088556314875393`*^9, {3.809113040706851*^9, 3.809113067755361*^9}, {
   3.8091332318189287`*^9, 3.8091332519377007`*^9}, {3.8091999717572827`*^9, 
   3.80919997417655*^9}, {3.8105796219840527`*^9, 3.81057962550924*^9}, {
   3.8105799965062914`*^9, 3.8105800105983925`*^9}, {3.8112565577120523`*^9, 
   3.81125658997678*^9}, {3.82267850948637*^9, 3.822678525523321*^9}},
 CellLabel->
  "In[265]:=",ExpressionUUID->"e0b90688-52d0-4126-80a5-8f6b8cbefb2d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"pdRateWrong", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"ssVecWrong", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "+", " ", 
      RowBox[{"ssVecWrong", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], ";"}], " "}]], "Input",
 CellChangeTimes->{{3.8091130768075113`*^9, 3.8091131074101496`*^9}, {
  3.8226785301981583`*^9, 3.822678540000557*^9}},
 CellLabel->
  "In[266]:=",ExpressionUUID->"2835703c-faa1-4479-ab2c-423a6b5520f9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fidelity", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"pdRateRight", "/", "pdRateWrong"}], " ", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"k41", "\[Rule]", "0"}], ",", 
      RowBox[{"k23", "\[Rule]", "0"}], ",", 
      RowBox[{"cr", "\[Rule]", "1"}], ",", 
      RowBox[{"cw", "\[Rule]", "1"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.822678544254896*^9, 3.8226785608622904`*^9}, {
  3.822678618829984*^9, 3.82267865466009*^9}},
 CellLabel->
  "In[267]:=",ExpressionUUID->"4fc6fbb5-3cd7-40d9-90b8-e651e3c2fd83"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"k14", "+", "k34", "+", "k43"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"k14", " ", "k21", " ", "k32"}], "+", 
     RowBox[{"B", " ", "k14", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"B", " ", "k12"}], "+", "k21", "+", "k32"}], ")"}], " ", 
      "k43"}], "+", 
     RowBox[{"k21", " ", "k32", " ", 
      RowBox[{"(", 
       RowBox[{"k34", "+", 
        RowBox[{"B", " ", "k43"}]}], ")"}]}]}], ")"}]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"k14", "+", "k34", "+", 
     RowBox[{"B", " ", "k43"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"k14", " ", "k21", " ", "k32"}], "+", 
     RowBox[{"k14", " ", 
      RowBox[{"(", 
       RowBox[{"k12", "+", "k21", "+", "k32"}], ")"}], " ", "k43"}], "+", 
     RowBox[{"k21", " ", "k32", " ", 
      RowBox[{"(", 
       RowBox[{"k34", "+", "k43"}], ")"}]}]}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.8226785812716823`*^9, 3.822678596199689*^9}, {
   3.8226786428048973`*^9, 3.8226786555596256`*^9}, {3.822701941829232*^9, 
   3.8227019625280895`*^9}, 3.8227020246820555`*^9, 3.8227030144325576`*^9, 
   3.8227037167055483`*^9, 3.8227046237020845`*^9},
 CellLabel->
  "Out[267]=",ExpressionUUID->"e0b559db-676e-4719-9a08-a08f539cf2a6"]
}, Open  ]],

Cell[TextData[StyleBox["Solve for passage times from OFF to ON and vice \
versa", "Section"]], "Subsection",
 CellChangeTimes->{{3.8047906449419923`*^9, 3.8047906500752687`*^9}, {
  3.8091331541609793`*^9, 3.8091331659465027`*^9}, {3.8109931917027617`*^9, 
  3.8109931950192366`*^9}},ExpressionUUID->"1857f6e4-9744-4305-a9bc-\
09a799a37bf0"],

Cell[CellGroupData[{

Cell["Solve for cycle flux ", "Subsection",
 CellChangeTimes->{{3.8091916521984525`*^9, 
  3.809191655988432*^9}},ExpressionUUID->"2e29538f-066a-41c3-867a-\
a5fe9cded690"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Z", " ", "=", " ", 
   RowBox[{"Denominator", "[", "pdRate", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.801509890307944*^9, 3.801509895087841*^9}, 
   3.809191808135372*^9},
 CellLabel->
  "In[268]:=",ExpressionUUID->"0c1b0679-5c2d-432c-afb1-0dee381d6c61"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Jp", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Q", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], "*", 
      RowBox[{"Q", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "3"}], "]"}], "]"}], "*", 
      RowBox[{"Q", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "4"}], "]"}], "]"}], "*", 
      RowBox[{"Q", "[", 
       RowBox[{"[", 
        RowBox[{"4", ",", "1"}], "]"}], "]"}]}], ")"}], " ", "/", " ", 
    "Z"}]}], " ", ";"}]], "Input",
 CellChangeTimes->{{3.8015096726403036`*^9, 3.8015097177615533`*^9}, {
   3.8015099001622086`*^9, 3.8015099130552564`*^9}, {3.8046100063795385`*^9, 
   3.804610024590043*^9}, 3.80919180091991*^9},
 CellLabel->
  "In[269]:=",ExpressionUUID->"d11b5662-d0ed-46b8-a00c-b0c0ad7f00af"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Jm", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Q", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", 
      RowBox[{"Q", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "2"}], "]"}], "]"}], "*", 
      RowBox[{"Q", "[", 
       RowBox[{"[", 
        RowBox[{"4", ",", "3"}], "]"}], "]"}], "*", 
      RowBox[{"Q", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "4"}], "]"}], "]"}]}], ")"}], " ", "/", " ", 
    "Z"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8015099368955555`*^9, 3.8015099593324957`*^9}, {
   3.8046100357010403`*^9, 3.8046100373442383`*^9}, 3.8046101054635334`*^9, 
   3.809191797918765*^9},
 CellLabel->
  "In[270]:=",ExpressionUUID->"66cba8b4-c235-4fdd-8095-8dfb585a624e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solve for passage times from each state to state 3 and to 1", \
"Subsection",
 CellChangeTimes->{{3.7903526391845846`*^9, 3.790352662086899*^9}, 
   3.797690739110916*^9, {3.79769083324965*^9, 3.7976908365295715`*^9}, {
   3.7976914066112113`*^9, 3.7976914295131283`*^9}, {3.82270177134517*^9, 
   3.822701776104531*^9}},ExpressionUUID->"07641087-c288-45b3-8bb5-\
72051831865a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqET13", " ", "=", " ", 
   RowBox[{"ET13", " ", "\[Equal]", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "/", 
      RowBox[{"Q", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "*", 
     RowBox[{"(", 
      RowBox[{"1", " ", "+", 
       RowBox[{
        RowBox[{"Q", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", "ET23"}], "+", 
       RowBox[{
        RowBox[{"Q", "[", 
         RowBox[{"[", 
          RowBox[{"4", ",", "1"}], "]"}], "]"}], "*", "ET43"}]}], ")"}]}]}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.801428356495663*^9, 3.8014283565904093`*^9}, {
  3.801428400075701*^9, 3.8014284222769413`*^9}, {3.801428551443768*^9, 
  3.801428551514817*^9}},
 CellLabel->
  "In[271]:=",ExpressionUUID->"ad75c6bb-278f-4c1c-af21-ea1ba8c7dabc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqET23", " ", "=", " ", 
   RowBox[{"ET23", " ", "\[Equal]", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "/", 
      RowBox[{"Q", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "*", 
     RowBox[{"(", 
      RowBox[{"1", " ", "+", 
       RowBox[{
        RowBox[{"Q", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}], "*", "ET13"}]}], ")"}]}]}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.7903526643834977`*^9, 3.790352741300044*^9}, {
  3.790352771329322*^9, 3.7903527888450565`*^9}, {3.796939497707224*^9, 
  3.796939497709179*^9}, {3.797691309545168*^9, 3.797691321798501*^9}, {
  3.797691437136017*^9, 3.797691447559453*^9}, {3.7976914892740564`*^9, 
  3.7976915419262304`*^9}},
 CellLabel->
  "In[272]:=",ExpressionUUID->"65cb6fa2-8da9-4223-bcfb-46d7d6cc66c5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqET43", " ", "=", " ", 
   RowBox[{"ET43", " ", "\[Equal]", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "/", 
      RowBox[{"Q", "[", 
       RowBox[{"[", 
        RowBox[{"4", ",", "4"}], "]"}], "]"}]}], "*", 
     RowBox[{"(", 
      RowBox[{"1", " ", "+", 
       RowBox[{
        RowBox[{"Q", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "4"}], "]"}], "]"}], "*", "ET13"}]}], ")"}]}]}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.790352851392705*^9, 3.7903528757889843`*^9}, {
  3.7903529225947437`*^9, 3.7903529244056287`*^9}, {3.7969394977281294`*^9, 
  3.7969394977311206`*^9}, {3.7976913162981515`*^9, 3.7976913182701054`*^9}, {
  3.7976914434307604`*^9, 3.7976914605106106`*^9}, {3.7976915910087166`*^9, 
  3.79769160542087*^9}},
 CellLabel->
  "In[273]:=",ExpressionUUID->"da902cba-5ff6-4a05-ab39-1950538f23bd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"solET3", "=", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eqET13", ",", "eqET23", ",", "eqET43"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ET13", ",", "ET23", ",", "ET43"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7903529264441776`*^9, 3.790352990329671*^9}, {
  3.7976913245941415`*^9, 3.7976913473961935`*^9}, {3.7976916088732195`*^9, 
  3.7976916354203444`*^9}},
 CellLabel->
  "In[274]:=",ExpressionUUID->"d9a73969-6130-4e0a-b5a4-20ebb6e8caf1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ET13val", " ", "=", " ", 
   RowBox[{"ET13", "/.", " ", 
    RowBox[{"solET3", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.79035299222773*^9, 3.790353020683205*^9}, {
  3.790353081143454*^9, 3.790353081252901*^9}, {3.7910419002629423`*^9, 
  3.791041903281906*^9}, {3.797691333540784*^9, 3.797691350632238*^9}, {
  3.797691642142706*^9, 3.7976916547308893`*^9}},
 CellLabel->
  "In[275]:=",ExpressionUUID->"ff3541fa-7743-4824-ab57-61504512d080"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ET23val", " ", "=", " ", 
    RowBox[{"ET23", " ", "/.", " ", 
     RowBox[{"solET3", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], " "}]], "Input",
 CellChangeTimes->{{3.7903530071243153`*^9, 3.790353015443198*^9}, {
  3.7903530851614685`*^9, 3.7903530891093345`*^9}, {3.7976913424061184`*^9, 
  3.797691348988271*^9}, {3.797691659247689*^9, 3.797691663012975*^9}},
 CellLabel->
  "In[276]:=",ExpressionUUID->"121ed990-6070-42ab-b1ff-cdc4f4ef9821"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ET43val", " ", "=", " ", 
    RowBox[{"ET43", " ", "/.", " ", 
     RowBox[{"solET3", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], " "}]], "Input",
 CellChangeTimes->{{3.790353093594185*^9, 3.7903530978210783`*^9}, {
  3.7976913519525394`*^9, 3.7976913582796955`*^9}, {3.797691667279225*^9, 
  3.7976916842703695`*^9}},
 CellLabel->
  "In[277]:=",ExpressionUUID->"479caca0-0e28-4e44-a46f-761b7f8359bf"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.790353213233472*^9, 3.790353231085146*^9}, 
   3.7976910121040497`*^9, {3.7976916876609597`*^9, 3.7976916877386904`*^9}, {
   3.7976917788882165`*^9, 3.797691790446406*^9}, 3.8014283102558537`*^9, 
   3.8014293298041816`*^9, 3.8227029767269936`*^9},
 CellLabel->
  "In[278]:=",ExpressionUUID->"c656b426-ffa4-4f0d-a88b-57c071d971f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqET31", " ", "=", " ", 
   RowBox[{"ET31", " ", "\[Equal]", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "/", 
      RowBox[{"Q", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "*", 
     RowBox[{"(", 
      RowBox[{"1", " ", "+", 
       RowBox[{
        RowBox[{"Q", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "3"}], "]"}], "]"}], "*", "ET21"}], "+", 
       RowBox[{
        RowBox[{"Q", "[", 
         RowBox[{"[", 
          RowBox[{"4", ",", "3"}], "]"}], "]"}], "*", "ET41"}]}], ")"}]}]}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.801428356495663*^9, 3.8014283565904093`*^9}, {
  3.801428400075701*^9, 3.8014284222769413`*^9}, {3.801428551443768*^9, 
  3.801428551514817*^9}, {3.822701789227475*^9, 3.8227018319411907`*^9}},
 CellLabel->
  "In[279]:=",ExpressionUUID->"a445ef80-279a-4fbf-af09-eadd3c2da049"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqET21", " ", "=", " ", 
   RowBox[{"ET21", " ", "\[Equal]", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "/", 
      RowBox[{"Q", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "*", 
     RowBox[{"(", 
      RowBox[{"1", " ", "+", 
       RowBox[{
        RowBox[{"Q", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "2"}], "]"}], "]"}], "*", "ET31"}]}], ")"}]}]}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.7903526643834977`*^9, 3.790352741300044*^9}, {
  3.790352771329322*^9, 3.7903527888450565`*^9}, {3.796939497707224*^9, 
  3.796939497709179*^9}, {3.797691309545168*^9, 3.797691321798501*^9}, {
  3.797691437136017*^9, 3.797691447559453*^9}, {3.7976914892740564`*^9, 
  3.7976915419262304`*^9}, {3.8227018368967524`*^9, 3.822701857852874*^9}, {
  3.822702015791298*^9, 3.8227020158561506`*^9}},
 CellLabel->
  "In[280]:=",ExpressionUUID->"96e82d21-4239-43bf-b8c9-4e97e6e49e4a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqET41", " ", "=", " ", 
   RowBox[{"ET41", " ", "\[Equal]", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "/", 
      RowBox[{"Q", "[", 
       RowBox[{"[", 
        RowBox[{"4", ",", "4"}], "]"}], "]"}]}], "*", 
     RowBox[{"(", 
      RowBox[{"1", " ", "+", 
       RowBox[{
        RowBox[{"Q", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "4"}], "]"}], "]"}], "*", "ET31"}]}], ")"}]}]}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.790352851392705*^9, 3.7903528757889843`*^9}, {
  3.7903529225947437`*^9, 3.7903529244056287`*^9}, {3.7969394977281294`*^9, 
  3.7969394977311206`*^9}, {3.7976913162981515`*^9, 3.7976913182701054`*^9}, {
  3.7976914434307604`*^9, 3.7976914605106106`*^9}, {3.7976915910087166`*^9, 
  3.79769160542087*^9}, {3.82270186114487*^9, 3.8227018689941444`*^9}, {
  3.822701958132086*^9, 3.8227019582222624`*^9}, {3.822702019192134*^9, 
  3.822702019295506*^9}, {3.822703009338476*^9, 3.822703009414544*^9}},
 CellLabel->
  "In[281]:=",ExpressionUUID->"de953c59-c272-4477-8846-171029f432ec"],

Cell[BoxData[
 RowBox[{
  RowBox[{"solET1", "=", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eqET31", ",", "eqET21", ",", "eqET41"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ET31", ",", "ET21", ",", "ET41"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7903529264441776`*^9, 3.790352990329671*^9}, {
   3.7976913245941415`*^9, 3.7976913473961935`*^9}, {3.7976916088732195`*^9, 
   3.7976916354203444`*^9}, {3.822701881336494*^9, 3.8227018989507437`*^9}, 
   3.8227019862270555`*^9, 3.822702029018304*^9},
 CellLabel->
  "In[282]:=",ExpressionUUID->"33c241de-b644-402b-afc5-3c3575285838"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ET31val", " ", "=", " ", 
   RowBox[{"ET31", "/.", " ", 
    RowBox[{"solET1", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.79035299222773*^9, 3.790353020683205*^9}, {
  3.790353081143454*^9, 3.790353081252901*^9}, {3.7910419002629423`*^9, 
  3.791041903281906*^9}, {3.797691333540784*^9, 3.797691350632238*^9}, {
  3.797691642142706*^9, 3.7976916547308893`*^9}, {3.822701902336851*^9, 
  3.822701906436413*^9}},
 CellLabel->
  "In[283]:=",ExpressionUUID->"7d09bd07-2e3f-4f7e-b4fa-33b46f115a11"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ET21val", " ", "=", " ", 
    RowBox[{"ET21", " ", "/.", " ", 
     RowBox[{"solET1", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], " "}]], "Input",
 CellChangeTimes->{{3.7903530071243153`*^9, 3.790353015443198*^9}, {
  3.7903530851614685`*^9, 3.7903530891093345`*^9}, {3.7976913424061184`*^9, 
  3.797691348988271*^9}, {3.797691659247689*^9, 3.797691663012975*^9}, {
  3.8227019094203014`*^9, 3.822701913582596*^9}},
 CellLabel->
  "In[284]:=",ExpressionUUID->"16590ecd-c20e-41ea-8613-9ef2c4f645c4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ET41val", " ", "=", " ", 
    RowBox[{"ET41", " ", "/.", " ", 
     RowBox[{"solET1", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], " "}]], "Input",
 CellChangeTimes->{{3.790353093594185*^9, 3.7903530978210783`*^9}, {
  3.7976913519525394`*^9, 3.7976913582796955`*^9}, {3.797691667279225*^9, 
  3.7976916842703695`*^9}, {3.8227019157454205`*^9, 3.8227019197268343`*^9}},
 CellLabel->
  "In[285]:=",ExpressionUUID->"f386ce44-b5d7-4781-bacc-d0964b778b5a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Effective on and off rates", "Subsection"]], \
"Subsection",
 CellChangeTimes->{{3.8227020430476217`*^9, 
  3.822702048850625*^9}},ExpressionUUID->"7aa402e0-2cb1-464b-93bd-\
e0be98fdc84f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"konEff", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"1", "/", "ET13val"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"k23", "\[Rule]", "0"}], ",", 
      RowBox[{"k41", "\[Rule]", "0"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.822702060703475*^9, 3.822702147183284*^9}, {
  3.8227022007745295`*^9, 3.822702213607195*^9}, {3.822704613718944*^9, 
  3.8227046204659543`*^9}, {3.822704687561822*^9, 
  3.8227046920015965`*^9}},ExpressionUUID->"34645e3c-ac3e-4898-a151-\
bdd0e24ef5d2"],

Cell[BoxData[
 FractionBox[
  RowBox[{"c", " ", "k21", " ", "k32"}], 
  RowBox[{"k12", "+", 
   RowBox[{"c", " ", "k21"}], "+", "k32"}]]], "Output",
 CellChangeTimes->{{3.8227021139982452`*^9, 3.822702147516677*^9}, {
   3.8227022028020253`*^9, 3.822702214371283*^9}, 3.822703015177085*^9, 
   3.8227037171703444`*^9},
 CellLabel->
  "Out[224]=",ExpressionUUID->"96098365-d942-4470-8495-c69db4437557"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"koffEff", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"1", "/", "ET31val"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"k23", "\[Rule]", "0"}], ",", 
      RowBox[{"k41", "\[Rule]", "0"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8227022594266815`*^9, 3.822702262327367*^9}, {
  3.822704602006091*^9, 3.8227046065371695`*^9}, {3.822704695403911*^9, 
  3.8227046988010807`*^9}},ExpressionUUID->"2dcd2822-130c-4d75-8bee-\
ce4edef28d61"],

Cell[BoxData[
 FractionBox[
  RowBox[{"k14", " ", "k43"}], 
  RowBox[{"k14", "+", 
   RowBox[{"c", " ", "k34"}], "+", "k43"}]]], "Output",
 CellChangeTimes->{3.8227022633522377`*^9, 3.82270301525036*^9, 
  3.822703717239047*^9},
 CellLabel->
  "Out[225]=",ExpressionUUID->"6834996d-a5a2-4752-8080-9e20e89bf44e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"koffWrong", " ", "=", " ", 
   RowBox[{"koffEff", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"c", "\[Rule]", "cw"}], ",", 
      RowBox[{"k43", "\[Rule]", 
       RowBox[{"B", "*", "k43"}]}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8227023617843924`*^9, 3.822702394506503*^9}},
 CellLabel->
  "In[226]:=",ExpressionUUID->"2dd1dd44-8348-4e55-bd0c-fc656eb40a65"],

Cell[BoxData[
 RowBox[{
  RowBox[{"konWrong", " ", "=", " ", 
   RowBox[{"konEff", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"c", "\[Rule]", "cw"}], ",", 
      RowBox[{"k12", "\[Rule]", 
       RowBox[{"B", "*", "k12"}]}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.822702401895961*^9, 3.8227024159290714`*^9}, {
  3.8227024615404606`*^9, 3.822702462553334*^9}},
 CellLabel->
  "In[227]:=",ExpressionUUID->"bc45cb10-dcec-4fc9-9f8a-9804e0a73491"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"konRatio", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"konEff", "/", "konWrong"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.822702426453521*^9, 3.822702451024965*^9}},
 CellLabel->
  "In[228]:=",ExpressionUUID->"06ab4627-b255-4f0d-b360-8693e585be6b"],

Cell[BoxData[
 FractionBox[
  RowBox[{"c", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"B", " ", "k12"}], "+", 
     RowBox[{"cw", " ", "k21"}], "+", "k32"}], ")"}]}], 
  RowBox[{"cw", " ", 
   RowBox[{"(", 
    RowBox[{"k12", "+", 
     RowBox[{"c", " ", "k21"}], "+", "k32"}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.822702451692703*^9, 3.8227024645108175`*^9}, 
   3.8227030153551702`*^9, 3.8227037174807963`*^9},
 CellLabel->
  "Out[228]=",ExpressionUUID->"1dc82818-42e2-4dc0-be37-d5b3686401ff"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"koffRatio", " ", "=", " ", 
  RowBox[{"koffWrong", "/", "koffEff"}]}]], "Input",
 CellChangeTimes->{{3.8227024714795136`*^9, 3.8227024802799525`*^9}, {
  3.8227025450514393`*^9, 3.822702545755165*^9}, {3.822702582331681*^9, 
  3.8227025832344007`*^9}},
 CellLabel->
  "In[229]:=",ExpressionUUID->"9bd698db-e0c0-411e-a256-59f9d58aa661"],

Cell[BoxData[
 FractionBox[
  RowBox[{"B", " ", 
   RowBox[{"(", 
    RowBox[{"k14", "+", 
     RowBox[{"c", " ", "k34"}], "+", "k43"}], ")"}]}], 
  RowBox[{"k14", "+", 
   RowBox[{"cw", " ", "k34"}], "+", 
   RowBox[{"B", " ", "k43"}]}]]], "Output",
 CellChangeTimes->{
  3.8227024807596245`*^9, {3.8227025460543585`*^9, 3.8227025491370797`*^9}, 
   3.822702583816306*^9, 3.822703015431134*^9, 3.8227037175509233`*^9},
 CellLabel->
  "Out[229]=",ExpressionUUID->"dddd893a-b296-46ca-819c-93b44f8bcf82"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"pdRateEff", " ", "=", " ", 
   RowBox[{
    FractionBox[
     RowBox[{"koffw", " ", "konr"}], 
     RowBox[{
      RowBox[{"koffw", " ", "konr"}], "+", 
      RowBox[{"koffr", " ", 
       RowBox[{"(", 
        RowBox[{"koffw", "+", "konw"}], ")"}]}]}]], "+", 
    FractionBox[
     RowBox[{"koffr", " ", "konw"}], 
     RowBox[{
      RowBox[{"koffw", " ", "konr"}], "+", 
      RowBox[{"koffr", " ", 
       RowBox[{"(", 
        RowBox[{"koffw", "+", "konw"}], ")"}]}]}]]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.822703646408641*^9, 3.822703655860961*^9}},
 CellLabel->
  "In[230]:=",ExpressionUUID->"3231ae99-1b42-46e4-99c6-68ab01ae0b63"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pdRateFull", " ", "=", 
   RowBox[{"FullSimplify", "[", " ", 
    RowBox[{"pdRateEff", " ", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"konr", "\[Rule]", "konEff"}], ",", 
       RowBox[{"koffr", "\[Rule]", "koffEff"}], ",", 
       RowBox[{"konw", "\[Rule]", "konWrong"}], ",", 
       RowBox[{"koffw", "\[Rule]", "koffWrong"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.822703660886224*^9, 3.8227037370735517`*^9}},
 CellLabel->
  "In[232]:=",ExpressionUUID->"43b40622-9955-4a73-8f99-c8fcd3384162"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sharpness", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"pdRateFull", ",", "c"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"k14", "\[Rule]", "a"}], ",", 
      RowBox[{"k43", "\[Rule]", "a"}], ",", 
      RowBox[{"k34", "\[Rule]", "b"}], ",", 
      RowBox[{"k21", "\[Rule]", "a"}], ",", 
      RowBox[{"k32", "\[Rule]", "a"}], ",", 
      RowBox[{"k12", "\[Rule]", "b"}], ",", 
      RowBox[{"c", "\[Rule]", "1"}], ",", 
      RowBox[{"cw", "\[Rule]", "1"}], ",", 
      RowBox[{"B", "\[Rule]", "100"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8227037414082527`*^9, 3.8227037630434256`*^9}, {
   3.822703795277994*^9, 3.8227038762219353`*^9}, {3.8227039660850244`*^9, 
   3.822704009641961*^9}, {3.8227040634179726`*^9, 3.822704065643092*^9}, 
   3.8227044796576543`*^9, {3.822704513449377*^9, 3.8227045152601557`*^9}},
 CellLabel->
  "In[254]:=",ExpressionUUID->"79c85788-253d-4ab6-933e-f584a515eda9"],

Cell[BoxData[
 FractionBox[
  RowBox[{"40000", " ", 
   RowBox[{"(", 
    RowBox[{"a", "+", 
     RowBox[{"2", " ", "b"}]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"a", "+", 
      RowBox[{"50", " ", "b"}]}], ")"}], "2"]}], 
  RowBox[{"9", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "a"}], "+", "b"}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"167", " ", "a"}], "+", 
      RowBox[{"6667", " ", "b"}]}], ")"}], "2"]}]]], "Output",
 CellChangeTimes->{
  3.822703764371303*^9, 3.8227038354571447`*^9, 3.8227038771756477`*^9, {
   3.8227039804382353`*^9, 3.8227040119872775`*^9}, 3.822704066120326*^9, 
   3.822704479989435*^9, 3.8227045156003866`*^9},
 CellLabel->
  "Out[254]=",ExpressionUUID->"cb84da8a-68fa-4864-9b70-17aeed4e0ec2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"sharpness", ",", 
     RowBox[{"a", ">", "0"}], ",", 
     RowBox[{"b", ">", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.822703889880911*^9, 3.822703924655376*^9}, {
  3.82270402603895*^9, 3.822704079155018*^9}, {3.82270448924898*^9, 
  3.8227045209689884`*^9}},
 CellLabel->
  "In[255]:=",ExpressionUUID->"a3093407-2ca6-4a9f-b88b-91837c6b4f04"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.4999500116406271`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[Rule]", 
      RowBox[{"-", "1.5766387056013084`*^-9"}]}], ",", 
     RowBox[{"b", "\[Rule]", "0.1508476283132871`"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.822703898885977*^9, 3.8227039250263844`*^9}, {
  3.82270405151015*^9, 3.822704080578473*^9}, {3.8227044823022237`*^9, 
  3.822704521529497*^9}},
 CellLabel->
  "Out[255]=",ExpressionUUID->"3fdc148c-e5c2-40f3-998c-3c3ca9d7ff73"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fidelity", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"konRatio", "*", "koffRatio"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"k14", "\[Rule]", "a"}], ",", 
      RowBox[{"k43", "\[Rule]", "a"}], ",", 
      RowBox[{"k34", "\[Rule]", "b"}], ",", 
      RowBox[{"k21", "\[Rule]", "a"}], ",", 
      RowBox[{"k32", "\[Rule]", "a"}], ",", 
      RowBox[{"k12", "\[Rule]", "b"}], ",", 
      RowBox[{"c", "\[Rule]", "1"}], ",", 
      RowBox[{"cw", "\[Rule]", "1"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.822704102171628*^9, 3.8227041308419747`*^9}, 
   3.8227041882978106`*^9},
 CellLabel->
  "In[248]:=",ExpressionUUID->"438f8034-4ff3-49d2-a1eb-57425509864a"],

Cell[BoxData[
 FractionBox[
  RowBox[{"B", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "a"}], "+", 
     RowBox[{"b", " ", "B"}]}], ")"}]}], 
  RowBox[{"a", "+", "b", "+", 
   RowBox[{"a", " ", "B"}]}]]], "Output",
 CellChangeTimes->{3.8227041313772097`*^9, 3.8227041887377663`*^9},
 CellLabel->
  "Out[248]=",ExpressionUUID->"e1f787bd-0c5d-415b-9a8f-476f91c58a7a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Maximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"fidelity", ",", 
     RowBox[{"a", ">", "0"}], ",", 
     RowBox[{"b", ">", "0"}], ",", 
     RowBox[{"B", ">", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8227041479412327`*^9, 3.8227041490236483`*^9}, {
  3.8227041922166634`*^9, 3.8227041975280466`*^9}},
 CellLabel->
  "In[249]:=",ExpressionUUID->"32cc0fc9-0062-403a-a2a5-b5217dff43db"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[GridBox[{
      {"\[Piecewise]", GridBox[{
         {"1", 
          RowBox[{"B", "\[Equal]", "1"}]},
         {
          SuperscriptBox["B", "2"], 
          RowBox[{"B", ">", "1"}]},
         {
          FractionBox[
           RowBox[{"2", " ", "B"}], 
           RowBox[{"1", "+", "B"}]], 
          RowBox[{"0", "<", "B", "<", "1"}]},
         {
          RowBox[{"-", "\[Infinity]"}], 
          TagBox["True",
           "PiecewiseDefault",
           AutoDelete->True]}
        },
        AllowedDimensions->{2, Automatic},
        Editable->True,
        GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.84]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}},
        Selectable->True]}
     },
     GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.35]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    "Piecewise",
    DeleteWithContents->True,
    Editable->False,
    SelectWithContents->True,
    Selectable->False,
    StripWrapperBoxes->True], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[Rule]", 
      TagBox[GridBox[{
         {"\[Piecewise]", GridBox[{
            {"1", 
             RowBox[{"B", "\[Equal]", "1"}]},
            {"Indeterminate", 
             TagBox["True",
              "PiecewiseDefault",
              AutoDelete->True]}
           },
           AllowedDimensions->{2, Automatic},
           Editable->True,
           GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
           GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.84]}, 
               Offset[0.27999999999999997`]}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}},
           Selectable->True]}
        },
        GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.35]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}}],
       "Piecewise",
       DeleteWithContents->True,
       Editable->False,
       SelectWithContents->True,
       Selectable->False,
       StripWrapperBoxes->True]}], ",", 
     RowBox[{"b", "\[Rule]", 
      TagBox[GridBox[{
         {"\[Piecewise]", GridBox[{
            {"1", 
             RowBox[{"B", "\[Equal]", "1"}]},
            {"Indeterminate", 
             TagBox["True",
              "PiecewiseDefault",
              AutoDelete->True]}
           },
           AllowedDimensions->{2, Automatic},
           Editable->True,
           GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
           GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.84]}, 
               Offset[0.27999999999999997`]}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}},
           Selectable->True]}
        },
        GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.35]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}}],
       "Piecewise",
       DeleteWithContents->True,
       Editable->False,
       SelectWithContents->True,
       Selectable->False,
       StripWrapperBoxes->True]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.822704150358714*^9, 3.8227041978501167`*^9},
 CellLabel->
  "Out[249]=",ExpressionUUID->"9452a545-e1d7-486f-a477-773c0cfbab74"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1440., 777.75},
WindowMargins->{{956, Automatic}, {Automatic, -4}},
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (June 19, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"f1acc611-0be0-4428-aabf-fe480625badc"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 354, 5, 73, "Section",ExpressionUUID->"53bbe826-6243-4623-bfbc-1fc0a6d7cf3d"],
Cell[937, 29, 274, 5, 28, "Input",ExpressionUUID->"09a89208-e8c8-4a30-a36f-b4bd2445d91a"],
Cell[1214, 36, 2023, 46, 85, "Input",ExpressionUUID->"689ad0c0-dea0-4cad-8a2d-060acfc140d0"],
Cell[CellGroupData[{
Cell[3262, 86, 240, 5, 28, "Input",ExpressionUUID->"628a347c-779f-4fe0-b274-94b8b6d49941"],
Cell[3505, 93, 2587, 55, 95, "Output",ExpressionUUID->"de638731-f671-4261-b15a-9827c10a2ebf"]
}, Open  ]],
Cell[6107, 151, 179, 3, 28, "Input",ExpressionUUID->"64bb8e01-35f2-4ab7-897b-2d302dfdfe44"],
Cell[CellGroupData[{
Cell[6311, 158, 237, 5, 28, "Input",ExpressionUUID->"1c70661a-586e-4afd-bbfa-0af317b7b526"],
Cell[6551, 165, 1392, 22, 32, "Output",ExpressionUUID->"80e89b12-ed90-4187-8375-e1f14586e842"]
}, Open  ]],
Cell[7958, 190, 588, 11, 28, "Input",ExpressionUUID->"35c06f23-f104-453a-927e-9756152eb189"],
Cell[8549, 203, 554, 13, 28, "Input",ExpressionUUID->"dc484be2-c9eb-40bd-ac5d-56e1c63e48d4"],
Cell[9106, 218, 327, 8, 28, "Input",ExpressionUUID->"146fe221-9cbd-4c5a-9d81-52fc72624518"],
Cell[9436, 228, 493, 13, 28, "Input",ExpressionUUID->"80d9bb67-42bd-4674-ab61-63a1f859ea9a"],
Cell[9932, 243, 919, 18, 28, "Input",ExpressionUUID->"e0b90688-52d0-4126-80a5-8f6b8cbefb2d"],
Cell[10854, 263, 520, 13, 28, "Input",ExpressionUUID->"2835703c-faa1-4479-ab2c-423a6b5520f9"],
Cell[CellGroupData[{
Cell[11399, 280, 588, 14, 28, "Input",ExpressionUUID->"4fc6fbb5-3cd7-40d9-90b8-e651e3c2fd83"],
Cell[11990, 296, 1304, 35, 51, "Output",ExpressionUUID->"e0b559db-676e-4719-9a08-a08f539cf2a6"]
}, Open  ]],
Cell[13309, 334, 341, 5, 63, "Subsection",ExpressionUUID->"1857f6e4-9744-4305-a9bc-09a799a37bf0"],
Cell[CellGroupData[{
Cell[13675, 343, 171, 3, 39, "Subsection",ExpressionUUID->"2e29538f-066a-41c3-867a-a5fe9cded690"],
Cell[13849, 348, 296, 7, 28, "Input",ExpressionUUID->"0c1b0679-5c2d-432c-afb1-0dee381d6c61"],
Cell[14148, 357, 829, 23, 28, "Input",ExpressionUUID->"d11b5662-d0ed-46b8-a00c-b0c0ad7f00af"],
Cell[14980, 382, 801, 23, 28, "Input",ExpressionUUID->"66cba8b4-c235-4fdd-8095-8dfb585a624e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15818, 410, 384, 6, 55, "Subsection",ExpressionUUID->"07641087-c288-45b3-8bb5-72051831865a"],
Cell[16205, 418, 862, 25, 28, "Input",ExpressionUUID->"ad75c6bb-278f-4c1c-af21-ea1ba8c7dabc"],
Cell[17070, 445, 874, 23, 28, "Input",ExpressionUUID->"65cb6fa2-8da9-4223-bcfb-46d7d6cc66c5"],
Cell[17947, 470, 885, 23, 28, "Input",ExpressionUUID->"da902cba-5ff6-4a05-ab39-1950538f23bd"],
Cell[18835, 495, 540, 14, 28, "Input",ExpressionUUID->"d9a73969-6130-4e0a-b5a4-20ebb6e8caf1"],
Cell[19378, 511, 522, 11, 28, "Input",ExpressionUUID->"ff3541fa-7743-4824-ab57-61504512d080"],
Cell[19903, 524, 505, 11, 28, "Input",ExpressionUUID->"121ed990-6070-42ab-b1ff-cdc4f4ef9821"],
Cell[20411, 537, 459, 11, 28, "Input",ExpressionUUID->"479caca0-0e28-4e44-a46f-761b7f8359bf"],
Cell[20873, 550, 381, 6, 28, "Input",ExpressionUUID->"c656b426-ffa4-4f0d-a88b-57c071d971f5"],
Cell[21257, 558, 910, 25, 28, "Input",ExpressionUUID->"a445ef80-279a-4fbf-af09-eadd3c2da049"],
Cell[22170, 585, 973, 24, 28, "Input",ExpressionUUID->"96e82d21-4239-43bf-b8c9-4e97e6e49e4a"],
Cell[23146, 611, 1078, 25, 28, "Input",ExpressionUUID->"de953c59-c272-4477-8846-171029f432ec"],
Cell[24227, 638, 640, 15, 28, "Input",ExpressionUUID->"33c241de-b644-402b-afc5-3c3575285838"],
Cell[24870, 655, 571, 12, 28, "Input",ExpressionUUID->"7d09bd07-2e3f-4f7e-b4fa-33b46f115a11"],
Cell[25444, 669, 556, 12, 28, "Input",ExpressionUUID->"16590ecd-c20e-41ea-8613-9ef2c4f645c4"],
Cell[26003, 683, 509, 11, 28, "Input",ExpressionUUID->"f386ce44-b5d7-4781-bacc-d0964b778b5a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26549, 699, 212, 4, 55, "Subsection",ExpressionUUID->"7aa402e0-2cb1-464b-93bd-e0be98fdc84f"],
Cell[CellGroupData[{
Cell[26786, 707, 556, 13, 28, "Input",ExpressionUUID->"34645e3c-ac3e-4898-a151-bdd0e24ef5d2"],
Cell[27345, 722, 401, 9, 49, "Output",ExpressionUUID->"96098365-d942-4470-8495-c69db4437557"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27783, 736, 508, 12, 28, "Input",ExpressionUUID->"2dcd2822-130c-4d75-8bee-ce4edef28d61"],
Cell[28294, 750, 311, 8, 49, "Output",ExpressionUUID->"6834996d-a5a2-4752-8080-9e20e89bf44e"]
}, Open  ]],
Cell[28620, 761, 417, 11, 28, "Input",ExpressionUUID->"2dd1dd44-8348-4e55-bd0c-fc656eb40a65"],
Cell[29040, 774, 466, 12, 28, "Input",ExpressionUUID->"bc45cb10-dcec-4fc9-9f8a-9804e0a73491"],
Cell[CellGroupData[{
Cell[29531, 790, 290, 6, 28, "Input",ExpressionUUID->"06ab4627-b255-4f0d-b360-8693e585be6b"],
Cell[29824, 798, 507, 14, 51, "Output",ExpressionUUID->"1dc82818-42e2-4dc0-be37-d5b3686401ff"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30368, 817, 359, 7, 28, "Input",ExpressionUUID->"9bd698db-e0c0-411e-a256-59f9d58aa661"],
Cell[30730, 826, 502, 13, 49, "Output",ExpressionUUID->"dddd893a-b296-46ca-819c-93b44f8bcf82"]
}, Open  ]],
Cell[31247, 842, 680, 20, 47, "Input",ExpressionUUID->"3231ae99-1b42-46e4-99c6-68ab01ae0b63"],
Cell[31930, 864, 568, 14, 28, "Input",ExpressionUUID->"43b40622-9955-4a73-8f99-c8fcd3384162"],
Cell[CellGroupData[{
Cell[32523, 882, 1010, 22, 28, "Input",ExpressionUUID->"79c85788-253d-4ab6-933e-f584a515eda9"],
Cell[33536, 906, 809, 24, 53, "Output",ExpressionUUID->"cb84da8a-68fa-4864-9b70-17aeed4e0ec2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34382, 935, 500, 13, 28, "Input",ExpressionUUID->"a3093407-2ca6-4a9f-b88b-91837c6b4f04"],
Cell[34885, 950, 519, 13, 36, "Output",ExpressionUUID->"3fdc148c-e5c2-40f3-998c-3c3ca9d7ff73"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35441, 968, 737, 18, 28, "Input",ExpressionUUID->"438f8034-4ff3-49d2-a1eb-57425509864a"],
Cell[36181, 988, 380, 11, 49, "Output",ExpressionUUID->"e1f787bd-0c5d-415b-9a8f-476f91c58a7a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36598, 1004, 493, 13, 28, "Input",ExpressionUUID->"32cc0fc9-0062-403a-a2a5-b5217dff43db"],
Cell[37094, 1019, 4594, 129, 93, "Output",ExpressionUUID->"9452a545-e1d7-486f-a477-773c0cfbab74"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

