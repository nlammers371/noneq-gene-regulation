(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     50016,       1407]
NotebookOptionsPosition[     42235,       1263]
NotebookOutlinePosition[     42581,       1278]
CellTagsIndexPosition[     42538,       1275]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Sharpness Notebook", "Title",
 CellChangeTimes->{{3.791311534165575*^9, 
  3.7913115540947046`*^9}},ExpressionUUID->"510d2138-3d96-4498-b37b-\
70a3be022443"],

Cell[CellGroupData[{

Cell["Define transition rate matrix and steady state vectors", "Chapter",
 CellChangeTimes->{{3.791311567084392*^9, 
  3.7913115916898394`*^9}},ExpressionUUID->"e89786e2-ecd8-4670-9d08-\
10b8df41da79"],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.7665860727694225`*^9, 3.7665860727953434`*^9}, 
   3.790350446024684*^9, 3.790353136444847*^9},
 CellLabel->
  "In[290]:=",ExpressionUUID->"5c68a1e7-9bf7-4c39-9d7d-7fe41ed623c2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Q", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"-", "k4"}], "*", "c"}], "-", "r1"}], ",", "k1", ",", "0", 
       ",", "r4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"r1", ",", 
       RowBox[{
        RowBox[{"-", "k1"}], "-", 
        RowBox[{"r2", "*", "c"}]}], ",", "k2", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"r2", "*", "c"}], ",", 
       RowBox[{
        RowBox[{"-", "k2"}], "-", "r3"}], ",", "k3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"k4", "*", "c"}], ",", "0", ",", "r3", ",", 
       RowBox[{
        RowBox[{"-", "k3"}], "-", "r4"}]}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.789583824008664*^9, 3.789583828946269*^9}, {
   3.7907836403413167`*^9, 3.7907836618887463`*^9}, 3.791311606657423*^9, {
   3.7913123750257673`*^9, 3.791312405802725*^9}, {3.7913125556987944`*^9, 
   3.7913125560248065`*^9}},
 CellLabel->
  "In[291]:=",ExpressionUUID->"2b6677bb-1d2b-4c83-9d0c-a6af206be5c1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "Q", "]"}]], "Input",
 CellChangeTimes->{{3.791311614363743*^9, 3.791311618620845*^9}},
 CellLabel->
  "In[292]:=",ExpressionUUID->"d9de4471-813b-4860-9c33-d135237cd20a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "c"}], " ", "k4"}], "-", "r1"}], "k1", "0", "r4"},
     {"r1", 
      RowBox[{
       RowBox[{"-", "k1"}], "-", 
       RowBox[{"c", " ", "r2"}]}], "k2", "0"},
     {"0", 
      RowBox[{"c", " ", "r2"}], 
      RowBox[{
       RowBox[{"-", "k2"}], "-", "r3"}], "k3"},
     {
      RowBox[{"c", " ", "k4"}], "0", "r3", 
      RowBox[{
       RowBox[{"-", "k3"}], "-", "r4"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.791311623422639*^9, 3.7913124093003826`*^9, 3.7913125590493193`*^9, {
   3.7913138197500525`*^9, 3.7913138487329235`*^9}, {3.7913179376395893`*^9, 
   3.791317962250045*^9}, 3.791318007878877*^9, 3.7913189529100685`*^9},
 CellLabel->
  "Out[292]//MatrixForm=",ExpressionUUID->"e994a4e8-db91-4d4f-bcce-\
3d193b52da5b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", "Q", "]"}]], "Input",
 CellChangeTimes->{{3.791312482926733*^9, 3.7913124883956375`*^9}},
 CellLabel->
  "In[293]:=",ExpressionUUID->"1dc7c2f1-b420-4cb0-b033-1568ff228220"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.791312485618776*^9, 3.7913124886956215`*^9}, 
   3.7913125590815363`*^9, {3.7913138197790008`*^9, 3.7913138487654037`*^9}, {
   3.791317937669511*^9, 3.791317962278969*^9}, 3.7913180079098473`*^9, 
   3.791318952939043*^9},
 CellLabel->
  "Out[293]=",ExpressionUUID->"892ff3b7-d446-4b74-ae67-4811b9c58539"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Make a few simplifying assumptions", "Subsubsection",
 CellChangeTimes->{{3.7913116400931206`*^9, 
  3.7913116510475707`*^9}},ExpressionUUID->"ce51f104-4f4c-426d-ae6b-\
043cae1e37af"],

Cell["\<\
Make k1-k3 and r1,r2,r4 generic (k and r) and replace r2 with ratio of \
backward and forward rates times an equilibrium constant\
\>", "Text",
 CellChangeTimes->{{3.79131169150404*^9, 3.791311773110479*^9}, {
  3.7913119308546267`*^9, 
  3.7913119319591026`*^9}},ExpressionUUID->"cdc10c9f-19ab-475f-a04d-\
5e21786fce88"],

Cell[BoxData[
 RowBox[{
  RowBox[{"QSimp", " ", "=", " ", 
   RowBox[{"Q", " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"k1", "\[Rule]", "k"}], ",", 
      RowBox[{"k2", "\[Rule]", "k"}], ",", 
      RowBox[{"k3", "\[Rule]", "k"}], ",", 
      RowBox[{"r1", "\[Rule]", "r"}], ",", 
      RowBox[{"r3", "\[Rule]", "r"}], ",", 
      RowBox[{"r4", "\[Rule]", "r"}], ",", 
      RowBox[{"r2", "\[Rule]", " ", 
       RowBox[{
        RowBox[{"k", "^", "3"}], " ", "*", 
        RowBox[{"k4", "/", " ", 
         RowBox[{"r", "^", "3"}]}], "  ", "*", "B"}]}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.791311778983797*^9, 3.791311809280609*^9}, {
  3.7913118955937905`*^9, 3.791311948486795*^9}},
 CellLabel->
  "In[294]:=",ExpressionUUID->"c4d5b281-972d-4df4-aa77-7e3c89234881"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "QSimp", "]"}]], "Input",
 CellChangeTimes->{{3.7913119509742146`*^9, 3.791311952524602*^9}},
 CellLabel->
  "In[295]:=",ExpressionUUID->"a3af0e16-1954-4382-bb0d-392dfdbdeb31"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "c"}], " ", "k4"}], "-", "r"}], "k", "0", "r"},
     {"r", 
      RowBox[{
       RowBox[{"-", "k"}], "-", 
       FractionBox[
        RowBox[{"B", " ", "c", " ", 
         SuperscriptBox["k", "3"], " ", "k4"}], 
        SuperscriptBox["r", "3"]]}], "k", "0"},
     {"0", 
      FractionBox[
       RowBox[{"B", " ", "c", " ", 
        SuperscriptBox["k", "3"], " ", "k4"}], 
       SuperscriptBox["r", "3"]], 
      RowBox[{
       RowBox[{"-", "k"}], "-", "r"}], "k"},
     {
      RowBox[{"c", " ", "k4"}], "0", "r", 
      RowBox[{
       RowBox[{"-", "k"}], "-", "r"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.791311935950245*^9, 3.7913119528341484`*^9}, 
   3.791312409398924*^9, 3.7913125591801786`*^9, {3.791313819862727*^9, 
   3.7913138488694243`*^9}, {3.7913179377687564`*^9, 3.791317962366737*^9}, 
   3.7913180079947615`*^9, 3.7913189530177813`*^9},
 CellLabel->
  "Out[295]//MatrixForm=",ExpressionUUID->"2cf57ec2-2a16-491f-946d-\
5d0ff9f9bc83"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", "QSimp", "]"}]], "Input",
 CellChangeTimes->{{3.79131246706478*^9, 3.791312470439593*^9}},
 CellLabel->
  "In[296]:=",ExpressionUUID->"5619d43a-0753-426d-82b3-b2c0d172744e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.791312470731801*^9, 3.791312559209072*^9, {3.7913138198901587`*^9, 
   3.7913138489003315`*^9}, {3.7913179378036623`*^9, 3.7913179624006433`*^9}, 
   3.7913180080286713`*^9, 3.791318953045764*^9},
 CellLabel->
  "Out[296]=",ExpressionUUID->"4b070dfd-f186-481f-a75a-3d197edf05f4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Calculate Steady-state vector (equal to first eigenvector divided by \
normalization factor)\
\>", "Subsubsection",
 CellChangeTimes->{{3.791311977681471*^9, 
  3.7913120039467373`*^9}},ExpressionUUID->"21978a00-dd83-4d10-9520-\
33a396244e7e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eigVectors", " ", "=", " ", 
   RowBox[{"Eigenvectors", "[", "QSimp", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.791312021657304*^9, 3.791312027887988*^9}},
 CellLabel->
  "In[297]:=",ExpressionUUID->"c6d84068-7cf2-4470-b15b-7c949ae299ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ssVec", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"eigVectors", "[", 
      RowBox[{"[", "1", "]"}], "]"}], " ", "/", " ", 
     RowBox[{"Total", "[", 
      RowBox[{"eigVectors", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7913120397710824`*^9, 3.791312051199873*^9}, {
  3.791312177120442*^9, 3.791312177822337*^9}},
 CellLabel->
  "In[298]:=",ExpressionUUID->"30324ce1-9219-439a-828a-efc6046e1c17"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pdRate", " ", "=", " ", 
  RowBox[{"ssVec", "[", 
   RowBox[{"[", "4", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7913121819481945`*^9, 3.7913121941556635`*^9}, 
   3.7913124570985546`*^9},
 CellLabel->
  "In[299]:=",ExpressionUUID->"645b2fb8-57d9-498e-b075-f1182afe0721"],

Cell[BoxData[
 FractionBox[
  RowBox[{"c", " ", "k", " ", "k4", " ", "r", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["r", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"k", "+", "r"}], ")"}]}], "+", 
     RowBox[{"B", " ", 
      SuperscriptBox["k", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", " ", "k4"}], "+", "r"}], ")"}]}]}], ")"}]}], 
  RowBox[{
   RowBox[{
    SuperscriptBox["r", "3"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["k", "3"], "+", 
      SuperscriptBox["r", "3"], "+", 
      RowBox[{"k", " ", "r", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "k4"}], "+", 
         RowBox[{"2", " ", "r"}]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["k", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", "c", " ", "k4"}], "+", 
         RowBox[{"2", " ", "r"}]}], ")"}]}]}], ")"}]}], "+", 
   RowBox[{"B", " ", "c", " ", 
    SuperscriptBox["k", "3"], " ", "k4", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", "k4", " ", 
       RowBox[{"(", 
        RowBox[{"k", "+", "r"}], ")"}]}], "+", 
      RowBox[{"r", " ", 
       RowBox[{"(", 
        RowBox[{"k", "+", 
         RowBox[{"3", " ", "r"}]}], ")"}]}]}], ")"}]}]}]]], "Output",
 CellChangeTimes->{
  3.7913124574257975`*^9, 3.791312559734029*^9, {3.791313820352847*^9, 
   3.7913138494640536`*^9}, {3.791317938313811*^9, 3.791317962890252*^9}, 
   3.7913180085083847`*^9, 3.791318953371834*^9},
 CellLabel->
  "Out[299]=",ExpressionUUID->"2bc068a5-fd78-49e7-896f-809d8810009c"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Find Eq and Non-Eq Sharpness Limits Numerically", "Chapter",
 CellChangeTimes->{{3.7913121476883154`*^9, 
  3.7913121612235575`*^9}},ExpressionUUID->"fb04d331-987a-4941-ace9-\
cb682ecde211"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pdSharpness", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{"pdRate", ",", "c"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7913121976969585`*^9, 3.7913122189775176`*^9}},
 CellLabel->
  "In[300]:=",ExpressionUUID->"7cda3f93-ab4f-4b17-8c14-b0ffcb27320d"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Sharpness in equilibrium", "Subsection"]], \
"Subsubsection",
 CellChangeTimes->{{3.7913122297217865`*^9, 3.7913122376263895`*^9}, 
   3.791312908877942*^9},ExpressionUUID->"554408cb-8c2f-44af-acf3-\
a9a42abab80f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pdSharpEq", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"pdSharpness", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"c", "\[Rule]", "1"}], " ", ",", " ", 
      RowBox[{"B", "\[Rule]", "1"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7913122888390837`*^9, 3.7913123088490133`*^9}},
 CellLabel->
  "In[301]:=",ExpressionUUID->"f6351c9e-0b2b-408e-ad70-a39677036398"],

Cell[BoxData[
 FractionBox[
  RowBox[{"k", " ", "k4", " ", 
   SuperscriptBox["r", "3"]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"k", "+", "r"}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"k", " ", "k4"}], "+", 
      SuperscriptBox["r", "2"]}], ")"}], "2"]}]]], "Output",
 CellChangeTimes->{{3.7913123011022096`*^9, 3.7913123094988766`*^9}, 
   3.791312560323886*^9, {3.79131382093991*^9, 3.7913138502001295`*^9}, {
   3.791317938969159*^9, 3.791317963550736*^9}, 3.7913180091064773`*^9, 
   3.791318953737919*^9},
 CellLabel->
  "Out[301]=",ExpressionUUID->"2ae73080-8641-49ea-9361-c8463d8ff8de"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"maxEqSharp", " ", "=", " ", 
  RowBox[{"NMaximize", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"pdSharpEq", ",", 
      RowBox[{"k", ">", "0"}], ",", 
      RowBox[{"k4", ">", "0"}], ",", 
      RowBox[{"r", ">", "0"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"k4", ",", "k", ",", "r"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7913122419503546`*^9, 3.791312280108038*^9}, {
  3.7913123258995266`*^9, 3.791312343908454*^9}},
 CellLabel->
  "In[302]:=",ExpressionUUID->"5f3c1b64-7bee-4de6-adde-f72d7172a8eb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.2499193630721112`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"k4", "\[Rule]", "146.56349050551543`"}], ",", 
     RowBox[{"k", "\[Rule]", "0.000015249623017337616`"}], ",", 
     RowBox[{"r", "\[Rule]", "0.047299718881106116`"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.7913123453724103`*^9, 3.7913125608646035`*^9, {3.7913138213930287`*^9, 
   3.7913138508195057`*^9}, {3.7913179395046883`*^9, 3.7913179640828233`*^9}, 
   3.7913180096859374`*^9, 3.7913189540511074`*^9},
 CellLabel->
  "Out[302]=",ExpressionUUID->"4a7aa02d-c530-43cf-bf16-29bd2c1e33f2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"ssVec", " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"B", "\[Rule]", "1"}], ",", 
      RowBox[{"c", "\[Rule]", "1"}]}], "}"}]}], ")"}], " ", "/.", " ", 
  RowBox[{"maxEqSharp", "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7913126256565943`*^9, 3.791312666329905*^9}},
 CellLabel->
  "In[303]:=",ExpressionUUID->"d08a8539-51e8-433e-af23-85db4b37df97"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.00016123028027664686`", ",", "0.5000875709213939`", ",", 
   "0.00016106990293088554`", ",", "0.49959012889539867`"}], "}"}]], "Output",
 CellChangeTimes->{{3.7913126329337735`*^9, 3.79131266716171*^9}, {
   3.791313821426938*^9, 3.7913138508603992`*^9}, {3.7913179395415897`*^9, 
   3.7913179641237144`*^9}, 3.791318009818095*^9, 3.791318954118926*^9},
 CellLabel->
  "Out[303]=",ExpressionUUID->"2d1d9922-3356-4448-bf7c-7ecc33d432c2"]
}, Open  ]]
}, Open  ]],

Cell[TextData[StyleBox["So, we see that the maximally sharp system at \
equilibrium is essentially a 2 state system, where the system spends half its \
time in state2 (off) and half in state 4 (on)", "Text"]], "Subsubsection",
 CellChangeTimes->{{3.7913126944964457`*^9, 
  3.7913127549208703`*^9}},ExpressionUUID->"3747f67b-c060-42d3-a560-\
edd39d2aa3f2"],

Cell[CellGroupData[{

Cell["Sharpness out of Equilibrium", "Subsection",
 CellChangeTimes->{{3.791312911386385*^9, 
  3.7913129304656334`*^9}},ExpressionUUID->"f977cc91-657a-44cb-af04-\
6ea58a9886b5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pdSharpNeq", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"pdSharpness", "/.", 
    RowBox[{"c", "\[Rule]", "1"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7913129412153196`*^9, 3.7913129709794865`*^9}, {
  3.791313025574293*^9, 3.791313043384923*^9}},
 CellLabel->
  "In[304]:=",ExpressionUUID->"ebe05e68-7acc-43e2-b81d-e1ea7fdb83d5"],

Cell[BoxData[
 FractionBox[
  RowBox[{"k", " ", "k4", " ", 
   SuperscriptBox["r", "3"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      SuperscriptBox["B", "2"], " ", 
      SuperscriptBox["k", "5"], " ", 
      SuperscriptBox["k4", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["r", "3"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"k", "+", "r"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["k", "2"], "+", 
        RowBox[{"k", " ", "r"}], "+", 
        SuperscriptBox["r", "2"]}], ")"}]}], "+", 
     RowBox[{"B", " ", 
      SuperscriptBox["k", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["k", "2"], " ", 
         SuperscriptBox["k4", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "k"}], "+", "r"}], ")"}]}], "+", 
        RowBox[{"2", " ", "k4", " ", "r", " ", 
         RowBox[{"(", 
          RowBox[{"k", "+", "r"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["k", "2"], "+", 
           RowBox[{"k", " ", "r"}], "+", 
           SuperscriptBox["r", "2"]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["r", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"k", "+", "r"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["k", "2"], "+", 
           RowBox[{"k", " ", "r"}], "+", 
           SuperscriptBox["r", "2"]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["r", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["k", "3"], "+", 
        SuperscriptBox["r", "3"], "+", 
        RowBox[{"k", " ", "r", " ", 
         RowBox[{"(", 
          RowBox[{"k4", "+", 
           RowBox[{"2", " ", "r"}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["k", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", "k4"}], "+", 
           RowBox[{"2", " ", "r"}]}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{"B", " ", 
      SuperscriptBox["k", "3"], " ", "k4", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"k", " ", 
         RowBox[{"(", 
          RowBox[{"k4", "+", "r"}], ")"}]}], "+", 
        RowBox[{"r", " ", 
         RowBox[{"(", 
          RowBox[{"k4", "+", 
           RowBox[{"3", " ", "r"}]}], ")"}]}]}], ")"}]}]}], ")"}], 
   "2"]]], "Output",
 CellChangeTimes->{
  3.7913129714899755`*^9, 3.791313028875986*^9, 3.7913130678434844`*^9, {
   3.791313822187423*^9, 3.7913138516144867`*^9}, {3.7913179401749315`*^9, 
   3.791317964782356*^9}, 3.791318010481331*^9, 3.7913189546724777`*^9},
 CellLabel->
  "Out[304]=",ExpressionUUID->"74600e77-b2cc-4cea-9344-3ed6c3f406f2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"maxNeqSharp", " ", "=", " ", 
  RowBox[{"NMaximize", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"pdSharpNeq", ",", 
      RowBox[{"k", ">", "0"}], ",", 
      RowBox[{"k4", ">", "0"}], ",", 
      RowBox[{"r", ">", "0"}], ",", 
      RowBox[{"B", ">", "1"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"k4", ",", "k", ",", "r", ",", "B"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.791312999590169*^9, 3.791313004190625*^9}, {
  3.7913130548379383`*^9, 3.791313060156103*^9}},
 CellLabel->
  "In[305]:=",ExpressionUUID->"86cade6c-c428-4407-8c07-f6166ae4cc88"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.48165577204269633`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"k4", "\[Rule]", "2206.9873449572706`"}], ",", 
     RowBox[{"k", "\[Rule]", "0.0047853373382495835`"}], ",", 
     RowBox[{"r", "\[Rule]", "13.64694088024381`"}], ",", 
     RowBox[{"B", "\[Rule]", "864239.610896509`"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.791313011766738*^9, 3.7913130710108953`*^9}, {
   3.7913138228465586`*^9, 3.7913138524207015`*^9}, {3.7913179410894327`*^9, 
   3.7913179654630475`*^9}, 3.791318011167534*^9, 3.7913189552369394`*^9},
 CellLabel->
  "Out[305]=",ExpressionUUID->"3d494021-91a9-435d-ba20-9a014c55ceac"]
}, Open  ]],

Cell["\<\
Note that we see the same qualitative behavior, where states 2 and 4 equally \
split share of occupancy\
\>", "Text",
 CellChangeTimes->{{3.7913131213826795`*^9, 
  3.7913131531467643`*^9}},ExpressionUUID->"5e9d069c-d903-4e85-b8e0-\
603f331a5993"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"ssVec", " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{"c", "\[Rule]", "1"}], "}"}]}], ")"}], " ", "/.", " ", 
  RowBox[{"maxNeqSharp", "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7913131048594055`*^9, 3.7913131091803617`*^9}},
 CellLabel->
  "In[306]:=",ExpressionUUID->"14bf033b-4cc7-4ddf-b494-81f2c7f84de7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.003109993711247333`", ",", "0.48788567520943665`", ",", 
   "0.003116306284622019`", ",", "0.505888024794694`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7913131101394224`*^9, {3.7913138228881874`*^9, 3.7913138524681673`*^9}, {
   3.7913179411576014`*^9, 3.791317965500945*^9}, 3.791318011203683*^9, 
   3.7913189553158646`*^9},
 CellLabel->
  "Out[306]=",ExpressionUUID->"2776cc03-789a-4a88-9c16-70bff7af53bf"]
}, Open  ]],

Cell["\<\
Note also that the infinite drive limit performs terribly, indicating a \
resonance-like phenomenon\
\>", "Text",
 CellChangeTimes->{{3.7913131618975496`*^9, 
  3.7913131888716555`*^9}},ExpressionUUID->"6240a9e1-5ca7-44f3-a2ff-\
83e74d5e084c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pdSharpNeqInf", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Limit", "[", 
     RowBox[{"pdSharpness", ",", 
      RowBox[{"B", "\[Rule]", "Infinity"}]}], "]"}], "/.", 
    RowBox[{"c", "\[Rule]", "1"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.791313195017354*^9, 3.791313206163583*^9}},
 CellLabel->
  "In[307]:=",ExpressionUUID->"f8ae596f-6712-4bf4-a27c-c57beab63236"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", "k4", " ", 
   SuperscriptBox["r", "3"]}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"k", " ", 
      RowBox[{"(", 
       RowBox[{"k4", "+", "r"}], ")"}]}], "+", 
     RowBox[{"r", " ", 
      RowBox[{"(", 
       RowBox[{"k4", "+", 
        RowBox[{"3", " ", "r"}]}], ")"}]}]}], ")"}], "2"]]], "Output",
 CellChangeTimes->{
  3.7913132076204357`*^9, {3.791313823021283*^9, 3.7913138526180286`*^9}, {
   3.791317941609908*^9, 3.7913179656381035`*^9}, 3.7913180113184104`*^9, 
   3.791318955464369*^9},
 CellLabel->
  "Out[307]=",ExpressionUUID->"f9430afd-841d-47f4-ab89-6ddd26bcc454"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"maxNeqInfSharp", " ", "=", " ", 
  RowBox[{"NMaximize", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"pdSharpNeqInf", ",", 
      RowBox[{"k", ">", "0"}], ",", 
      RowBox[{"k4", ">", "0"}], ",", 
      RowBox[{"r", ">", "0"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"k4", ",", "k", ",", "r"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7913132212441363`*^9, 3.7913132352295465`*^9}},
 CellLabel->
  "In[308]:=",ExpressionUUID->"7dd574fb-c5b0-4c71-b771-d54c2c334190"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.1666666666663384`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"k4", "\[Rule]", "371.4713411673118`"}], ",", 
     RowBox[{"k", "\[Rule]", "0.`"}], ",", 
     RowBox[{"r", "\[Rule]", "123.82343282089538`"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.791313235846624*^9, {3.7913138231767087`*^9, 3.7913138528075867`*^9}, {
   3.7913179418392916`*^9, 3.791317965815868*^9}, 3.7913180114949055`*^9, 
   3.7913189556099443`*^9},
 CellLabel->
  "Out[308]=",ExpressionUUID->"652e2a3a-fc5c-42a5-800e-257fdbd9c57e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Derive expressions for effective on and off rates \
between states 2 and 4", "Chapter"]], "Subsection",
 CellChangeTimes->{{3.7913128123168325`*^9, 3.7913128446042705`*^9}, {
  3.791313349851159*^9, 
  3.791313362248847*^9}},ExpressionUUID->"377271d5-5a05-4c87-b288-\
7417575bda3f"],

Cell[CellGroupData[{

Cell["Solve for passage time from 2 to 4 (kon)", "Subsubsection",
 CellChangeTimes->{{3.79131355047433*^9, 
  3.7913135612179346`*^9}},ExpressionUUID->"0abe34f0-32a8-4cd9-b2a2-\
d6d505faa688"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqET14", " ", "=", " ", 
   RowBox[{"ET14", " ", "\[Equal]", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "/", 
      RowBox[{"QSimp", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "*", 
     RowBox[{"(", 
      RowBox[{"1", " ", "+", 
       RowBox[{
        RowBox[{"QSimp", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", "ET24"}]}], ")"}]}]}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.7903526643834977`*^9, 3.790352741300044*^9}, {
  3.790352771329322*^9, 3.7903527888450565`*^9}, {3.791312888006653*^9, 
  3.7913129009700956`*^9}, {3.7913133848850393`*^9, 3.7913133910476613`*^9}},
 CellLabel->
  "In[309]:=",ExpressionUUID->"038697b6-f241-4d74-9319-c88b70856fe0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqET24", " ", "=", " ", 
   RowBox[{"ET24", " ", "\[Equal]", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "/", 
      RowBox[{"QSimp", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "*", 
     RowBox[{"(", 
      RowBox[{"1", " ", "+", 
       RowBox[{
        RowBox[{"QSimp", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}], "*", "ET14"}], "+", 
       RowBox[{
        RowBox[{"QSimp", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "2"}], "]"}], "]"}], "*", "ET34"}]}], ")"}]}]}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.7903527933020215`*^9, 3.7903528424044085`*^9}, {
  3.7913133993286*^9, 3.791313424300767*^9}},
 CellLabel->
  "In[310]:=",ExpressionUUID->"8880b232-9168-451c-8524-dc5e717e0645"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqET34", " ", "=", " ", 
   RowBox[{"ET34", " ", "\[Equal]", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "/", 
      RowBox[{"QSimp", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "*", 
     RowBox[{"(", 
      RowBox[{"1", " ", "+", 
       RowBox[{
        RowBox[{"QSimp", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "3"}], "]"}], "]"}], "*", "ET24"}]}], ")"}]}]}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.790352851392705*^9, 3.7903528757889843`*^9}, {
  3.7903529225947437`*^9, 3.7903529244056287`*^9}, {3.791313418972665*^9, 
  3.7913134340817003`*^9}},
 CellLabel->
  "In[311]:=",ExpressionUUID->"aa027e16-35af-4250-82b8-ee3a4304d80f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"solET4", "=", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eqET14", ",", "eqET24", ",", "eqET34"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ET14", ",", "ET24", ",", "ET34"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7903529264441776`*^9, 3.790352990329671*^9}, {
  3.7913134385517063`*^9, 3.7913134614797373`*^9}},
 CellLabel->
  "In[312]:=",ExpressionUUID->"deff2ac0-f3ae-4b24-9d2d-690792f21667"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Extract expression for first passage time from 2 to 4 \
(ET24)", "Text"]], "Subsubsection",
 CellChangeTimes->{{3.791313470923751*^9, 3.791313485345893*^9}, {
  3.791315128909305*^9, 3.7913151332689495`*^9}, {3.7913151759428024`*^9, 
  3.7913151766776123`*^9}, {3.7913157958231845`*^9, 
  3.791315796440687*^9}},ExpressionUUID->"948039f0-9807-4f72-a467-\
f92a3a8b409e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"kon", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ET24", " ", "/.", " ", 
       RowBox[{"solET4", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "  ", "/.", " ", 
      RowBox[{"k4", "\[Rule]", "1"}]}], ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.791313489864895*^9, 3.7913135183543925`*^9}, {
  3.7913151432184334`*^9, 3.79131518066156*^9}, {3.791315674775187*^9, 
  3.7913156886117983`*^9}, {3.7913157982567043`*^9, 3.7913157989681387`*^9}, {
  3.7913163123171425`*^9, 3.7913163152016516`*^9}, {3.7913169128790393`*^9, 
  3.79131691370652*^9}, {3.7913179541875157`*^9, 3.791317955981479*^9}, {
  3.791318003982242*^9, 3.7913180048955665`*^9}, {3.791318776883281*^9, 
  3.791318779979024*^9}},
 CellLabel->
  "In[313]:=",ExpressionUUID->"27cafd9a-0a0b-48f5-ac60-4f1944199548"],

Cell[BoxData[
 FractionBox[
  RowBox[{"c", " ", "k", " ", "r", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"B", " ", 
      SuperscriptBox["k", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"c", "+", "r"}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["r", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"k", "+", "r"}], ")"}]}]}], ")"}]}], 
  RowBox[{
   RowBox[{"B", " ", "c", " ", 
    SuperscriptBox["k", "3"], " ", 
    RowBox[{"(", 
     RowBox[{"c", "+", "r"}], ")"}]}], "+", 
   RowBox[{
    SuperscriptBox["r", "3"], " ", 
    RowBox[{"(", 
     RowBox[{"k", "+", "r"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"c", "+", "k", "+", "r"}], ")"}]}]}]]], "Output",
 CellChangeTimes->{
  3.791315150853048*^9, 3.791315181208159*^9, 3.7913156894385185`*^9, 
   3.7913158005690465`*^9, 3.7913163160863705`*^9, 3.791316914598543*^9, {
   3.791317942137026*^9, 3.7913179661824465`*^9}, 3.791318012026579*^9, 
   3.7913187807569456`*^9, 3.79131895594804*^9},
 CellLabel->
  "Out[313]=",ExpressionUUID->"a45419cb-a7e4-4151-9639-237487a3b006"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"kon", "/.", " ", 
   RowBox[{"maxNeqSharp", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.791315622034313*^9, 3.7913156340325966`*^9}, {
  3.791315695465661*^9, 3.7913156957910624`*^9}},
 CellLabel->
  "In[314]:=",ExpressionUUID->"6e482cbc-6e4f-456f-8fa4-cadca3abf2f3"],

Cell[BoxData[
 FractionBox[
  RowBox[{"c", " ", 
   RowBox[{"(", 
    RowBox[{"1939.450113488972`", "\[VeryThinSpace]", "+", 
     RowBox[{"13.646940880243811`", " ", "c"}]}], ")"}]}], 
  RowBox[{"5.00160312515782`*^6", "+", 
   RowBox[{"c", " ", 
    RowBox[{"(", 
     RowBox[{"366385.12593496195`", "\[VeryThinSpace]", "+", 
      RowBox[{"1.`", " ", "c"}]}], ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.7913156228397207`*^9, 3.791315634402343*^9}, 
   3.791315696401679*^9, 3.7913158035113306`*^9, {3.791317942178915*^9, 
   3.7913179662203455`*^9}, 3.7913180120614843`*^9, 3.791318955985938*^9},
 CellLabel->
  "Out[314]=",ExpressionUUID->"73b08bef-6481-4282-ba48-41d18a433260"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solve for passage time from 4 to 2 (koff)", "Subsubsection",
 CellChangeTimes->{{3.79131355047433*^9, 
  3.7913135810711412`*^9}},ExpressionUUID->"1e365171-4ff3-473e-952a-\
f58f1fefa463"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqET12", " ", "=", " ", 
   RowBox[{"ET12", " ", "\[Equal]", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "/", 
      RowBox[{"QSimp", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "*", 
     RowBox[{"(", 
      RowBox[{"1", " ", "+", 
       RowBox[{
        RowBox[{"QSimp", "[", 
         RowBox[{"[", 
          RowBox[{"4", ",", "1"}], "]"}], "]"}], "*", "ET42"}]}], ")"}]}]}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.7903526643834977`*^9, 3.790352741300044*^9}, {
  3.790352771329322*^9, 3.7903527888450565`*^9}, {3.791312888006653*^9, 
  3.7913129009700956`*^9}, {3.7913133848850393`*^9, 3.7913133910476613`*^9}, {
  3.791313584254303*^9, 3.791313605898141*^9}, {3.791313645901484*^9, 
  3.791313651743742*^9}},
 CellLabel->
  "In[315]:=",ExpressionUUID->"81f80ac4-660f-4656-9ff6-3d80f8627f72"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqET42", " ", "=", " ", 
   RowBox[{"ET42", " ", "\[Equal]", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "/", 
      RowBox[{"QSimp", "[", 
       RowBox[{"[", 
        RowBox[{"4", ",", "4"}], "]"}], "]"}]}], "*", 
     RowBox[{"(", 
      RowBox[{"1", " ", "+", 
       RowBox[{
        RowBox[{"QSimp", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "4"}], "]"}], "]"}], "*", "ET12"}], "+", 
       RowBox[{
        RowBox[{"QSimp", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "4"}], "]"}], "]"}], "*", "ET32"}]}], ")"}]}]}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.7903527933020215`*^9, 3.7903528424044085`*^9}, {
  3.7913133993286*^9, 3.791313424300767*^9}, {3.791313588083866*^9, 
  3.791313601814184*^9}, {3.7913136734895716`*^9, 3.791313675062608*^9}, {
  3.7913137167370834`*^9, 3.791313742202791*^9}, {3.791313843419356*^9, 
  3.7913138614884624`*^9}, {3.791315881019945*^9, 3.791315883878998*^9}},
 CellLabel->
  "In[316]:=",ExpressionUUID->"b633d453-96b4-4c86-9312-2af3c4adf562"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqET32", " ", "=", " ", 
   RowBox[{"ET32", " ", "\[Equal]", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "/", 
      RowBox[{"QSimp", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "*", 
     RowBox[{"(", 
      RowBox[{"1", " ", "+", 
       RowBox[{
        RowBox[{"QSimp", "[", 
         RowBox[{"[", 
          RowBox[{"4", ",", "3"}], "]"}], "]"}], "*", "ET42"}]}], ")"}]}]}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.790352851392705*^9, 3.7903528757889843`*^9}, {
  3.7903529225947437`*^9, 3.7903529244056287`*^9}, {3.791313418972665*^9, 
  3.7913134340817003`*^9}, {3.791313591841917*^9, 3.7913135979937067`*^9}, {
  3.7913137583821955`*^9, 3.7913137614776154`*^9}},
 CellLabel->
  "In[317]:=",ExpressionUUID->"f87e5d71-8092-4854-a13f-0a7d2bd9b53c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solET2", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"eqET12", ",", "eqET42", ",", "eqET32"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"ET12", ",", "ET42", ",", "ET32"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7903529264441776`*^9, 3.790352990329671*^9}, {
   3.7913134385517063`*^9, 3.7913134614797373`*^9}, {3.7913137725287113`*^9, 
   3.7913137963076715`*^9}, 3.79131390468381*^9},
 CellLabel->
  "In[318]:=",ExpressionUUID->"3681a96c-627c-4f74-9deb-b85fef0067b3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ET12", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["k", "2"]}], "-", 
        RowBox[{"2", " ", "c", " ", "k", " ", "k4"}], "-", 
        RowBox[{"k", " ", "r"}], "-", 
        RowBox[{"c", " ", "k4", " ", "r"}], "-", 
        SuperscriptBox["r", "2"]}], 
       RowBox[{
        RowBox[{"c", " ", 
         SuperscriptBox["k", "2"], " ", "k4"}], "+", 
        RowBox[{
         SuperscriptBox["k", "2"], " ", "r"}], "+", 
        RowBox[{"k", " ", 
         SuperscriptBox["r", "2"]}], "+", 
        SuperscriptBox["r", "3"]}]]}]}], ",", 
    RowBox[{"ET42", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "c", " ", "k", " ", "k4"}], "-", 
        RowBox[{"3", " ", "k", " ", "r"}], "-", 
        RowBox[{"c", " ", "k4", " ", "r"}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["r", "2"]}]}], 
       RowBox[{
        RowBox[{"c", " ", 
         SuperscriptBox["k", "2"], " ", "k4"}], "+", 
        RowBox[{
         SuperscriptBox["k", "2"], " ", "r"}], "+", 
        RowBox[{"k", " ", 
         SuperscriptBox["r", "2"]}], "+", 
        SuperscriptBox["r", "3"]}]]}]}], ",", 
    RowBox[{"ET32", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "c"}], " ", "k", " ", "k4"}], "-", 
        RowBox[{"k", " ", "r"}], "-", 
        RowBox[{"c", " ", "k4", " ", "r"}], "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["r", "2"]}]}], 
       RowBox[{
        RowBox[{"c", " ", 
         SuperscriptBox["k", "2"], " ", "k4"}], "+", 
        RowBox[{
         SuperscriptBox["k", "2"], " ", "r"}], "+", 
        RowBox[{"k", " ", 
         SuperscriptBox["r", "2"]}], "+", 
        SuperscriptBox["r", "3"]}]]}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7913139049463654`*^9, {3.7913179423185425`*^9, 3.791317966354985*^9}, 
   3.7913180121861944`*^9, 3.7913189561185837`*^9},
 CellLabel->
  "Out[318]=",ExpressionUUID->"1aad21ee-99db-43b5-8591-40ef95b1f54e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Extract expression for first passage time from 2 to 4 \
(ET24)", "Text"]], "Subsubsection",
 CellChangeTimes->{{3.791313470923751*^9, 3.791313485345893*^9}, 
   3.7913151377624073`*^9, {3.791315188940875*^9, 3.791315189668083*^9}, 
   3.7913158174491587`*^9},ExpressionUUID->"cab977a8-6569-4574-aab3-\
5f7a7c415dca"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"koff", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ET42", " ", "/.", " ", 
       RowBox[{"solET2", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], " ", "/.", 
      RowBox[{"k4", "\[Rule]", "1"}]}], ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.791313489864895*^9, 3.7913135183543925`*^9}, {
   3.791313767958893*^9, 3.7913137683628893`*^9}, {3.7913138036954203`*^9, 
   3.7913138076894093`*^9}, {3.791315153896673*^9, 3.7913151856617985`*^9}, {
   3.791315704414291*^9, 3.791315709171497*^9}, 3.7913158208314185`*^9, {
   3.791316295374524*^9, 3.7913163004822865`*^9}, 3.7913169188783426`*^9, {
   3.791317924506312*^9, 3.791317926166171*^9}, {3.7913179996081095`*^9, 
   3.7913180003179235`*^9}, {3.7913187888821883`*^9, 3.791318791441203*^9}},
 CellLabel->
  "In[319]:=",ExpressionUUID->"8a8bb641-fdb8-4ab8-9959-f2a36a03676e"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"c", " ", 
    SuperscriptBox["k", "2"]}], "+", 
   RowBox[{"r", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["k", "2"], "+", 
      RowBox[{"k", " ", "r"}], "+", 
      SuperscriptBox["r", "2"]}], ")"}]}]}], 
  RowBox[{
   RowBox[{"c", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "k"}], "+", "r"}], ")"}]}], "+", 
   RowBox[{"r", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "k"}], "+", 
      RowBox[{"2", " ", "r"}]}], ")"}]}]}]]], "Output",
 CellChangeTimes->{
  3.7913134494059677`*^9, {3.7913135081631355`*^9, 3.7913135187441316`*^9}, {
   3.7913138237699156`*^9, 3.791313866991746*^9}, 3.791315155792573*^9, 
   3.7913151864818087`*^9, 3.7913157097984576`*^9, {3.7913158217160754`*^9, 
   3.7913158446223907`*^9}, 3.7913163015821953`*^9, 3.791316926908783*^9, {
   3.791317926894366*^9, 3.7913179665165544`*^9}, 3.791318012343313*^9, 
   3.79131879205556*^9, 3.791318956240299*^9},
 CellLabel->
  "Out[319]=",ExpressionUUID->"71ad8860-1961-4da2-9215-5f391122c455"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Interesting...it looks like it should be possible to have our \
\[OpenCurlyDoubleQuote]koff\[CloseCurlyDoubleQuote] (ET42) be proportional to \
1/c : k << r <<c*k4 (i.e. c)\
\>", "Subsection",
 CellChangeTimes->{{3.7913152363901234`*^9, 3.791315295619318*^9}, {
  3.7913163408554688`*^9, 3.7913163624003177`*^9}, {3.79131648388745*^9, 
  3.791316486493483*^9}},ExpressionUUID->"3008d616-06ff-4a1e-a453-\
890d93adb395"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"koffSimp", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{"koff", ",", 
       RowBox[{"{", 
        RowBox[{"k", "\[Equal]", 
         RowBox[{
          RowBox[{"r", "^", "2"}], "/", "c"}]}], "}"}]}], "]"}], " ", "/.", 
     " ", 
     RowBox[{"k", "\[Rule]", 
      RowBox[{
       RowBox[{"r", "^", "2"}], "/", "c"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7913186832427664`*^9, 3.791318710831402*^9}, 
   3.7913188052034535`*^9, {3.7913254864026175`*^9, 3.791325710729638*^9}, 
   3.7913258675229373`*^9},ExpressionUUID->"c93ce166-7b1a-4e86-9d91-\
1cd63b7556e2"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["r", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"c", "+", "r"}], ")"}]}], 
  RowBox[{"c", " ", 
   RowBox[{"(", 
    RowBox[{"c", "+", 
     RowBox[{"3", " ", "r"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{
  3.791325509472764*^9, {3.7913255441523347`*^9, 3.7913255974410515`*^9}, 
   3.791325645091999*^9, {3.791325687338217*^9, 3.7913257118499136`*^9}},
 CellLabel->
  "Out[333]=",ExpressionUUID->"2e2700e1-7f45-43b4-b139-c17caaeb6f93"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"konSimp", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"kon", ",", 
      RowBox[{"{", 
       RowBox[{"k", "\[Equal]", 
        RowBox[{
         RowBox[{"r", "^", "2"}], "/", "c"}]}], "}"}]}], "]"}], " ", "/.", 
    " ", 
    RowBox[{"k", "\[Rule]", 
     RowBox[{
      RowBox[{"r", "^", "2"}], "/", "c"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.791325717453491*^9, 3.7913257228217716`*^9}},
 CellLabel->
  "In[335]:=",ExpressionUUID->"392b1b32-b46d-4a57-b655-125ae3b38f70"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["r", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"c", "+", 
     RowBox[{"B", " ", "r"}]}], ")"}]}], 
  RowBox[{
   SuperscriptBox["c", "2"], "+", 
   RowBox[{"c", " ", "r"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", "B"}], ")"}], " ", 
    SuperscriptBox["r", "2"]}]}]]], "Output",
 CellChangeTimes->{{3.791325719295081*^9, 3.7913257235074625`*^9}},
 CellLabel->
  "Out[335]=",ExpressionUUID->"7c172667-8d2f-4cb6-9ea4-d15eec0bfe9d"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1920, 1037},
WindowMargins->{{1912, Automatic}, {Automatic, -8}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 163, 3, 96, "Title",ExpressionUUID->"510d2138-3d96-4498-b37b-70a3be022443"],
Cell[CellGroupData[{
Cell[768, 29, 201, 3, 67, "Chapter",ExpressionUUID->"e89786e2-ecd8-4670-9d08-10b8df41da79"],
Cell[972, 34, 274, 5, 28, "Input",ExpressionUUID->"5c68a1e7-9bf7-4c39-9d7d-7fe41ed623c2"],
Cell[1249, 41, 1116, 31, 28, "Input",ExpressionUUID->"2b6677bb-1d2b-4c83-9d0c-a6af206be5c1"],
Cell[CellGroupData[{
Cell[2390, 76, 212, 4, 28, "Input",ExpressionUUID->"d9de4471-813b-4860-9c33-d135237cd20a"],
Cell[2605, 82, 1328, 38, 96, "Output",ExpressionUUID->"e994a4e8-db91-4d4f-bcce-3d193b52da5b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3970, 125, 209, 4, 28, "Input",ExpressionUUID->"1dc7c2f1-b420-4cb0-b033-1568ff228220"],
Cell[4182, 131, 422, 8, 32, "Output",ExpressionUUID->"892ff3b7-d446-4b74-ae67-4811b9c58539"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4641, 144, 189, 3, 44, "Subsubsection",ExpressionUUID->"ce51f104-4f4c-426d-ae6b-043cae1e37af"],
Cell[4833, 149, 331, 7, 34, "Text",ExpressionUUID->"cdc10c9f-19ab-475f-a04d-5e21786fce88"],
Cell[5167, 158, 806, 21, 28, "Input",ExpressionUUID->"c4d5b281-972d-4df4-aa77-7e3c89234881"],
Cell[CellGroupData[{
Cell[5998, 183, 218, 4, 28, "Input",ExpressionUUID->"a3af0e16-1954-4382-bb0d-392dfdbdeb31"],
Cell[6219, 189, 1554, 44, 128, "Output",ExpressionUUID->"2cf57ec2-2a16-491f-946d-5d0ff9f9bc83"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7810, 238, 210, 4, 28, "Input",ExpressionUUID->"5619d43a-0753-426d-82b3-b2c0d172744e"],
Cell[8023, 244, 397, 8, 32, "Output",ExpressionUUID->"4b070dfd-f186-481f-a75a-3d197edf05f4"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[8469, 258, 253, 6, 44, "Subsubsection",ExpressionUUID->"21978a00-dd83-4d10-9520-33a396244e7e"],
Cell[8725, 266, 279, 6, 28, "Input",ExpressionUUID->"c6d84068-7cf2-4470-b15b-7c949ae299ad"],
Cell[9007, 274, 527, 13, 28, "Input",ExpressionUUID->"30324ce1-9219-439a-828a-efc6046e1c17"],
Cell[CellGroupData[{
Cell[9559, 291, 301, 7, 28, "Input",ExpressionUUID->"645b2fb8-57d9-498e-b075-f1182afe0721"],
Cell[9863, 300, 1589, 48, 63, "Output",ExpressionUUID->"2bc068a5-fd78-49e7-896f-809d8810009c"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[11513, 355, 196, 3, 67, "Chapter",ExpressionUUID->"fb04d331-987a-4941-ace9-cb682ecde211"],
Cell[11712, 360, 341, 8, 28, "Input",ExpressionUUID->"7cda3f93-ab4f-4b17-8c14-b0ffcb27320d"],
Cell[CellGroupData[{
Cell[12078, 372, 238, 4, 45, "Subsubsection",ExpressionUUID->"554408cb-8c2f-44af-acf3-a9a42abab80f"],
Cell[CellGroupData[{
Cell[12341, 380, 426, 10, 28, "Input",ExpressionUUID->"f6351c9e-0b2b-408e-ad70-a39677036398"],
Cell[12770, 392, 637, 17, 63, "Output",ExpressionUUID->"2ae73080-8641-49ea-9361-c8463d8ff8de"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13444, 414, 553, 14, 28, "Input",ExpressionUUID->"5f3c1b64-7bee-4de6-adde-f72d7172a8eb"],
Cell[14000, 430, 621, 14, 32, "Output",ExpressionUUID->"4a7aa02d-c530-43cf-bf16-29bd2c1e33f2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14658, 449, 451, 12, 28, "Input",ExpressionUUID->"d08a8539-51e8-433e-af23-85db4b37df97"],
Cell[15112, 463, 481, 9, 32, "Output",ExpressionUUID->"2d1d9922-3356-4448-bf7c-7ecc33d432c2"]
}, Open  ]]
}, Open  ]],
Cell[15620, 476, 356, 5, 39, "Subsubsection",ExpressionUUID->"3747f67b-c060-42d3-a560-edd39d2aa3f2"],
Cell[CellGroupData[{
Cell[16001, 485, 178, 3, 37, "Subsection",ExpressionUUID->"f977cc91-657a-44cb-af04-6ea58a9886b5"],
Cell[CellGroupData[{
Cell[16204, 492, 375, 8, 28, "Input",ExpressionUUID->"ebe05e68-7acc-43e2-b81d-e1ea7fdb83d5"],
Cell[16582, 502, 2774, 83, 63, "Output",ExpressionUUID->"74600e77-b2cc-4cea-9344-3ed6c3f406f2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19393, 590, 600, 15, 28, "Input",ExpressionUUID->"86cade6c-c428-4407-8c07-f6166ae4cc88"],
Cell[19996, 607, 670, 14, 32, "Output",ExpressionUUID->"3d494021-91a9-435d-ba20-9a014c55ceac"]
}, Open  ]],
Cell[20681, 624, 257, 6, 34, "Text",ExpressionUUID->"5e9d069c-d903-4e85-b8e0-603f331a5993"],
Cell[CellGroupData[{
Cell[20963, 634, 394, 10, 28, "Input",ExpressionUUID->"14bf033b-4cc7-4ddf-b494-81f2c7f84de7"],
Cell[21360, 646, 458, 10, 32, "Output",ExpressionUUID->"2776cc03-789a-4a88-9c16-70bff7af53bf"]
}, Open  ]],
Cell[21833, 659, 253, 6, 34, "Text",ExpressionUUID->"6240a9e1-5ca7-44f3-a2ff-83e74d5e084c"],
Cell[CellGroupData[{
Cell[22111, 669, 425, 10, 28, "Input",ExpressionUUID->"f8ae596f-6712-4bf4-a27c-c57beab63236"],
Cell[22539, 681, 653, 19, 63, "Output",ExpressionUUID->"f9430afd-841d-47f4-ab89-6ddd26bcc454"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23229, 705, 512, 13, 28, "Input",ExpressionUUID->"7dd574fb-c5b0-4c71-b771-d54c2c334190"],
Cell[23744, 720, 569, 14, 32, "Output",ExpressionUUID->"652e2a3a-fc5c-42a5-800e-257fdbd9c57e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[24362, 740, 306, 5, 70, "Subsection",ExpressionUUID->"377271d5-5a05-4c87-b288-7417575bda3f"],
Cell[CellGroupData[{
Cell[24693, 749, 192, 3, 44, "Subsubsection",ExpressionUUID->"0abe34f0-32a8-4cd9-b2a2-d6d505faa688"],
Cell[24888, 754, 786, 21, 28, "Input",ExpressionUUID->"038697b6-f241-4d74-9319-c88b70856fe0"],
Cell[25677, 777, 823, 24, 28, "Input",ExpressionUUID->"8880b232-9168-451c-8524-dc5e717e0645"],
Cell[26503, 803, 738, 21, 28, "Input",ExpressionUUID->"aa027e16-35af-4250-82b8-ee3a4304d80f"],
Cell[27244, 826, 487, 13, 28, "Input",ExpressionUUID->"deff2ac0-f3ae-4b24-9d2d-690792f21667"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27768, 844, 393, 6, 39, "Subsubsection",ExpressionUUID->"948039f0-9807-4f72-a467-f92a3a8b409e"],
Cell[CellGroupData[{
Cell[28186, 854, 882, 18, 28, "Input",ExpressionUUID->"27cafd9a-0a0b-48f5-ac60-4f1944199548"],
Cell[29071, 874, 1055, 30, 63, "Output",ExpressionUUID->"a45419cb-a7e4-4151-9639-237487a3b006"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30163, 909, 362, 8, 28, "Input",ExpressionUUID->"6e482cbc-6e4f-456f-8fa4-cadca3abf2f3"],
Cell[30528, 919, 684, 15, 61, "Output",ExpressionUUID->"73b08bef-6481-4282-ba48-41d18a433260"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[31261, 940, 193, 3, 44, "Subsubsection",ExpressionUUID->"1e365171-4ff3-473e-952a-f58f1fefa463"],
Cell[31457, 945, 884, 23, 28, "Input",ExpressionUUID->"81f80ac4-660f-4656-9ff6-3d80f8627f72"],
Cell[32344, 970, 1068, 27, 28, "Input",ExpressionUUID->"b633d453-96b4-4c86-9312-2af3c4adf562"],
Cell[33415, 999, 839, 22, 28, "Input",ExpressionUUID->"f87e5d71-8092-4854-a13f-0a7d2bd9b53c"],
Cell[CellGroupData[{
Cell[34279, 1025, 536, 12, 28, "Input",ExpressionUUID->"3681a96c-627c-4f74-9deb-b85fef0067b3"],
Cell[34818, 1039, 2150, 62, 61, "Output",ExpressionUUID->"1aad21ee-99db-43b5-8591-40ef95b1f54e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[37017, 1107, 340, 5, 39, "Subsubsection",ExpressionUUID->"cab977a8-6569-4574-aab3-5f7a7c415dca"],
Cell[CellGroupData[{
Cell[37382, 1116, 931, 18, 28, "Input",ExpressionUUID->"8a8bb641-fdb8-4ab8-9959-f2a36a03676e"],
Cell[38316, 1136, 1070, 29, 61, "Output",ExpressionUUID->"71ad8860-1961-4da2-9215-5f391122c455"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[39447, 1172, 428, 8, 53, "Subsection",ExpressionUUID->"3008d616-06ff-4a1e-a453-890d93adb395"],
Cell[CellGroupData[{
Cell[39900, 1184, 675, 18, 28, "Input",ExpressionUUID->"c93ce166-7b1a-4e86-9d91-1cd63b7556e2"],
Cell[40578, 1204, 495, 14, 61, "Output",ExpressionUUID->"2e2700e1-7f45-43b4-b139-c17caaeb6f93"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41110, 1223, 565, 16, 28, "Input",ExpressionUUID->"392b1b32-b46d-4a57-b655-125ae3b38f70"],
Cell[41678, 1241, 505, 16, 63, "Output",ExpressionUUID->"7c172667-8d2f-4cb6-9ea4-d15eec0bfe9d"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

