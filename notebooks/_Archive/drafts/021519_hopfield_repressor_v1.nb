(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     33653,        837]
NotebookOptionsPosition[     30638,        779]
NotebookOutlinePosition[     30981,        794]
CellTagsIndexPosition[     30938,        791]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 StyleBox["Solution to general 3 state model with forward k rates and reverse \
r rates", "Subsubsection"],
 StyleBox[" ", "Subsection"]
}], "Text",
 CellChangeTimes->{{3.750384041936879*^9, 3.7503840629025908`*^9}, {
  3.7541376872592278`*^9, 3.7541376890619497`*^9}, {3.7595861352753177`*^9, 
  3.759586136109088*^9}},ExpressionUUID->"d1518c95-f8f3-413c-b038-\
17f90c0a1e60"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ass", "=", 
   RowBox[{"{", " ", 
    RowBox[{
     RowBox[{"koff", ">", "0"}], " ", ",", " ", 
     RowBox[{"km", ">", "0"}], ",", " ", 
     RowBox[{"kp", ">", "0"}], ",", " ", 
     RowBox[{"kon", ">", "0"}], ",", " ", 
     RowBox[{"c0", "<", "c1"}], ",", " ", 
     RowBox[{"c1", ">", "0"}], ",", " ", 
     RowBox[{"c0", ">", "0"}], ",", " ", 
     RowBox[{"b", " ", ">", " ", "1"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.750345019237339*^9, 3.7503450539523153`*^9}, {
  3.7541376911164703`*^9, 3.754137691796073*^9}, {3.754139973332193*^9, 
  3.754140007229397*^9}, {3.754142059571416*^9, 3.754142059771084*^9}, {
  3.754143332172714*^9, 3.75414333445453*^9}, {3.754143472486924*^9, 
  3.754143474028854*^9}, {3.7571713474989743`*^9, 3.757171356767172*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"c95437b1-8467-44ee-b3ad-5728a54b961b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"J", ",", "J", ",", "J", ",", "1"}], "}"}], "\[Equal]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"k1", " ", "p1"}], " ", "-", " ", 
         RowBox[{"r1", " ", "p2"}]}], ",", " ", 
        RowBox[{
         RowBox[{"k2", " ", "p2"}], " ", "-", " ", 
         RowBox[{"r2", " ", "p3"}]}], ",", " ", 
        RowBox[{
         RowBox[{"k3", " ", "p3"}], " ", "-", " ", 
         RowBox[{"r3", " ", "p1"}]}], ",", " ", 
        RowBox[{"p1", "+", "p2", "+", "p3"}]}], "}"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"J", ",", " ", "p1", ",", "p2", ",", "p3"}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7450741599696827`*^9, 3.7450741968805532`*^9}, {
   3.750343738376728*^9, 3.750343740147134*^9}, {3.750357778746254*^9, 
   3.750357778821937*^9}, {3.7541379940669727`*^9, 3.754137994633065*^9}, {
   3.754139921940263*^9, 3.7541399257643223`*^9}, {3.754142072152648*^9, 
   3.754142076472227*^9}, 3.7541445815119257`*^9, {3.7595861307414*^9, 
   3.7595861618023653`*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"7fb5bbc1-0e7f-4bb4-a355-efe1fde738a9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"J", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"k1", " ", "k2", " ", "k3"}], "-", 
       RowBox[{"r1", " ", "r2", " ", "r3"}]}], 
      RowBox[{
       RowBox[{"r1", " ", 
        RowBox[{"(", 
         RowBox[{"k3", "+", "r2"}], ")"}]}], "+", 
       RowBox[{"k1", " ", 
        RowBox[{"(", 
         RowBox[{"k2", "+", "k3", "+", "r2"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"r1", "+", "r2"}], ")"}], " ", "r3"}], "+", 
       RowBox[{"k2", " ", 
        RowBox[{"(", 
         RowBox[{"k3", "+", "r3"}], ")"}]}]}]]}], ",", 
    RowBox[{"p1", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"k2", " ", "k3"}], "+", 
       RowBox[{"r1", " ", 
        RowBox[{"(", 
         RowBox[{"k3", "+", "r2"}], ")"}]}]}], 
      RowBox[{
       RowBox[{"r1", " ", 
        RowBox[{"(", 
         RowBox[{"k3", "+", "r2"}], ")"}]}], "+", 
       RowBox[{"k1", " ", 
        RowBox[{"(", 
         RowBox[{"k2", "+", "k3", "+", "r2"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"r1", "+", "r2"}], ")"}], " ", "r3"}], "+", 
       RowBox[{"k2", " ", 
        RowBox[{"(", 
         RowBox[{"k3", "+", "r3"}], ")"}]}]}]]}], ",", 
    RowBox[{"p2", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"k1", " ", 
        RowBox[{"(", 
         RowBox[{"k3", "+", "r2"}], ")"}]}], "+", 
       RowBox[{"r2", " ", "r3"}]}], 
      RowBox[{
       RowBox[{"r1", " ", 
        RowBox[{"(", 
         RowBox[{"k3", "+", "r2"}], ")"}]}], "+", 
       RowBox[{"k1", " ", 
        RowBox[{"(", 
         RowBox[{"k2", "+", "k3", "+", "r2"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"r1", "+", "r2"}], ")"}], " ", "r3"}], "+", 
       RowBox[{"k2", " ", 
        RowBox[{"(", 
         RowBox[{"k3", "+", "r3"}], ")"}]}]}]]}], ",", 
    RowBox[{"p3", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"k1", " ", "k2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"k2", "+", "r1"}], ")"}], " ", "r3"}]}], 
      RowBox[{
       RowBox[{"r1", " ", 
        RowBox[{"(", 
         RowBox[{"k3", "+", "r2"}], ")"}]}], "+", 
       RowBox[{"k1", " ", 
        RowBox[{"(", 
         RowBox[{"k2", "+", "k3", "+", "r2"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"r1", "+", "r2"}], ")"}], " ", "r3"}], "+", 
       RowBox[{"k2", " ", 
        RowBox[{"(", 
         RowBox[{"k3", "+", "r3"}], ")"}]}]}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.754409976383402*^9, 3.7571712673519435`*^9, 3.7571730638906927`*^9, 
   3.7578875825609393`*^9, 3.7578879920047026`*^9, 3.7582963282311115`*^9, 
   3.7583006715272837`*^9, 3.75830136436893*^9, {3.7583015644205933`*^9, 
   3.7583015791851473`*^9}, 3.759453364611349*^9, 3.759453732637572*^9, 
   3.7594550280213284`*^9, 3.7595861633901577`*^9, 3.7595871271476707`*^9},
 CellLabel->"Out[84]=",ExpressionUUID->"edeac353-7667-48fe-89f8-10e85adb042a"]
}, Open  ]],

Cell[TextData[StyleBox["Our specific system has symmetry, concentration \
dependence of repressor binding (c) and energy input (b) on edge from state \
4->1. when b = 1 then the system obeys detailed balance by construction", \
"Subsubsection"]], "Text",
 CellChangeTimes->{{3.750384069847657*^9, 3.750384073926244*^9}, {
  3.75413811648597*^9, 3.754138144004209*^9}, {3.754138220034409*^9, 
  3.754138238383642*^9}, {3.754139444317975*^9, 3.754139471025515*^9}, {
  3.754409984809718*^9, 3.754409985084999*^9}, {3.758295327678581*^9, 
  3.758295336182712*^9}},ExpressionUUID->"57476a6a-3be2-4c96-bdb7-\
d81fff26d895"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"symSol", " ", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"sol", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"k1", "\[Rule]", " ", "kon"}], ",", " ", 
      RowBox[{"r1", "\[Rule]", " ", 
       RowBox[{"c", " ", "koff1"}]}], ",", " ", 
      RowBox[{"k2", "\[Rule]", " ", "b"}], " ", ",", " ", 
      RowBox[{"r2", "\[Rule]", " ", "1"}], ",", " ", 
      RowBox[{"k3", "\[Rule]", "  ", 
       RowBox[{"c", " ", "koff2"}]}], ",", " ", 
      RowBox[{"r3", "\[Rule]", " ", "kon"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.750270828442218*^9, 3.7502709253892717`*^9}, {
   3.750271135055722*^9, 3.7502711415787287`*^9}, {3.750273120141753*^9, 
   3.7502731252525797`*^9}, 3.750273174328928*^9, {3.75034470917811*^9, 
   3.7503447093443947`*^9}, {3.750357805818123*^9, 3.750357835662365*^9}, {
   3.75413825427017*^9, 3.754138272719884*^9}, {3.7579414376414356`*^9, 
   3.757941458583452*^9}, {3.7583003780482273`*^9, 3.758300409232848*^9}, {
   3.758300467486315*^9, 3.758300476238916*^9}, {3.7583006190731287`*^9, 
   3.7583006203328075`*^9}, {3.7583007174709406`*^9, 3.758300727144079*^9}, {
   3.7583009739662275`*^9, 3.7583010490271235`*^9}, {3.7583010892332993`*^9, 
   3.758301093938719*^9}, {3.758301190693799*^9, 3.7583012027984395`*^9}, {
   3.758301557093184*^9, 3.7583015766628914`*^9}, {3.759453277451056*^9, 
   3.7594533431975265`*^9}, {3.7594534039102955`*^9, 3.759453404232404*^9}, {
   3.759455014300742*^9, 3.759455024487069*^9}, {3.7595861816483297`*^9, 
   3.759586249102011*^9}, {3.7595862799286532`*^9, 3.7595862971186614`*^9}, 
   3.759586472660438*^9, {3.75958926945065*^9, 3.7595892844298077`*^9}},
 CellLabel->
  "In[129]:=",ExpressionUUID->"4d1ce54a-26aa-4a0e-866a-5330bf9dd464"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"J", "\[Rule]", 
     FractionBox[
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "koff1"}], "+", 
         RowBox[{"b", " ", "koff2"}]}], ")"}], " ", "kon"}], 
      RowBox[{
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{"koff1", "+", 
          RowBox[{"b", " ", "koff2"}], "+", 
          RowBox[{"c", " ", "koff1", " ", "koff2"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "+", 
          RowBox[{"2", " ", "b"}], "+", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{"koff1", "+", "koff2"}], ")"}]}]}], ")"}], " ", 
        "kon"}]}]]}], ",", 
    RowBox[{"p1", "\[Rule]", 
     FractionBox[
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{"koff1", "+", 
         RowBox[{"b", " ", "koff2"}], "+", 
         RowBox[{"c", " ", "koff1", " ", "koff2"}]}], ")"}]}], 
      RowBox[{
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{"koff1", "+", 
          RowBox[{"b", " ", "koff2"}], "+", 
          RowBox[{"c", " ", "koff1", " ", "koff2"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "+", 
          RowBox[{"2", " ", "b"}], "+", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{"koff1", "+", "koff2"}], ")"}]}]}], ")"}], " ", 
        "kon"}]}]]}], ",", 
    RowBox[{"p2", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{"c", " ", "koff2"}]}], ")"}], " ", "kon"}], 
      RowBox[{
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{"koff1", "+", 
          RowBox[{"b", " ", "koff2"}], "+", 
          RowBox[{"c", " ", "koff1", " ", "koff2"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "+", 
          RowBox[{"2", " ", "b"}], "+", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{"koff1", "+", "koff2"}], ")"}]}]}], ")"}], " ", 
        "kon"}]}]]}], ",", 
    RowBox[{"p3", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "b"}], "+", 
         RowBox[{"c", " ", "koff1"}]}], ")"}], " ", "kon"}], 
      RowBox[{
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{"koff1", "+", 
          RowBox[{"b", " ", "koff2"}], "+", 
          RowBox[{"c", " ", "koff1", " ", "koff2"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "+", 
          RowBox[{"2", " ", "b"}], "+", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{"koff1", "+", "koff2"}], ")"}]}]}], ")"}], " ", 
        "kon"}]}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.750270919819333*^9, 3.750270925973634*^9}, 
   3.750271142598151*^9, 3.750273125986121*^9, 3.750273175023505*^9, 
   3.750343772690199*^9, 3.75034471093965*^9, 3.75035780658092*^9, 
   3.75035783684374*^9, {3.7541382417816057`*^9, 3.754138273639433*^9}, 
   3.754142623945938*^9, 3.7541434792438393`*^9, 3.7541442793190804`*^9, 
   3.7541445868881187`*^9, 3.754409987836501*^9, 3.7571712678196926`*^9, 
   3.7571730643025894`*^9, 3.7578875829275*^9, 3.757887992033626*^9, 
   3.757941462243665*^9, 3.758296331573591*^9, 3.7583004111955996`*^9, {
   3.758300672020931*^9, 3.7583007217684526`*^9}, 3.7583010502379365`*^9, 
   3.7583011059695525`*^9, 3.758301203924429*^9, 3.758301364406782*^9, {
   3.7583015647686615`*^9, 3.758301579410545*^9}, 3.759453364942443*^9, 
   3.7594534088625207`*^9, 3.759453732703364*^9, 3.7594550284242673`*^9, 
   3.7595862163525515`*^9, 3.7595862502170305`*^9, 3.759586298483037*^9, 
   3.7595864748486233`*^9, 3.759587127204487*^9, 3.7595892875680976`*^9},
 CellLabel->
  "Out[129]=",ExpressionUUID->"108893ed-1fdd-47c0-9a01-f96b03961502"]
}, Open  ]],

Cell[TextData[StyleBox["We are treating state 3 as the productive state - \
i.e. the one in which transcription happens.", "Subsubsection"]], "Text",
 CellChangeTimes->{{3.754138276459917*^9, 3.754138333055722*^9}, {
  3.754138513073224*^9, 3.754138513839487*^9}, {3.754138654558078*^9, 
  3.754138728796371*^9}, {3.754409995772583*^9, 3.754410002669238*^9}, {
  3.758304079293707*^9, 
  3.7583040797006235`*^9}},ExpressionUUID->"19646b47-4fc7-459f-8a88-\
4f006c354ecf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"p3cb", "[", "c_", "]"}], " ", "=", " ", 
  RowBox[{"p3", "/.", " ", 
   RowBox[{"symSol", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.758301275763713*^9, 3.758301311410923*^9}, {
  3.758301412432386*^9, 3.758301416237214*^9}, {3.7583014575268335`*^9, 
  3.7583014589201517`*^9}, {3.759586220798667*^9, 3.759586221492811*^9}, {
  3.759587027912897*^9, 3.7595870279298887`*^9}},
 CellLabel->
  "In[130]:=",ExpressionUUID->"382bb689-d39c-46d8-928d-de06798b10fb"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "b"}], "+", 
     RowBox[{"c", " ", "koff1"}]}], ")"}], " ", "kon"}], 
  RowBox[{
   RowBox[{"c", " ", 
    RowBox[{"(", 
     RowBox[{"koff1", "+", 
      RowBox[{"b", " ", "koff2"}], "+", 
      RowBox[{"c", " ", "koff1", " ", "koff2"}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", "+", 
      RowBox[{"2", " ", "b"}], "+", 
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{"koff1", "+", "koff2"}], ")"}]}]}], ")"}], " ", 
    "kon"}]}]]], "Output",
 CellChangeTimes->{{3.7583012907466555`*^9, 3.7583013134275312`*^9}, 
   3.75830136443371*^9, 3.7583014192431793`*^9, 3.7583014609586596`*^9, {
   3.758301564796589*^9, 3.7583015794414616`*^9}, {3.759453364963386*^9, 
   3.759453379457245*^9}, 3.7594534141951466`*^9, 3.759453732728297*^9, 
   3.75945502844325*^9, 3.7595862226696663`*^9, 3.7595863041059866`*^9, 
   3.75958647709659*^9, 3.759587028971068*^9, 3.759587080434532*^9, 
   3.759587127221442*^9, 3.759589290225663*^9},
 CellLabel->
  "Out[130]=",ExpressionUUID->"3425e77b-81f2-4c0e-9043-ddfb22e81600"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"p3cb", "[", "c_", "]"}], " ", "=", " ", 
    FractionBox[
     RowBox[{"kon", " ", "kp", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", " ", "koff"}], "+", 
        RowBox[{"b", " ", 
         RowBox[{"(", 
          RowBox[{"km", "+", "kon", "+", "kp"}], ")"}]}]}], ")"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", " ", "koff"}], "+", "kon"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["km", "2"], "+", 
        RowBox[{"c", " ", "koff", " ", "kp"}], "+", 
        RowBox[{"b", " ", "kp", " ", 
         RowBox[{"(", 
          RowBox[{"kon", "+", "kp"}], ")"}]}], "+", 
        RowBox[{"km", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"c", " ", "koff"}], "+", "kon", "+", "kp", "+", 
           RowBox[{"b", " ", "kp"}]}], ")"}]}]}], ")"}]}]]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.750270828442218*^9, 3.7502709253892717`*^9}, {
   3.750271135055722*^9, 3.7502711415787287`*^9}, {3.750273120141753*^9, 
   3.7502731252525797`*^9}, 3.750273174328928*^9, {3.75034470917811*^9, 
   3.7503447093443947`*^9}, {3.750357805818123*^9, 3.750357835662365*^9}, {
   3.75413825427017*^9, 3.754138272719884*^9}, {3.75413874371506*^9, 
   3.754138837305544*^9}, {3.754142263007573*^9, 3.754142265582119*^9}, 
   3.7579414943068676`*^9, 3.7579415653539877`*^9, {3.7582965934639215`*^9, 
   3.7582965953004627`*^9}, 3.758300423689355*^9, 3.7583004996962023`*^9, 
   3.7583007087971306`*^9, 3.7583010579223423`*^9, 3.7583011158640976`*^9, {
   3.7583013497519636`*^9, 3.758301349964393*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"5335b349-278a-4278-9db8-36a1606a1160"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"p3c", "[", "c_", "]"}], " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"p3cb", "[", "c", "]"}], " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{"b", " ", "\[Rule]", " ", "1"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7579418506015167`*^9, 3.7579418532893286`*^9}},
 FontWeight->"Plain",
 CellLabel->
  "In[131]:=",ExpressionUUID->"29caa98b-827d-4d0f-bbc5-3529f63893b5"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"2", "+", 
     RowBox[{"c", " ", "koff1"}]}], ")"}], " ", "kon"}], 
  RowBox[{
   RowBox[{
    SuperscriptBox["c", "2"], " ", "koff1", " ", "koff2"}], "+", 
   RowBox[{"4", " ", "kon"}], "+", 
   RowBox[{"c", " ", 
    RowBox[{"(", 
     RowBox[{"koff1", "+", "koff2"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "kon"}], ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.7541388082074537`*^9, 3.754138840663299*^9}, 
   3.7541426240271187`*^9, 3.754143479343245*^9, 3.754144279399077*^9, 
   3.754144599363389*^9, 3.754410005935557*^9, 3.757171267909452*^9, 
   3.7571730644432144`*^9, 3.7578879921343565`*^9, {3.757941476694544*^9, 
   3.7579414967054534`*^9}, {3.757941543588135*^9, 3.7579415692455826`*^9}, 
   3.757941854669639*^9, 3.758296601976116*^9, 3.7583004301421037`*^9, 
   3.7583006721625524`*^9, 3.7583010627983074`*^9, 3.7583011205727596`*^9, {
   3.7583013382492075`*^9, 3.758301364477635*^9}, 3.758301467905596*^9, {
   3.7583015648454566`*^9, 3.758301579488337*^9}, {3.759453365031205*^9, 
   3.759453386227974*^9}, 3.759453427399827*^9, 3.759453732753229*^9, 
   3.7594550285898237`*^9, 3.75958631341112*^9, 3.7595864802581663`*^9, 
   3.759587033346408*^9, 3.759587084723081*^9, 3.7595871272474084`*^9, 
   3.7595892954710884`*^9},
 CellLabel->
  "Out[131]=",ExpressionUUID->"855f3496-42d1-47df-bbe9-dec560a56093"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculate fidelity ratios in/out of equilibrium", "Subsubsection",
 CellChangeTimes->{
  3.7578882507802095`*^9},ExpressionUUID->"87de3d82-d3a6-4441-a929-\
c6412d28cd6e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"eqRatio", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"p3c", "[", "c0", "]"}], " ", "/", " ", 
    RowBox[{"p3c", "[", "c1", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"noneqRatio", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"p3cb", "[", "c0", "]"}], " ", "/", " ", 
    RowBox[{"p3cb", "[", "c1", "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.754142610648045*^9, 3.7541426633604*^9}, {
  3.754143075787678*^9, 3.7541430849103813`*^9}, {3.7544097702047853`*^9, 
  3.7544097708120832`*^9}, {3.754410035553958*^9, 3.754410046050346*^9}, {
  3.7578874150656567`*^9, 3.7578874156121974`*^9}, {3.757941657732047*^9, 
  3.7579416647548103`*^9}, {3.75945357903821*^9, 3.759453587372927*^9}, {
  3.7595866667749414`*^9, 3.7595866766754427`*^9}},
 CellLabel->
  "In[132]:=",ExpressionUUID->"a3260b4f-c2f6-4d0a-b124-5046d4161368"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"2", "+", 
     RowBox[{"c0", " ", "koff1"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["c1", "2"], " ", "koff1", " ", "koff2"}], "+", 
     RowBox[{"4", " ", "kon"}], "+", 
     RowBox[{"c1", " ", 
      RowBox[{"(", 
       RowBox[{"koff1", "+", "koff2"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "kon"}], ")"}]}]}], ")"}]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"2", "+", 
     RowBox[{"c1", " ", "koff1"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["c0", "2"], " ", "koff1", " ", "koff2"}], "+", 
     RowBox[{"4", " ", "kon"}], "+", 
     RowBox[{"c0", " ", 
      RowBox[{"(", 
       RowBox[{"koff1", "+", "koff2"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "kon"}], ")"}]}]}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.75414265191422*^9, 3.7541426642104197`*^9}, 
   3.7541430855279493`*^9, 3.754143479476502*^9, 3.754144279523181*^9, 
   3.7541446167749863`*^9, 3.7544100489222527`*^9, 3.757171268030129*^9, 
   3.7571730645499277`*^9, 3.757887992297921*^9, 3.7579415870415225`*^9, 
   3.7579416658718243`*^9, 3.7579418644999046`*^9, 3.758296620081482*^9, 
   3.758300438403019*^9, 3.758300672307169*^9, 3.7583010658521414`*^9, 
   3.7583011237522945`*^9, 3.758301364507513*^9, 3.7583014720255804`*^9, {
   3.758301564873386*^9, 3.758301579519257*^9}, 3.759453365740102*^9, 
   3.7594534325362673`*^9, 3.759453589725153*^9, 3.7594537327941236`*^9, 
   3.759455029091584*^9, 3.759586321698962*^9, 3.7595866775889997`*^9, 
   3.7595870359932976`*^9, 3.759587087743111*^9, 3.759587127315191*^9, 
   3.7595893003267965`*^9},
 CellLabel->
  "Out[132]=",ExpressionUUID->"59eacc92-0fa3-459e-956f-2d3a27b03545"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "b"}], "+", 
     RowBox[{"c0", " ", "koff1"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"c1", " ", 
      RowBox[{"(", 
       RowBox[{"koff1", "+", 
        RowBox[{"b", " ", "koff2"}], "+", 
        RowBox[{"c1", " ", "koff1", " ", "koff2"}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", "+", 
        RowBox[{"2", " ", "b"}], "+", 
        RowBox[{"c1", " ", 
         RowBox[{"(", 
          RowBox[{"koff1", "+", "koff2"}], ")"}]}]}], ")"}], " ", "kon"}]}], 
    ")"}]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "b"}], "+", 
     RowBox[{"c1", " ", "koff1"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"c0", " ", 
      RowBox[{"(", 
       RowBox[{"koff1", "+", 
        RowBox[{"b", " ", "koff2"}], "+", 
        RowBox[{"c0", " ", "koff1", " ", "koff2"}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", "+", 
        RowBox[{"2", " ", "b"}], "+", 
        RowBox[{"c0", " ", 
         RowBox[{"(", 
          RowBox[{"koff1", "+", "koff2"}], ")"}]}]}], ")"}], " ", "kon"}]}], 
    ")"}]}]]], "Output",
 CellChangeTimes->{{3.75414265191422*^9, 3.7541426642104197`*^9}, 
   3.7541430855279493`*^9, 3.754143479476502*^9, 3.754144279523181*^9, 
   3.7541446167749863`*^9, 3.7544100489222527`*^9, 3.757171268030129*^9, 
   3.7571730645499277`*^9, 3.757887992297921*^9, 3.7579415870415225`*^9, 
   3.7579416658718243`*^9, 3.7579418644999046`*^9, 3.758296620081482*^9, 
   3.758300438403019*^9, 3.758300672307169*^9, 3.7583010658521414`*^9, 
   3.7583011237522945`*^9, 3.758301364507513*^9, 3.7583014720255804`*^9, {
   3.758301564873386*^9, 3.758301579519257*^9}, 3.759453365740102*^9, 
   3.7594534325362673`*^9, 3.759453589725153*^9, 3.7594537327941236`*^9, 
   3.759455029091584*^9, 3.759586321698962*^9, 3.7595866775889997`*^9, 
   3.7595870359932976`*^9, 3.759587087743111*^9, 3.759587127315191*^9, 
   3.7595893004853783`*^9},
 CellLabel->
  "Out[133]=",ExpressionUUID->"0d5dcd92-108d-462f-a143-14026d23e92e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"noneq", " ", "=", " ", 
   RowBox[{
    RowBox[{
    "eq", " ", "*", " ", "gamma", " ", "*", " ", "delta", " ", 
     "\[IndentingNewLine]", "noneqComponent"}], " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"noneqRatio", " ", "/", " ", "eqRatio"}], "\[IndentingNewLine]",
       "gamma"}], " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"b", " ", "km"}], "+", "koff", "+", 
          RowBox[{"c1", " ", "kon"}], "+", "kp"}], ")"}], " ", "/", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"b", " ", "km"}], "+", "koff", "+", 
          RowBox[{"c0", " ", "kon"}], "+", "kp"}], ")"}]}], 
       "\[IndentingNewLine]", "delta"}], " ", "=", " ", 
      RowBox[{"noneqComponent", " ", "/", " ", "gamma"}]}]}]}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.754142694192856*^9, 3.754142742382628*^9}, {
   3.75414277866681*^9, 3.754142780308208*^9}, {3.754142964950635*^9, 
   3.754143024833893*^9}, {3.7541430707929564`*^9, 3.754143193723753*^9}, {
   3.754143241707274*^9, 3.754143242067079*^9}, {3.754143579018424*^9, 
   3.754143581060046*^9}, 3.754144489118615*^9, {3.7541560167451773`*^9, 
   3.754156082212016*^9}, {3.754156297150043*^9, 3.7541563386161547`*^9}, {
   3.75415642162276*^9, 3.754156422679317*^9}, 3.754158628148871*^9, {
   3.754159446226882*^9, 3.754159449589402*^9}, {3.754159649847518*^9, 
   3.7541596876352386`*^9}, {3.754159762249597*^9, 3.754159764621025*^9}, {
   3.754160347389367*^9, 3.754160432992386*^9}, {3.7541605020930347`*^9, 
   3.754160502542756*^9}, {3.754160623182036*^9, 3.754160625496665*^9}, {
   3.754166238064845*^9, 3.754166319786064*^9}, {3.754166458831888*^9, 
   3.754166470754583*^9}, {3.754409736666646*^9, 3.754409784311348*^9}, {
   3.757887966409135*^9, 3.7578879800935473`*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"3319b6c7-476b-4a90-9616-4538caac68d1"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.757171183744201*^9, 3.757171185119487*^9}, 
   3.757887969567689*^9},
 CellLabel->"In[91]:=",ExpressionUUID->"ffa10b85-0cde-43e2-ac8b-9d49f8037980"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Operate in limit where km and kon are very small. Solve for optimal Beta\
\>", "Subsection",
 CellChangeTimes->{{3.7579422136491475`*^9, 3.757942230143794*^9}, {
  3.7582980004247475`*^9, 3.75829802287921*^9}, {3.7595873984781713`*^9, 
  3.759587413727378*^9}},ExpressionUUID->"7aaf2638-a90b-4dde-b4f6-\
8769f7ba83fa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fidelityLim1", "=", " ", 
  RowBox[{"Limit", "[", 
   RowBox[{"noneqRatio", " ", ",", " ", 
    RowBox[{"kon", "\[Rule]", "0"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7579422436157813`*^9, 3.757942270170826*^9}, {
  3.7582979506798863`*^9, 3.758297955650855*^9}, {3.7582979865919027`*^9, 
  3.7582979920766497`*^9}, {3.75958652348761*^9, 3.759586524116894*^9}, {
  3.759586654019003*^9, 3.7595866546922407`*^9}, {3.7595872814751177`*^9, 
  3.7595873161274915`*^9}},
 CellLabel->
  "In[134]:=",ExpressionUUID->"53dd90b0-e7fb-4a9d-b655-38acb1de1947"],

Cell[BoxData[
 FractionBox[
  RowBox[{"c1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "b"}], "+", 
     RowBox[{"c0", " ", "koff1"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"koff1", "+", 
     RowBox[{"b", " ", "koff2"}], "+", 
     RowBox[{"c1", " ", "koff1", " ", "koff2"}]}], ")"}]}], 
  RowBox[{"c0", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "b"}], "+", 
     RowBox[{"c1", " ", "koff1"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"koff1", "+", 
     RowBox[{"b", " ", "koff2"}], "+", 
     RowBox[{"c0", " ", "koff1", " ", "koff2"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{
  3.757942271778528*^9, 3.758297927035166*^9, 3.758297982550517*^9, 
   3.75830067315191*^9, 3.758301070152645*^9, 3.758301126922783*^9, 
   3.75830136505505*^9, 3.7583014777552633`*^9, {3.7583015655346174`*^9, 
   3.7583015799441185`*^9}, 3.7594533658627768`*^9, {3.7594534410521708`*^9, 
   3.759453462968881*^9}, 3.7594535954510036`*^9, 3.759453732855955*^9, 
   3.7594550303557215`*^9, 3.7595864838168736`*^9, 3.7595865248728724`*^9, {
   3.7595866557713194`*^9, 3.759586684121806*^9}, 3.759587127414951*^9, 
   3.7595872855143223`*^9, 3.75958731798353*^9, 3.7595893079344034`*^9},
 CellLabel->
  "Out[134]=",ExpressionUUID->"5de33159-a1e4-47d7-b942-67ebb3e09a87"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"check", " ", "=", " ", 
  RowBox[{"fidelityLim1", " ", "/.", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"koff1", "\[Rule]", "10"}], ",", " ", 
     RowBox[{"b", "\[Rule]", "10"}], ",", 
     RowBox[{"koff2", "\[Rule]", "10000"}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.758297902623172*^9, 3.7582979479508486`*^9}, {
   3.7582979935631256`*^9, 3.758297996735756*^9}, {3.7594534565262194`*^9, 
   3.7594534579012556`*^9}, {3.7594535310741525`*^9, 
   3.7594535315693097`*^9}, {3.759453614491155*^9, 3.759453615852314*^9}, {
   3.759453811591093*^9, 3.7594538126347427`*^9}, {3.7595872951655264`*^9, 
   3.7595873340829763`*^9}, {3.7595898644484987`*^9, 3.759589892144868*^9}, {
   3.7595899426486635`*^9, 3.7595899473239317`*^9}, 3.759590055002471*^9, {
   3.7595903344511333`*^9, 3.759590334630018*^9}},
 CellLabel->
  "In[153]:=",ExpressionUUID->"9d60668b-fa9f-4e54-8d13-0700bfe6a1bf"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"20", "+", 
     RowBox[{"10", " ", "c0"}]}], ")"}], " ", "c1", " ", 
   RowBox[{"(", 
    RowBox[{"100010", "+", 
     RowBox[{"100000", " ", "c1"}]}], ")"}]}], 
  RowBox[{"c0", " ", 
   RowBox[{"(", 
    RowBox[{"100010", "+", 
     RowBox[{"100000", " ", "c0"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"20", "+", 
     RowBox[{"10", " ", "c1"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.758297929799301*^9, 3.758297937664418*^9}, 
   3.758300673186815*^9, 3.7583010752317305`*^9, 3.7583011408460665`*^9, 
   3.7583013650849676`*^9, 3.7583014806036463`*^9, {3.7583015655695214`*^9, 
   3.7583015799889984`*^9}, 3.759453365912644*^9, {3.7594534586601706`*^9, 
   3.759453465028717*^9}, 3.7594535325746813`*^9, {3.7594536023714743`*^9, 
   3.759453616928525*^9}, 3.759453732871912*^9, 3.7594538142271557`*^9, 
   3.759455030399603*^9, 3.759587127431918*^9, 3.759587298139633*^9, 
   3.7595873384164023`*^9, 3.7595898943969803`*^9, 3.759589948456435*^9, 
   3.759590336128867*^9},
 CellLabel->
  "Out[153]=",ExpressionUUID->"a9a67c7a-4c4c-4c66-ab6c-dc33f864ccdb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{"check", " ", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"c0", "\[Rule]", "1"}], ",", 
     RowBox[{"c1", "\[Rule]", "10"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7595898997493505`*^9, 3.759589928953646*^9}, {
  3.7595899717532206`*^9, 3.759589978163138*^9}, {3.759590274421898*^9, 
  3.7595902785014486`*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"15cf7547-0354-40df-a666-8b03c1c2a787"],

Cell[BoxData["13.749437528123593`"], "Output",
 CellChangeTimes->{{3.7595899139898295`*^9, 3.7595899789661617`*^9}, 
   3.759590339553197*^9},
 CellLabel->
  "Out[154]=",ExpressionUUID->"dd953dbd-76a9-409f-902f-29dbebf1da04"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1280, 677},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 393, 8, 40, "Text",ExpressionUUID->"d1518c95-f8f3-413c-b038-17f90c0a1e60"],
Cell[954, 30, 890, 18, 28, "Input",ExpressionUUID->"c95437b1-8467-44ee-b3ad-5728a54b961b"],
Cell[CellGroupData[{
Cell[1869, 52, 1270, 29, 28, "Input",ExpressionUUID->"7fb5bbc1-0e7f-4bb4-a355-efe1fde738a9"],
Cell[3142, 83, 3033, 88, 59, "Output",ExpressionUUID->"edeac353-7667-48fe-89f8-10e85adb042a"]
}, Open  ]],
Cell[6190, 174, 618, 9, 39, "Text",ExpressionUUID->"57476a6a-3be2-4c96-bdb7-d81fff26d895"],
Cell[CellGroupData[{
Cell[6833, 187, 1755, 30, 28, "Input",ExpressionUUID->"4d1ce54a-26aa-4a0e-866a-5330bf9dd464"],
Cell[8591, 219, 3863, 102, 109, "Output",ExpressionUUID->"108893ed-1fdd-47c0-9a01-f96b03961502"]
}, Open  ]],
Cell[12469, 324, 470, 7, 39, "Text",ExpressionUUID->"19646b47-4fc7-459f-8a88-4f006c354ecf"],
Cell[CellGroupData[{
Cell[12964, 335, 528, 11, 28, "Input",ExpressionUUID->"382bb689-d39c-46d8-928d-de06798b10fb"],
Cell[13495, 348, 1141, 29, 59, "Output",ExpressionUUID->"3425e77b-81f2-4c0e-9043-ddfb22e81600"]
}, Open  ]],
Cell[14651, 380, 1754, 40, 67, "Input",ExpressionUUID->"5335b349-278a-4278-9db8-36a1606a1160"],
Cell[CellGroupData[{
Cell[16430, 424, 439, 11, 28, "Input",ExpressionUUID->"29caa98b-827d-4d0f-bbc5-3529f63893b5"],
Cell[16872, 437, 1411, 29, 61, "Output",ExpressionUUID->"855f3496-42d1-47df-bbe9-dec560a56093"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18320, 471, 176, 3, 44, "Subsubsection",ExpressionUUID->"87de3d82-d3a6-4441-a929-c6412d28cd6e"],
Cell[CellGroupData[{
Cell[18521, 478, 915, 18, 48, "Input",ExpressionUUID->"a3260b4f-c2f6-4d0a-b124-5046d4161368"],
Cell[19439, 498, 1796, 43, 63, "Output",ExpressionUUID->"59eacc92-0fa3-459e-956f-2d3a27b03545"],
Cell[21238, 543, 2118, 55, 59, "Output",ExpressionUUID->"0d5dcd92-108d-462f-a143-14026d23e92e"]
}, Open  ]],
Cell[23371, 601, 1955, 39, 86, "Input",ExpressionUUID->"3319b6c7-476b-4a90-9616-4538caac68d1"],
Cell[25329, 642, 197, 3, 28, "Input",ExpressionUUID->"ffa10b85-0cde-43e2-ac8b-9d49f8037980"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25563, 650, 328, 6, 53, "Subsection",ExpressionUUID->"7aaf2638-a90b-4dde-b4f6-8769f7ba83fa"],
Cell[CellGroupData[{
Cell[25916, 660, 577, 11, 28, "Input",ExpressionUUID->"53dd90b0-e7fb-4a9d-b655-38acb1de1947"],
Cell[26496, 673, 1293, 30, 59, "Output",ExpressionUUID->"5de33159-a1e4-47d7-b942-67ebb3e09a87"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27826, 708, 921, 17, 28, "Input",ExpressionUUID->"9d60668b-fa9f-4e54-8d13-0700bfe6a1bf"],
Cell[28750, 727, 1139, 26, 59, "Output",ExpressionUUID->"a9a67c7a-4c4c-4c66-ab6c-dc33f864ccdb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29926, 758, 456, 11, 28, "Input",ExpressionUUID->"15cf7547-0354-40df-a666-8b03c1c2a787"],
Cell[30385, 771, 225, 4, 65, "Output",ExpressionUUID->"dd953dbd-76a9-409f-902f-29dbebf1da04"]
}, Open  ]]
}, Open  ]]
}
]
*)

